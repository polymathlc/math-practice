<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SG Math Exam Bank (Pro Layout)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Roboto:wght@400;700&display=swap');

        :root {
            --bg: #eef2f3;
            --bg-gradient: linear-gradient(135deg, #eef2f3 0%, #e6e9f0 100%);
            --paper: #ffffff;
            --text: #2d3436;
            --text-secondary: #636e72;
            --accent: #0984e3;
            --highlight: #74b9ff;
            --success: #00b894;
            --error: #d63031;
            --admin: #6c5ce7;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: 1px solid rgba(255, 255, 255, 0.3);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            --card-radius: 16px;
        }

        body.dark-mode {
            --bg: #2d3436;
            --bg-gradient: linear-gradient(135deg, #2d3436 0%, #000000 100%);
            --paper: #1e272e;
            --text: #dfe6e9;
            --text-secondary: #b2bec3;
            --accent: #74b9ff;
            --highlight: #0984e3;
            --glass-bg: rgba(30, 39, 46, 0.8);
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        body.dark-mode .question-block,
        body.dark-mode .focus-card,
        body.dark-mode .result-card,
        body.dark-mode .control-bar {
            background: var(--paper);
            color: var(--text);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        body.dark-mode .sheet {
            background: var(--paper);
            color: var(--text);
        }

        body.dark-mode input,
        body.dark-mode select {
            background: #2d3436;
            color: white;
            border-color: #636e72;
        }

        body.dark-mode .canvas-toolbar {
            background: #2d3436;
            border-color: #636e72;
        }

        body.dark-mode canvas {
            filter: invert(1) hue-rotate(180deg);
        }

        body.dark-mode .grid-bg {
            background-image: linear-gradient(#444 1px, transparent 1px), linear-gradient(90deg, #444 1px, transparent 1px);
        }

        body.large-text {
            font-size: 1.2rem;
        }

        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: rgba(0, 0, 0, 0.1);
            z-index: 9999;
            display: none;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--highlight), var(--accent));
            width: 0%;
            transition: width 0.5s ease;
        }

        @media (max-width: 768px) {
            .control-bar {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
                padding: 15px;
            }

            .control-group {
                width: 100%;
                margin-right: 0;
            }
        }

        /* Generation Modal Styles */
        .gen-modal-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-height: 80vh;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .filter-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #eee;
        }

        .filter-section h3 {
            margin: 0 0 10px 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .checkbox-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 150px;
            overflow-y: auto;
            padding: 5px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: color 0.2s;
        }

        .checkbox-item:hover {
            color: var(--accent);
        }

        .checkbox-item input {
            width: auto;
            cursor: pointer;
        }

        .gen-footer {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .count-input-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #eee;
            margin-top: 10px;
        }

        .gen-btn-primary {
            background: linear-gradient(135deg, var(--accent), #0773c5);
            padding: 12px 30px;
        }

        .mistake-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: #fff3f0;
            border-radius: 8px;
            border: 1px solid #ffdcd3;
            margin-bottom: 20px;
            cursor: pointer;
        }


        @media print {

            .app-sidebar,
            .canvas-toolbar,
            .toast,
            .progress-container,
            .action-btn,
            .insert-bar,
            .btn-remove,
            .btn-delete-db,
            .vault-badge {
                display: none !important;
            }

            body {
                padding: 0;
                background: white;
                color: black;
            }

            .question-wrapper {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                border: none;
                box-shadow: none;
                margin-bottom: 40px;
                display: block;
            }

            .question-block {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            .working-space-container {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            .sheet {
                box-shadow: none;
                margin: 0;
                padding: 0;
            }

            video {
                display: none !important;
            }

            .qr-code {
                display: block !important;
                margin-top: 10px;
            }
        }

        .qr-code {
            display: none;
        }

        .question-mark {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
        }

        .page-break-before {
            page-break-before: always;
            margin-top: 50px;
        }

        .streak-container {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(135deg, #ff9f43, #ee5253);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 4px 15px rgba(238, 82, 83, 0.4);
            z-index: 1000;
            display: none;
            align-items: center;
            gap: 8px;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% {
                transform: scale(0);
            }

            100% {
                transform: scale(1);
            }
        }

        .streak-shake {
            animation: shake 0.5s;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 99999;
        }

        .stat-weak {
            background: var(--error) !important;
        }

        .stat-ok {
            background: #f1c40f !important;
        }

        .stat-good {
            background: var(--success) !important;
        }

        .grid-bg {
            background-image: linear-gradient(#ccc 1px, transparent 1px), linear-gradient(90deg, #ccc 1px, transparent 1px);
            background-size: 20px 20px;
            background-color: white;
        }

        body.dyslexia-font {
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif !important;
            line-height: 1.6;
            word-spacing: 0.1em;
        }

        .focus-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .focus-card {
            background: var(--paper);
            padding: 40px;
            border-radius: 16px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .focus-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .student-name-input {
            border: none;
            border-bottom: 2px solid #ccc;
            background: transparent;
            font-size: 1.2rem;
            width: 250px;
            padding: 5px;
            margin-bottom: 20px;
            outline: none;
            color: var(--text);
        }

        @media print {
            .student-name-input {
                border-bottom: 1px solid black;
            }
        }

        .flag-btn {
            background: transparent;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.3;
            transition: opacity 0.2s;
        }

        .flag-btn.active {
            opacity: 1;
        }

        body {
            font-family: 'Century Gothic', 'Outfit', sans-serif;
            background: var(--bg-gradient);
            color: var(--text);
            line-height: 1.3;
            margin: 0;
            padding: 20px;
            padding-bottom: 150px;
            padding-left: 320px;
            min-height: 100vh;
            transition: background 0.3s ease, color 0.3s ease;
        }

        @media print {
            body {
                padding-left: 0;
            }
        }

        .fraction {
            display: inline-block;
            vertical-align: middle;
            text-align: center;
            margin: 0 4px;
            font-size: 0.9em;
        }

        .fraction>span {
            display: block;
            padding: 0 2px;
        }

        .numerator {
            border-bottom: 1px solid #000;
            line-height: 1.2;
        }

        .denominator {
            line-height: 1.2;
        }

        .stats-bar-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .stats-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-label {
            width: 120px;
            text-align: right;
            font-size: 0.9rem;
        }

        .stats-track {
            flex: 1;
            background: #eee;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
        }

        .stats-fill {
            height: 100%;
            background: var(--highlight);
            width: 0%;
            transition: width 0.5s;
        }

        .stats-val {
            width: 40px;
            font-size: 0.8rem;
        }

        .q-layout {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 15px;
            position: relative;
        }

        .q-number-col {
            flex-shrink: 0;
            font-weight: bold;
            font-size: 1.1rem;
            min-width: 25px;
            text-align: right;
        }

        .q-content-col {
            flex-grow: 1;
            font-size: 1.1rem;
            line-height: 1.6;
            text-align: justify;
            width: 100%;
        }

        .q-image {
            display: block;
            max-width: 100%;
            max-height: 300px;
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .app-sidebar {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            width: 280px;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            padding: 20px;
            border-right: var(--glass-border);
            box-shadow: var(--glass-shadow);
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            width: 100%;
        }

        label {
            font-weight: bold;
            font-size: 0.75rem;
            text-transform: uppercase;
            color: #7f8c8d;
        }

        select,
        input[type="number"],
        input[type="text"] {
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 0.95rem;
            width: 100%;
            box-sizing: border-box;
        }

        /* AND/OR TOGGLE */
        .filter-mode-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--accent);
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        .toggle-label {
            font-size: 0.9rem;
            font-weight: bold;
        }

        button {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.95rem;
            white-space: nowrap;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            filter: brightness(1.1);
        }

        button.check-btn {
            background-color: var(--success);
        }

        button.check-btn:hover {
            background-color: #27ae60;
        }

        .admin-panel {
            background: white;
            max-width: 210mm;
            margin: 40px auto;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid var(--admin);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .admin-header {
            color: var(--admin);
            margin-top: 0;
        }

        textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9rem;
            box-sizing: border-box;
            margin-bottom: 10px;
        }

        .admin-btn {
            background-color: var(--admin);
            font-size: 0.9rem;
        }

        .admin-btn:hover {
            background-color: #732d91;
        }

        #paper-container {
            max-width: 210mm;
            margin: 0 auto;
        }

        .sheet {
            background: var(--paper);
            color: var(--text);
            width: 100%;
            min-height: 297mm;
            padding: 20mm;
            margin-bottom: 30px;
            box-sizing: border-box;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            border-radius: 4px;
            position: relative;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .feedback-icon {
            display: inline-block;
            margin-left: 10px;
            font-size: 1.5rem;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            vertical-align: middle;
        }

        .explanation-box {
            margin-top: 5px;
            padding: 10px;
            background-color: #f0f8ff;
            border-left: 3px solid #3498db;
            font-size: 0.9rem;
            color: #2c3e50;
        }

        .school-header {
            text-align: center;
            border-bottom: 2px solid black;
            padding-bottom: 10px;
            margin-bottom: 30px;
            text-transform: uppercase;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .question-block {
            margin-bottom: 30px;
            padding: 20px;
            border: 1.5px solid #eaeaea;
            border-radius: 12px;
            background: white;
            break-inside: avoid;
            page-break-inside: avoid;
            position: relative;
            transition: border-color 0.3s ease;
        }

        .question-block:hover {
            border-color: var(--secondary);
        }

        .question-wrapper:hover .q-actions {
            display: flex;
        }

        /* Adaptive Mode Styling */
        body.adaptive-mode .sheet {
            text-align: center;
            padding-top: 50px;
        }

        body.adaptive-mode .question-wrapper {
            max-width: 800px;
            margin: 0 auto;
        }

        .adaptive-next-msg {
            font-size: 1.5rem;
            color: var(--accent);
            margin-top: 20px;
            font-weight: bold;
            animation: popIn 0.5s;
        }

        .q-actions {
            display: none;
            position: absolute;
            top: 5px;
            right: 5px;
            flex-direction: column;
            gap: 5px;
            z-index: 10;
        }

        .action-btn {
            font-size: 0.7rem;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            border: none;
            opacity: 0.9;
        }

        .feedback-tick {
            display: inline-block;
            margin-left: 10px;
            font-size: 1.8rem;
            color: var(--success);
            font-weight: bold;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            vertical-align: middle;
        }

        .feedback-tick.show {
            opacity: 1;
            transform: scale(1.2);
        }

        .btn-remove {
            background: #95a5a6;
            color: white;
        }

        .btn-delete-db {
            background: #e74c3c;
            color: white;
        }

        .q-meta {
            font-size: 0.7rem;
            color: #95a5a6;
            margin-bottom: 5px;
            font-style: italic;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tag {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .insert-bar {
            height: 10px;
            width: 100%;
            margin: 5px 0;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }

        .insert-bar:hover {
            background-color: #eef2f3;
            height: 25px;
        }

        .insert-bar::after {
            content: "+ Insert Question Here";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8rem;
            color: var(--highlight);
            display: none;
            font-weight: bold;
        }

        .insert-bar:hover::after {
            display: block;
        }

        .part-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 8px;
        }

        .part-label {
            font-weight: 600;
            min-width: 25px;
            color: var(--secondary);
            font-size: 0.9rem;
        }

        .mcq-container {
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .mcq-option {
            display: flex;
            align-items: baseline;
            margin-bottom: 8px;
            cursor: pointer;
        }

        .mcq-option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .mcq-label {
            font-size: 1.1rem;
        }

        .mcq-print-bracket {
            display: none;
            float: right;
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: -30px;
        }

        .mcq-option.correct-choice .mcq-label {
            color: var(--success);
            font-weight: bold;
        }

        .mcq-option.wrong-choice .mcq-label {
            color: var(--error);
            text-decoration: line-through;
        }

        .interaction-area {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .student-input {
            padding: 8px;
            border: 2px solid #bdc3c7;
            border-radius: 4px;
            width: 150px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .student-input:focus {
            outline: none;
            border-color: var(--highlight);
        }

        .student-input.correct {
            border-color: var(--success);
            background-color: #e8f8f5;
        }

        .student-input.wrong {
            border-color: var(--error);
            background-color: #fdedec;
        }

        .print-answer-line {
            display: none;
            margin-top: 40px;
            font-weight: bold;
            font-size: 1.1rem;
            text-align: right;
        }

        .working-space {
            height: 150px;
            width: 100%;
            border: 1px solid transparent;
        }

        .working-space-container {
            margin-top: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: #fdfdfd;
            position: relative;
        }

        .canvas-toolbar {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 5px 10px;
            background: #eee;
            border-bottom: 1px solid #ddd;
            border-radius: 4px 4px 0 0;
        }

        .tool-btn {
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .tool-btn.active {
            background: var(--highlight);
            color: white;
            border-color: var(--highlight);
        }

        .working-canvas {
            display: block;
            width: 100%;
            height: 300px;
            cursor: none;
            touch-action: none;
        }

        .brush-cursor {
            position: fixed;
            width: 4px;
            height: 4px;
            border: 1px solid #000;
            border-radius: 50%;
            pointer-events: none;
            z-index: 10000;
            display: none;
            mix-blend-mode: difference;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
        }


        .answer-key-section {
            margin-top: 10px;
            font-weight: bold;
            color: var(--highlight);
            display: none;
            border-top: 1px dashed #ccc;
            padding-top: 5px;
        }

        @media print {
            @page {
                size: A4;
                margin: 15mm;
            }

            body {
                background: white;
                padding: 0;
                margin: 0;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .control-bar,
            .admin-panel,
            .q-actions,
            .insert-bar,
            .canvas-toolbar {
                display: none !important;
            }

            #paper-container {
                width: 100%;
                margin: 0;
            }

            .sheet {
                box-shadow: none;
                margin: 0;
                border: none;
                width: 100%;
                min-height: auto;
                padding: 0;
                page-break-after: always;
                overflow: visible;
            }

            .sheet:last-child {
                page-break-after: auto;
            }

            .interaction-area {
                display: none;
            }

            .mcq-option input[type="radio"] {
                display: none;
            }

            .mcq-print-bracket {
                display: block;
            }

            .print-answer-line.open-ended {
                display: block;
            }

            .working-space-container {
                border: none;
                background: transparent;
            }

            .working-canvas {
                height: 200px;
            }
        }

        @media screen and (max-width: 1024px) {
            body {
                padding: 10px;
                padding-bottom: 100px;
            }

            .control-bar {
                max-width: 100%;
                position: relative;
                top: 0;
                padding: 10px;
                gap: 10px;
            }

            .control-group {
                min-width: 45%;
            }

            #paper-container {
                width: 100%;
            }

            .sheet {
                width: 100%;
                min-height: auto;
                padding: 15px;
                box-sizing: border-box;
            }

            .q-layout {
                flex-direction: column;
                gap: 5px;
            }

            .q-number-col {
                text-align: left;
                width: 100%;
                border-bottom: 1px solid #eee;
                padding-bottom: 2px;
                margin-bottom: 5px;
                color: var(--highlight);
            }

            .q-content-col {
                text-align: left;
            }

            .canvas-toolbar {
                flex-wrap: wrap;
                gap: 8px;
            }

            .tool-btn {
                padding: 8px 12px;
                font-size: 1.4rem;
                min-width: 44px;
                min-height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .tool-slider {
                flex-grow: 1;
                height: 30px;
            }

            .student-input {
                width: 100%;
                font-size: 1.1rem;
            }

            .mcq-label {
                font-size: 1.2rem;
                padding: 5px 0;
            }
        }

        .custom-cursor {
            position: fixed;
            pointer-events: none;
            border: 1px solid #000;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            display: none;
            background: rgba(0, 0, 0, 0.1);
        }

        .working-canvas {
            cursor: none;
        }

        .timer-display {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1.2rem;
            background: rgba(0, 0, 0, 0.05);
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            min-width: 100px;
            text-align: center;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.open {
            display: flex;
            opacity: 1;
        }

        .result-card {
            background: var(--paper);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: scale(0.8);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal-overlay.open .result-card {
            transform: scale(1);
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(var(--success) 0%, #eee 0%);
            margin: 0 auto 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--text);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .score-circle::before {
            content: "";
            position: absolute;
            width: 90px;
            height: 90px;
            background: var(--paper);
            border-radius: 50%;
        }

        .score-value {
            z-index: 2;
        }

        .result-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
            background: rgba(0, 0, 0, 0.03);
            padding: 15px;
            border-radius: 10px;
        }

        .stat-item h4 {
            margin: 0;
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .stat-item p {
            margin: 5px 0 0 0;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(45, 52, 54, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            font-weight: 500;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 3000;
            pointer-events: none;
            backdrop-filter: blur(5px);
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .count-badge {
            background: var(--error);
            color: white;
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 5px;
            vertical-align: middle;
            display: inline-block;
        }

        .vault-badge {
            display: inline-block;
            background: var(--error);
            color: white;
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 12px;
            margin-left: 10px;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            vertical-align: middle;
        }

        .vault-badge.existing {
            background: var(--admin);
        }

        [data-tooltip] {
            position: relative;
        }

        [data-tooltip]::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 5px 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s;
            pointer-events: none;
            z-index: 9999;
            margin-bottom: 5px;
        }

        [data-tooltip]:hover::before {
            opacity: 1;
            visibility: visible;
        }

        /* DATABASE COUNT DISPLAY - NEW FEATURE */
        .db-count-display {
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
            padding: 10px 14px;
            background: linear-gradient(135deg, rgba(116, 185, 255, 0.15), rgba(9, 132, 227, 0.15));
            border-radius: 10px;
            border: 1px solid rgba(116, 185, 255, 0.3);
        }

        .db-count-display .count-number {
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--accent);
        }

        body.dark-mode .db-count-display {
            background: linear-gradient(135deg, rgba(116, 185, 255, 0.1), rgba(9, 132, 227, 0.1));
            border-color: rgba(116, 185, 255, 0.2);
        }

        /* SEARCH MODAL - IMPROVED */
        #searchModal {
            z-index: 11000;
        }

        #searchModal .focus-card {
            background: var(--paper);
            color: var(--text);
        }

        .search-input-wrapper {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-input-wrapper input[type="text"] {
            flex: 1;
            padding: 14px 18px;
            font-size: 1.1rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .search-input-wrapper input[type="text"]:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(9, 132, 227, 0.15);
        }

        .search-clear-btn {
            padding: 14px 20px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.2s;
        }

        .search-clear-btn:hover {
            background: #c0392b;
        }

        .search-filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 10px;
        }

        .search-filters select {
            padding: 10px 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.95rem;
            background: white;
            cursor: pointer;
        }

        .search-result-item {
            border: 1px solid #e0e0e0;
            padding: 18px;
            margin-bottom: 14px;
            border-radius: 12px;
            background: var(--bg);
            transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
        }

        .search-result-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
            border-color: var(--accent);
        }

        .search-result-meta {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 10px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .search-result-question {
            margin-bottom: 12px;
            line-height: 1.6;
            font-size: 1.05rem;
        }

        .search-result-answer {
            font-size: 0.9rem;
            color: var(--success);
            margin-bottom: 12px;
            padding: 10px 12px;
            background: rgba(0, 184, 148, 0.1);
            border-radius: 8px;
        }

        .search-highlight {
            background: #fff3cd;
            padding: 2px 5px;
            border-radius: 4px;
            font-weight: 600;
        }

        .search-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 2px solid #eee;
            margin-bottom: 18px;
        }

        .search-stats-count {
            font-weight: bold;
            color: var(--accent);
            font-size: 1.1rem;
        }

        .search-no-results {
            text-align: center;
            padding: 50px 20px;
            color: #aaa;
        }

        .search-no-results-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .add-to-paper-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .add-to-paper-btn:hover {
            background: #0773c5;
            transform: translateY(-1px);
        }

        .add-to-paper-btn.added {
            background: var(--success);
            cursor: default;
        }

        .add-to-paper-btn.added:hover {
            transform: none;
        }

        body.dark-mode .search-result-item {
            background: #2d3436;
            border-color: #444;
        }

        body.dark-mode .search-input-wrapper input[type="text"] {
            background: #2d3436;
            color: white;
            border-color: #555;
        }

        body.dark-mode .search-filters {
            background: rgba(255, 255, 255, 0.05);
        }

        body.dark-mode .search-filters select {
            background: #2d3436;
            color: white;
            border-color: #555;
        }

        body.dark-mode .search-highlight {
            background: #5a4a00;
            color: #fff;
        }

        /* Browse Modal Styles */
        .spinner-browse {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 168, 255, 0.2);
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .browse-item {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid #eee;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }

        .browse-item:hover {
            transform: translateY(-2px);
            border-color: var(--accent);
        }

        .browse-item-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: #7f8c8d;
        }

        .browse-item-q {
            font-size: 0.95rem;
            margin-bottom: 10px;
            line-height: 1.4;
            color: #2d3436;
        }

        .browse-item-footer {
            display: flex;
            justify-content: flex-end;
        }

        body.dark-mode .browse-item {
            background: #2d3436;
            border-color: #444;
        }

        body.dark-mode .browse-item-q {
            color: #ecf0f1;
        }

        body.dark-mode #browseList {
            background: #1e272e;
            border-color: #333;
        }

        /* Question Preview Modal Styles */
        #previewModalContainer {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 25px;
            max-width: 800px;
            width: 90%;
            height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        body.dark-mode #previewModalContainer {
            background: #1e272e;
            color: #ecf0f1;
        }

        .preview-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .preview-section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        body.dark-mode .preview-section {
            border-bottom-color: #333;
        }

        .add-to-paper-btn:active {
            transform: scale(0.95);
        }

        /* Cover Page Styles */
        .cover-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px;
            min-height: 100%;
        }

        .cover-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            font-family: 'Century Gothic', sans-serif;
        }

        .cover-table th,
        .cover-table td {
            border: 1px solid #ddd;
            padding: 12px 15px;
            text-align: left;
        }

        .cover-table th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }

        .cover-table td {
            font-size: 0.9rem;
            color: #444;
        }

        .cover-table .sn-col {
            width: 50px;
            text-align: center;
        }

        .cover-table .marks-col {
            width: 100px;
            text-align: center;
            background: #fafafa;
        }

        .marks-blank {
            display: block;
            height: 25px;
            border-bottom: 1px solid #ccc;
            width: 60%;
            margin: 0 auto;
        }

        .cover-section-title {
            margin-top: 40px;
            font-size: 1.4rem;
            color: var(--secondary);
            font-weight: bold;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 5px;
            width: 100%;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>

<body>
    <div id="auth-overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:99999; display:flex; justify-content:center; align-items:center; font-family:'Outfit', sans-serif; overflow-y: auto;">
        <div style="width:100%; max-width:450px; padding:30px; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.1); border:1px solid #eee; text-align:center; margin: 20px;">
            <img src="https://www.dropbox.com/scl/fi/pmks0l77qiyuw781sh9t3/polymath-sticker.png?rlkey=jmbai9hxsaggsnua6dwewz5c6&raw=1" style="max-width:100px; margin-bottom:15px;">
            <h2 id="auth-title" style="margin-bottom: 20px;">Welcome Back!</h2>
            
            <div id="reg-fields" style="display:none;">
                <input type="text" id="parent-name" placeholder="Parent's Full Name" style="width:100%; padding:10px; margin:5px 0; border:1px solid #ddd; border-radius:8px;">
                <input type="text" id="student-name" placeholder="Student's Full Name" style="width:100%; padding:10px; margin:5px 0; border:1px solid #ddd; border-radius:8px;">
                
                <div style="display:flex; gap:10px; margin: 5px 0;">
                    <select id="student-level" style="flex:1; padding:10px; border:1px solid #ddd; border-radius:8px;">
                        <option value="">Select Level</option>
                        <option value="P3">Primary 3</option>
                        <option value="P4">Primary 4</option>
                        <option value="P5">Primary 5</option>
                        <option value="P6">Primary 6</option>
                        <option value="S1">Secondary 1</option>
                    </select>
                    <select id="student-subject" style="flex:1; padding:10px; border:1px solid #ddd; border-radius:8px;">
                        <option value="">Subject</option>
                        <option value="Math">Math</option>
                        <option value="Science">Science</option>
                    </select>
                </div>
            </div>
    
            <input type="email" id="auth-email" placeholder="Email" style="width:100%; padding:10px; margin:5px 0; border:1px solid #ddd; border-radius:8px;">
            <input type="password" id="auth-pass" placeholder="Password" style="width:100%; padding:10px; margin:5px 0; border:1px solid #ddd; border-radius:8px;">
            
            <div id="legal-box" style="display:none; text-align:left; margin:15px 0; background:#f9f9f9; padding:10px; border-radius:8px; font-size:0.8rem; color:#555;">
                <label style="display:flex; gap:10px; cursor:pointer;">
                    <input type="checkbox" id="legal-agree" style="width:20px; height:20px;">
                    <span>I confirm I am a registered student of Polymath Learning Centre and I am lawfully obliged to pay the monthly tuition fees for as long as I am using this application.</span>
                </label>
            </div>
    
            <button id="btn-login" onclick="handleLogin()" style="width:100%; padding:12px; background:#0984e3; color:white; border:none; border-radius:8px; font-weight:600; cursor:pointer; margin-top:10px;">Login</button>
            <button id="btn-google" onclick="handleGoogleLogin()" style="width:100%; padding:12px; background:#fff; color:#757575; border:1px solid #ddd; border-radius:8px; font-weight:600; cursor:pointer; margin-top:10px; display:flex; align-items:center; justify-content:center; gap:10px;">
    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="18">
    Sign in with Google
</button>
            <div style="margin-top:20px; font-size:0.85rem; color:#636e72;">
                <a href="javascript:void(0)" onclick="handleResetPassword()" style="color:#0984e3; text-decoration:none;">Forgot Password?</a><br><br>
                <span id="mode-text">Don't have an account?</span> <a href="javascript:void(0)" onclick="toggleAuthMode()" id="auth-switch" style="color:#0984e3; font-weight:600; cursor:pointer;">Sign Up</a>
            </div>
            <p id="auth-error" style="color:#d63031; font-size:0.8rem; margin-top:15px;"></p>
        </div>
    </div>
    <div id="brush-cursor" class="custom-cursor"></div>

    <aside class="app-sidebar">
        <div style="text-align: center; margin-bottom: 5px;"><img
                src="https://www.dropbox.com/scl/fi/pmks0l77qiyuw781sh9t3/polymath-sticker.png?rlkey=jmbai9hxsaggsnua6dwewz5c6&raw=1"
                style="max-width: 120px; height: auto;"></div>
        <h2 style="margin:0 0 10px 0; color:var(--highlight); text-align:center;">MathGen </h2>

        <!-- DATABASE COUNT DISPLAY - NEW FEATURE -->
        <div id="dbCountDisplay" class="db-count-display">
             <span class="count-number" id="dbCount">0</span> questions in database
        </div>

        <div class="control-group">
            <label>Search</label>
            <button onclick="openSearchModal()" style="background:var(--admin); flex:1;"> Search</button>
            <button onclick="openBrowseModal()" style="background:var(--accent); flex:1;"> Browse All</button>
        </div>
        <div class="control-group" style="max-width: 100px;">
            <label>Settings</label>
            <div style="display:flex; gap:5px; flex-wrap:wrap;">
                <button onclick="toggleAudio()" id="btn-audio" style="font-size:0.8rem; padding:4px;"
                    data-tooltip="Toggle Sound"></button>
                <button onclick="toggleFontSize()" style="font-size:0.8rem; padding:4px;"
                    data-tooltip="Toggle Font Size">Aa</button>
                <button onclick="toggleDyslexia()" style="font-size:0.8rem; padding:4px;"
                    data-tooltip="Dyslexia Font"></button>
                <button onclick="toggleDarkMode()" style="font-size:0.8rem; padding:4px;"
                    title="Toggle Dark Mode"></button>
                <button onclick="toggleStats()" style="font-size:0.8rem; padding:4px;"
                    data-tooltip="Topic Stats"></button>
            </div>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
            <button class="check-btn" onclick="checkAnswers()">Check</button>
            <button onclick="openGenModal()" style="background:var(--accent);">Generate New</button>
            <button onclick="loadMistakePaper()" style="background:#e17055;">Vault <span id="vaultCount"
                    class="count-badge">0</span></button>
            <button onclick="loadFlaggedPaper()" style="background:#f1c40f; color:#000;">Flags <span id="flagCount"
                    class="count-badge">0</span></button>

            <button onclick="window.print()" style="background:#7f8c8d;">Print PDF</button>
            <button onclick="toggleAdmin()" style="background:#8e44ad;">Admin</button>
        </div>
        <div style="margin-top:10px;">
            <button onclick="startAdaptiveMode()"
                style="background: linear-gradient(135deg, #6c5ce7, #a29bfe); width:100%;"> Start Adaptive
                Learning</button>
        </div>
        <div style="display:flex; align-items:center; gap:5px;">
            <input type="checkbox" id="showAnswers" onchange="toggleAnswers()">
            <label for="showAnswers" style="cursor:pointer; color:black; font-size:0.8rem;">Show Key</label>
        </div>
        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
<div id="user-info" style="text-align:center; margin-bottom: 10px;">
    <p id="login-days-display" style="font-size:0.9rem; font-weight:bold; color:var(--accent);">Loading days...</p>
</div>
<button onclick="handleLogout()" style="background:#d63031; width:100%; padding: 10px; border-radius: 8px; color: white; cursor: pointer; font-weight: 600;"> Logout</button>
    </aside>

    <div id="paper-container">
        <div style="text-align:center; padding:50px; color:#7f8c8d;">
            <h2>Primary Math Generator</h2>
            <p>Database loaded. Click "Generate New" to start.</p>
        </div>
    </div>

    <div class="modal-overlay" id="resultModal">
        <div class="result-card">
            <h2 id="resultTitle">Great Job! </h2>
            <div class="score-circle" id="scoreCircle"><span class="score-value" id="scoreValue">85%</span></div>
            <div class="result-stats">
                <div class="stat-item">
                    <h4>Score</h4>
                    <p id="scoreText">17/20</p>
                </div>
                <div class="stat-item">
                    <h4>Time</h4>
                    <p id="timeText">--:--</p>
                </div>
            </div>
            <p id="resultMessage" style="margin-bottom:20px; color:var(--text-secondary);">Keep it up!</p>
            <div style="display:flex; gap:10px; justify-content:center;">
                <button onclick="closeModal()" style="background:#bdc3c7; color:#2d3436;">Review</button>
                <button onclick="closeModal(); generateNewPaper();" class="check-btn">New Paper</button>
            </div>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>
    <div id="streak-counter" class="streak-container"> <span id="streak-val">0</span></div>

    <div id="stats-modal" class="focus-overlay" style="display:none;">
        <div class="focus-card" style="max-width: 600px;">
            <span class="focus-close" onclick="toggleStats()"></span>
            <h2>Topic Breakdown </h2>
            <div id="stats-content" class="stats-bar-container"></div>
        </div>
    </div>

    <div id="toast" class="toast">Saved!</div>

    <!-- SEARCH MODAL - FIXED -->
    <div id="searchModal" class="focus-overlay" style="display:none; align-items:flex-start; padding-top:40px;">
        <div class="focus-card" style="max-width:850px; height:85vh; display:flex; flex-direction:column;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h2 style="margin:0;"> Search Questions</h2>
                <span class="focus-close" onclick="closeSearchModal()"></span>
            </div>
            <div class="search-input-wrapper">
                <input type="text" id="searchInput"
                    placeholder="Search by keyword (e.g. ratio, fractions, percentage)..." oninput="performSearch()"
                    autofocus>
                <button class="search-clear-btn" onclick="clearSearchInput()">Clear</button>
            </div>
            <div class="search-filters">
                <select id="searchLevelFilter" onchange="performSearch()">
                    <option value="all">All Levels</option>
                    <option value="P1">P1</option>
                    <option value="P2">P2</option>
                    <option value="P3">P3</option>
                    <option value="P4">P4</option>
                    <option value="P5">P5</option>
                    <option value="P6">P6</option>
                </select>
                <select id="searchSchoolFilter" onchange="performSearch()">
                    <option value="all">All Schools</option>
                </select>
                <select id="searchTopicFilter" onchange="performSearch()">
                    <option value="all">All Topics</option>
                </select>
                <select id="searchDiffFilter" onchange="performSearch()">
                    <option value="all">All Difficulties</option>
                    <option value="Easy">Easy</option>
                    <option value="Medium">Medium</option>
                    <option value="Hard">Hard</option>
                </select>
                <label
                    style="display:flex; align-items:center; gap:5px; font-size:0.85rem; color:var(--text); cursor:pointer;">
                    <input type="checkbox" id="searchVideoOnly" onchange="performSearch()"> Video Only 
                </label>
            </div>
            <div id="searchResults" style="flex:1; overflow-y:auto; padding:5px;">
                <div class="search-no-results">
                    <div class="search-no-results-icon"></div>
                    <p>Enter a keyword or tags to search questions</p>
                    <p style="font-size:0.85rem;">Try: "ratio", "#Hard", "#Ratio #P6"</p>
                </div>
            </div>
        </div>
    </div>

    <div class="admin-panel" id="adminPanel" style="display:none;">
        <h3 class="admin-header">Admin: Add New Questions</h3>
        <div style="display:flex; gap:15px; margin-bottom:10px;">
            <div style="flex:1">
                <label>Paste JSON (Mass Import)</label>
                <textarea id="importData"
                    placeholder='[{"s":"School","lvl":"P5","top":"Ratio","dif":"Medium","q":"Question","a":"Ans"}]'></textarea>
                <button class="admin-btn" onclick="importQuestions()">Import JSON</button>
            </div>
            <div style="flex:1; background:#f9f9f9; padding:10px; border-radius:4px;">
                <label>Add Single Question</label>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px; margin-bottom:5px;">
                    <input type="text" id="newS" placeholder="School">
                    <input type="text" id="newL" placeholder="Level (P5)">
                    <input type="text" id="newT" placeholder="Topic">
                    <input type="text" id="newD" placeholder="Difficulty">
                </div>
                <input type="text" id="newQ" placeholder="Question Text" style="margin-bottom:5px;">
                <input type="text" id="newA" placeholder="Answer" style="margin-bottom:5px;">
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px; margin-bottom:5px;">
                    <input type="text" id="newImg" placeholder="Image URL">
                    <input type="text" id="newVid" placeholder="Video URL">
                </div>
                <input type="text" id="newTags" placeholder="Tags (e.g. #Ratio #P6)" style="margin-bottom:5px;">
                <textarea id="newExp" placeholder="Explanation (optional)" style="height:60px;"></textarea>
                <button class="admin-btn" onclick="addSingleQuestion()">Add Question</button>
            </div>
        </div>
        <div style="display:flex; gap:10px; border-top:1px solid #eee; padding-top:10px;">
            <button class="admin-btn" style="background:#27ae60;" onclick="exportUpdatedFile()"
                data-tooltip="Saves the entire application including the database locally.">Export Application Code
                </button>
        </div>
    </div>
    <div id="brush-cursor" class="brush-cursor"></div>

    <!-- GENERATION MODAL -->
    <div id="genModal" class="focus-overlay" style="display:none;">
        <div class="focus-card" style="max-width:850px;">
            <span class="focus-close" onclick="closeGenModal()"></span>
            <h2 style="margin:0 0 20px 0;"> Generate New Practice</h2>

            <div class="gen-modal-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <div style="display: flex; gap: 20px; align-items: center;">
                        <label class="mistake-toggle">
                            <input type="checkbox" id="genIncludeMistakes">
                            <span>Include <strong>Mistake Vault</strong> </span>
                        </label>
                        <label class="mistake-toggle"
                            style="background: rgba(116, 185, 255, 0.1); border-color: rgba(116, 185, 255, 0.3);">
                            <input type="checkbox" id="genVideoOnly">
                            <span style="color: var(--secondary);">Include <strong>Videos Only</strong> </span>
                        </label>
                    </div>
                    <div class="filter-mode-toggle">
                        <span class="toggle-label">OR</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="genFilterMode">
                            <span class="slider"></span>
                        </label>
                        <span class="toggle-label">AND</span>
                    </div>
                </div>

                <div class="filter-grid">
                    <div class="filter-section">
                        <h3>Level</h3>
                        <div class="checkbox-list">
                            <label class="checkbox-item"><input type="checkbox" class="gen-lvl" value="P1"> P1</label>
                            <label class="checkbox-item"><input type="checkbox" class="gen-lvl" value="P2"> P2</label>
                            <label class="checkbox-item"><input type="checkbox" class="gen-lvl" value="P3"> P3</label>
                            <label class="checkbox-item"><input type="checkbox" class="gen-lvl" value="P4"> P4</label>
                            <label class="checkbox-item"><input type="checkbox" class="gen-lvl" value="P5"> P5</label>
                            <label class="checkbox-item"><input type="checkbox" class="gen-lvl" value="P6"> P6</label>
                        </div>
                    </div>

                    <div class="filter-section">
                        <h3>Difficulty</h3>
                        <div class="checkbox-list">
                            <label class="checkbox-item"><input type="checkbox" class="gen-dif" value="Easy">
                                Easy</label>
                            <label class="checkbox-item"><input type="checkbox" class="gen-dif" value="Medium">
                                Medium</label>
                            <label class="checkbox-item"><input type="checkbox" class="gen-dif" value="Hard">
                                Hard</label>
                        </div>
                    </div>

                    <div class="filter-section">
                        <h3>Topics</h3>
                        <div id="genTopicList" class="checkbox-list">
                            <!-- Populated via JS -->
                        </div>
                    </div>

                    <div class="filter-section">
                        <h3>Schools</h3>
                        <div id="genSchoolList" class="checkbox-list">
                            <!-- Populated via JS -->
                        </div>
                    </div>
                    <div class="filter-section">
                        <h3>Concepts/Tags (#)</h3>
                        <div id="genTagList" class="checkbox-list">
                            <!-- Populated via JS -->
                        </div>
                    </div>
                </div>

                <div class="count-input-wrapper">
                    <label style="margin:0; flex-shrink:0;">Number of Questions:</label>
                    <input type="number" id="genCount" value="10" min="1" max="50" style="width:80px;">
                </div>

                <div class="gen-footer">
                    <button onclick="closeGenModal()" style="background:#eee; color:#333;">Cancel</button>
                    <button onclick="generateAdvancedPaper()" class="gen-btn-primary">Generate Worksheet </button>
                </div>
            </div>
        </div>
    </div>

    <!-- EDIT MODAL -->
    <div id="editModal" class="focus-overlay" style="display:none; z-index:30000;">
        <div class="focus-card" style="max-width:700px;">
            <span class="focus-close" onclick="closeEditModal()"></span>
            <h2 style="margin:0 0 20px 0;"> Edit Question</h2>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:15px;">
                <div class="control-group">
                    <label>School</label>
                    <input type="text" id="editS">
                </div>
                <div class="control-group">
                    <label>Level</label>
                    <input type="text" id="editL">
                </div>
                <div class="control-group">
                    <label>Topic</label>
                    <input type="text" id="editT">
                </div>
                <div class="control-group">
                    <label>Tags (#)</label>
                    <input type="text" id="editTags" placeholder="#Concept1 #Concept2">
                </div>
                <div class="control-group">
                    <label>Difficulty</label>
                    <select id="editD">
                        <option value="Easy">Easy</option>
                        <option value="Medium">Medium</option>
                        <option value="Hard">Hard</option>
                    </select>
                </div>
            </div>
            <div class="control-group" style="margin-bottom:15px;">
                <label>Question Text</label>
                <textarea id="editQ" style="height:100px;"></textarea>
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:15px;">
                <div class="control-group">
                    <label>Correct Answer</label>
                    <input type="text" id="editA">
                </div>
                <div class="control-group">
                    <label>Unit/Suffix</label>
                    <input type="text" id="editU" placeholder="e.g. cm, kg">
                </div>
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:15px;">
                <div class="control-group">
                    <label>Image URL</label>
                    <input type="text" id="editImg">
                </div>
                <div class="control-group">
                    <label>Video URL</label>
                    <input type="text" id="editVid">
                </div>
            </div>
            <div class="control-group" style="margin-bottom:20px;">
                <label>Explanation</label>
                <textarea id="editExp" style="height:80px;"></textarea>
            </div>

            <div id="editPreview"
                style="margin-bottom:20px; padding:20px; border:2px dashed var(--accent); border-radius:12px; display:none; background:white; position:relative;">
                <h4 style="margin:0 0 10px 0; color:var(--accent);">Live Preview</h4>
                <div id="editPreviewContent"></div>
            </div>

            <div class="gen-footer">
                <input type="hidden" id="editQId">
                <button onclick="previewEdit()"
                    style="background:#55acee; color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:600;">Preview
                    </button>
                <button onclick="closeEditModal()"
                    style="background:#eee; color:#333; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:600;">Cancel</button>
                <button onclick="saveEdit()" class="gen-btn-primary">Save Changes </button>
            </div>
        </div>
    </div>

    <!-- BROWSE MODAL (INFINITE SCROLL) -->
    <div id="browseModal" class="focus-overlay" style="display:none; align-items:flex-start; padding-top:40px;">
        <div class="focus-card" style="max-width:900px; height:85vh; display:flex; flex-direction:column;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h2 style="margin:0;"> Browse Question Bank</h2>
                <div style="display:flex; align-items:center; gap:10px;">
                    <label style="font-size:0.9rem; font-weight:600;">Sort By:</label>
                    <select id="browseSortOrder" onchange="initBrowseList()"
                        style="padding:6px 12px; border-radius:6px; border:1px solid #ddd; font-family:inherit;">
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                    </select>
                    <span class="focus-close" onclick="closeBrowseModal()"
                        style="position:static; margin-left:15px;"></span>
                </div>
            </div>

            <div id="browseList"
                style="flex:1; overflow-y:auto; padding:10px; background:#f8f9fa; border-radius:12px; border:1px solid #eee;">
                <!-- Batches of 10 questions will load here -->
            </div>

            <div id="browseLoader"
                style="text-align:center; padding:15px; display:none; color:var(--accent); font-weight:600;">
                <div class="spinner-small spinner-browse"
                    style="display:inline-block; vertical-align:middle; margin-right:8px;"></div>
                Loading more questions...
            </div>
        </div>
    </div>

    <!-- QUESTION PREVIEW MODAL -->
    <div id="questionPreviewModal" class="focus-overlay" style="display:none; z-index:20000;">
        <div id="previewModalContainer">
            <span class="focus-close" onclick="closeQuestionPreview()"
                style="position:absolute; top:20px; right:25px;"></span>

            <div class="preview-section">
                <div class="preview-label">Question Metadata</div>
                <div id="prevMeta" style="font-weight:600; font-size:1.1rem; color:var(--accent);"></div>
            </div>

            <div class="preview-section">
                <div class="preview-label">Question Text</div>
                <div id="prevQ" style="font-size:1.2rem; line-height:1.5;"></div>
                <div id="prevImg" style="margin-top:15px;"></div>
            </div>

            <div class="preview-section">
                <div class="preview-label">Answer Key</div>
                <div id="prevA" style="font-size:1.1rem; color:#27ae60; font-weight:700;"></div>
            </div>

            <div class="preview-section" id="prevExpSection">
                <div class="preview-label">Detailed Explanation</div>
                <div id="prevExp" class="explanation-box" style="display:block;"></div>
            </div>

            <div class="preview-section" id="prevVidSection">
                <div class="preview-label">Video Explanation</div>
                <div id="prevVid"></div>
            </div>

            <div style="text-align:center; margin-top:30px; display:flex; justify-content:center; gap:15px;">
                <button id="prevAddBtn" class="gen-btn-primary" style="padding:12px 40px; font-size:1.1rem;">Add to
                    Worksheet </button>
                <button id="prevEditBtn" class="gen-btn-primary"
                    style="padding:12px 40px; font-size:1.1rem; background:var(--admin);"> Edit Question</button>
            </div>
        </div>
    </div>

    <script id="db-data" type="application/json">
        [
        {
            "s": "Polymath",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Hard",
            "q": "Mr Toh wants to make 25 small bows and 22 big bows. The length of ribbon used to make 6 big bows is the same as 8 small bows. He managed to make 10 big bows and 16 small bows with 1320 cm of ribbon.<br><br>a) How many small bows can he make with the same length of ribbon needed to make 12 big bows?<br>b) What is the length of ribbon needed to make the remaining bows?",
            "a": "a) 16, b) 1125 cm",
            "u": "",
            "img": "",
            "vid": "https://www.dropbox.com/scl/fi/2hfzanypy0brph9u8ryeu/Screen-Recording-2025-09-17-at-3.18.41-PM.mov?rlkey=bh4dfq57y6hzi248is7426tu4&dl=0",
            "tags": "Ratio, Units, Ribbon",
            "exp": "1. Find the ratio of ribbon for big vs small bows:<br>6 Big = 8 Small -> 3 Big = 4 Small -> 1 Big = 4/3 Small.<br>2. Set units: Let 1 Small = 3u, then 1 Big = 4u.<br>3. Calculate units for the first batch:<br>10 Big + 16 Small = 10(4u) + 16(3u) = 40u + 48u = 88u.<br>4. Find the value of 1u:<br>88u = 1320 cm -> 1u = 1320 / 88 = 15 cm.<br>5. Solve (a):<br>12 Big bows = 12(4u) = 48u.<br>Number of Small bows = 48u / 3u = 16.<br>6. Solve (b):<br>Total needed = 25 Small + 22 Big = 25(3u) + 22(4u) = 75u + 88u = 163u.<br>Remaining = 163u - 88u = 75u.<br>Length = 75 * 15 cm = 1125 cm.",
            "diffScore": 80,
            "id": "q_poly_ribbon_1"
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "$9 060 450 = 9 000 000 + ______ 450 (1) 60 (2) 6000 (3) 60 000 (4) 600 000",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "9 060 450 - 9 000 000 - 450 = 60 000",
            "diffScore": 20
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Operations",
            "dif": "Easy",
            "q": "Find the value of $16 + 40 \\div 4 \\times 2$. (1) 7 (2) 21 (3) 28 (4) 36",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "16 + (40 / 4) * 2 = 16 + 10 * 2 = 16 + 20 = 36",
            "diffScore": 30
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Fractions",
            "dif": "Easy",
            "q": "What is the value of $\\frac{4}{5} \\times \\frac{3}{10}$? (1) $\\frac{8}{3}$ (2) $\\frac{11}{10}$ (3) $\\frac{7}{15}$ (4) $\\frac{6}{25}$",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "(4 * 3) / (5 * 10) = 12 / 50 = 6 / 25",
            "diffScore": 30
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "10 scouts were each given 10 funfair tickets to sell. 4 of the scouts sold 7 tickets each. The rest of the scouts sold all their tickets. Which one of the following represents the correct way to find how many tickets were left? (1) $(100 - 4) \\times 7 - (6 \\times 10)$ (2) $100 - (4 \\times 7) - (6 \\times 10)$ (3) $(100 - 4 \\times 7 - 6) \\times 10$ (4) $100 - 4 \\times (7 - 6) \\times 10$",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Total = 100. Sold by 4 = 4 * 7. Sold by rest (6) = 6 * 10. Left = Total - Sold1 - Sold2 = 100 - (4*7) - (6*10).",
            "diffScore": 50
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Fractions",
            "dif": "Medium",
            "q": "A box with a mass of 12 kg is 5 times as heavy as a bag. What is the mass of the bag? (1) $\\frac{5}{12}$ kg (2) $\\frac{7}{12}$ kg (3) $1 \\frac{5}{7}$ kg (4) $2 \\frac{2}{5}$ kg",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "Bag = 12 / 5 = 2.4 = 2 2/5 kg.",
            "diffScore": 40
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "Divide 2610 by 30.",
            "a": "87",
            "u": "",
            "img": "",
            "exp": "2610 / 30 = 261 / 3 = 87",
            "diffScore": 20
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "What must be added to 3058 to get half a million?",
            "a": "496 942",
            "u": "",
            "img": "",
            "exp": "500 000 - 3058 = 496 942",
            "diffScore": 40
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Find the value of $14 \\div 4$. Express your answer as a mixed number in its simplest form.",
            "a": "3 1/2",
            "u": "",
            "img": "",
            "exp": "14 / 4 = 7 / 2 = 3 1/2",
            "diffScore": 30
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Fractions",
            "dif": "Medium",
            "q": "Mary had $\\frac{3}{8}$ m of ribbon. June's ribbon was 4 times as long as Mary's ribbon. Find the total length of ribbon Mary and June had. Give your answer in metres.",
            "a": "1 7/8",
            "u": "m",
            "img": "",
            "exp": "June = 4 * 3/8 = 12/8. Total = 3/8 + 12/8 = 15/8 = 1 7/8 m.",
            "diffScore": 50
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Word Problems",
            "dif": "Hard",
            "q": "A box containing 6 identical books weighs 2400 g. The mass of the box is twice the mass of the book. What is the mass of the box? Give your answer in grams.",
            "a": "600",
            "u": "g",
            "img": "",
            "exp": "The box weighs twice as much as a book, so think of the box as 2 units and each book as 1 unit. Total weight is the box (2 units) plus 6 books (6 units), which equals 8 units. 8 units = 2400 g. 1 unit = 2400 / 8 = 300 g. Since the box is 2 units, its mass is 2 * 300 = 600 g.",
            "diffScore": 70
        },
        {
            "s": "ACS Junior",
            "lvl": "P5",
            "top": "Word Problems",
            "dif": "Hard",
            "q": "Adam and Shurui had the same number of marbles. Adam gave away 7 marbles and Shurui gave away 45 marbles. Adam then had 3 times as many marbles as Shurui. How many marbles did Adam and Shurui each have at first?",
            "a": "64",
            "u": "",
            "img": "",
            "exp": "They started with the same number. If Adam gave away 7 and Shurui 45, the difference now is 45 - 7 = 38. Adam now has 3 parts and Shurui has 1 part. The 2-part difference equals 38. 1 part = 38 / 2 = 19. Shurui now has 19, so he started with 19 + 45 = 64.",
            "diffScore": 75
        },
        {
            "s": "Rosyth School",
            "lvl": "P5",
            "top": "Ratio",
            "dif": "Medium",
            "q": "A box has a total of 3180 yellow, pink and black beads. The ratio of the number of yellow beads to the number of pink beads is 2: 3. The ratio of the number of black beads to the total number of beads is 7: 12. a) Write the ratio of the number of yellow beads to the number of black beads to the number of pink beads in the simplest form. b) How many black beads are there in the box?",
            "a": "a) 2 : 7 : 3, b) 1855",
            "u": "",
            "img": "",
            "exp": "(a) From the ratio Black : Total = 7 : 12, Black is 7 parts out of 12. This leaves 12 - 7 = 5 parts for Yellow and Pink combined. From Yellow : Pink = 2 : 3, we see Yellow and Pink also total 5 units (2 + 3). So Yellow = 2 parts, Pink = 3 parts, and Black = 7 parts. Ratio Yellow : Black : Pink = 2 : 7 : 3.<br><br>(b) The total of 12 units = 3180 beads. 1 unit = 3180 / 12 = 265. Black beads = 7 units = 7 * 265 = 1855.",
            "diffScore": 60
        },
        {
            "s": "Henry Park",
            "lvl": "P3",
            "top": "Numbers",
            "dif": "Easy",
            "q": "Three thousand and sixty-two in numbers is (1) 3062 (2) 3602 (3) 3620 (4) 3622",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "Three thousand = 3000<br>Sixty-two = 62<br>3000 + 62 = 3062",
            "diffScore": 15
        },
        {
            "s": "Tao Nan",
            "lvl": "P3",
            "top": "Fractions",
            "dif": "Medium",
            "q": "Which of the following fractions is the greatest? (\\frac{2}{3}, \\frac{3}{4}, \\frac{5}{6}, \\frac{7}{12})",
            "a": "\\frac{5}{6}",
            "u": "",
            "img": "",
            "exp": "Convert to common denominator 12:<br>2/3 = 8/12<br>3/4 = 9/12<br>5/6 = 10/12<br>7/12 = 7/12<br>The greatest is 10/12, which is 5/6.",
            "diffScore": 45
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Mass",
            "dif": "Medium",
            "q": "Arrange these masses from the lightest to the heaviest.<br>2.35 kg, 2 kg 50 g, 2\\frac{3}{10} kg (1) 2.35 kg, 2\\frac{3}{10} kg, 2 kg 50 g (2) 2\\frac{3}{10} kg, 2.35 kg, 2 kg 50 g (3) 2 kg 50 g, 2.35 kg, 2\\frac{3}{10} kg (4) 2 kg 50 g, 2\\frac{3}{10} kg, 2.35 kg",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "Convert all to decimals in kg:<br>2.35 kg = 2.35 kg<br>2 kg 50 g = 2.05 kg<br>2 3/10 kg = 2.3 kg<br>Order: 2.05, 2.3, 2.35<br>So: 2 kg 50 g, 2 3/10 kg, 2.35 kg",
            "diffScore": 40
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "How many eighths are there in 3\\frac{5}{8}? (1) 35 (2) 29 (3) 23 (4) 16",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "3 5/8 = (3 * 8 + 5) / 8 = (24 + 5) / 8 = 29/8<br>So there are 29 eighths.",
            "diffScore": 25
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Easy",
            "q": "There are 48 chocolates in a box. 36 of them are milk chocolates while the rest are dark chocolates. What is the ratio of the number of dark chocolates to the number of milk chocolates? (1) 1 : 3 (2) 1 : 4 (3) 3 : 1 (4) 3 : 4",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "Total = 48<br>Milk = 36<br>Dark = 48 - 36 = 12<br>Ratio Dark : Milk = 12 : 36 = 1 : 3",
            "diffScore": 20
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "Lisa packed 60 cream cookies and 75 mint cookies into as many boxes as possible. She packed the same number of each type of cookies in each box. How many mint cookies were there in each box? (1) 5 (2) 9 (3) 15 (4) 4",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "Find HCF of 60 and 75.<br>60 = 2 * 2 * 3 * 5<br>75 = 3 * 5 * 5<br>HCF = 3 * 5 = 15 (This is the number of boxes)<br>Mint cookies per box = 75 / 15 = 5",
            "diffScore": 50
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "A baker had 300 eggs at first. In the morning, he used some eggs. In the afternoon, he used \\frac{1}{3} of the remaining eggs. After that, there were 60 eggs left. How many eggs did the baker use in the morning?",
            "a": "210",
            "u": "",
            "img": "",
            "exp": "Afternoon used 1/3 of remainder, so 2/3 of remainder left.<br>2/3 of remainder = 60<br>1/3 of remainder = 30<br>Remainder (after morning) = 90<br>Used in morning = Total - Remainder = 300 - 90 = 210",
            "diffScore": 75
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Medium",
            "q": "There were 50 red pens and 230 blue pens. After an equal number of red and blue pens were added, the ratio of the number of red pens to the number of blue pens became 1 : 3. How many red pens were there in the end?",
            "a": "90",
            "u": "",
            "img": "",
            "exp": "The difference between red and blue pens remains constant because an equal number was added to both. Initial difference = $230 - 50 = 180$. In the final ratio of 1 : 3, the difference is 2 units. 2 units = 180, so 1 unit = 90. Red pens in the end represent 1 unit, which is 90.",
            "diffScore": 55
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Hard",
            "q": "A box contained some yellow cubes and 72 blue cubes. 40% of the cubes were yellow. After some red cubes were added into the box, 32% of the cubes were yellow. How many red cubes were there?",
            "a": "30",
            "u": "",
            "img": "",
            "exp": "At first, blue cubes are 100% - 40% = 60%. 60% = 72, so 1% = 1.2. Counting yellow cubes: 40% = 40 * 1.2 = 48 yellow cubes (total 120 cubes).<br>After adding red cubes, the 48 yellow cubes now represent only 32% of the new total. New 1% = 48 / 32 = 1.5. New total (100%) = 150 cubes. Red cubes added = 150 - 120 = 30.",
            "diffScore": 80
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "After Aini gave \\frac{1}{6} of her stickers away and Bala gave \\frac{1}{4} of his stickers away, both of them had the same number of stickers left. The total number of stickers Aini and Bala gave away was 2280. How many stickers did Bala have at first?",
            "a": "5700",
            "u": "",
            "img": "",
            "exp": "Aini left with 5/6 of her stickers, Bala with 3/4. Since 5/6 of A = 3/4 of B, let's make the numerators the same for a common unit: 15/18 of A = 15/20 of B. This means A has 18 units and B has 20 units at first. Stickers given away: Aini gave 3 units (18 - 15), Bala gave 5 units (20 - 15). Total given = 8 units = 2280. 1 unit = 2280 / 8 = 285. Bala at first = 20 units = 20 * 285 = 5700.",
            "diffScore": 85
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Average",
            "dif": "Medium",
            "q": "The average height of a group of 3 girls and 5 boys was 160 cm. The average height of the 3 girls was 12 cm less than the average height of the 5 boys. Find the average height of the 5 boys.",
            "a": "164.5 cm",
            "u": "",
            "img": "",
            "exp": "Total height for all 8 children = 8 * 160 = 1280 cm. If the average height of the 3 girls was 12 cm less than the boys, then the total height of the girls is $3 \\times 12 = 36$ cm less than if they were as tall as the boys. If everyone were 'boys', the total would be $1280 + 36 = 1316$ cm. Average of these 8 'boys' = 1316 / 8 = 164.5 cm.",
            "diffScore": 65
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Hard",
            "q": "At a concert, there were 30% more women than men and 25% more boys than girls. There were 250 people at the concert with as many males as females. How many girls were there at the concert?",
            "a": "60",
            "u": "",
            "img": "",
            "exp": "Total people = 250. Half are female, so 125 women and girls. Half are male, so 125 men and boys.<br>There are 30% more women than men (Ratio 13:10) and 25% more boys than girls (Ratio 5:4).<br>Women (13 parts w) + Girls (4 parts g) = 125.<br>Men (10 parts w) + Boys (5 parts g) = 125.<br>Comparing the two, we see that 3 parts of 'w' equals 1 part of 'g' (since $13w + 4g = 10w + 5g$).<br>Substitute $g = 3w$ into the female group: $13w + 4(3w) = 13w + 12w = 25w = 125$.<br>So $w = 5$. Girls = $12 \\times 5 = 60$.",
            "diffScore": 90
        },
        {
            "s": "Tao Nan",
            "lvl": "P5",
            "top": "Decimals",
            "dif": "Easy",
            "q": "Which of the following decimals is the smallest? (1) 0.15 (2) 0.51 (3) 0.105 (4) 0.501",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "Compare place values:<br>0.150<br>0.510<br>0.105<br>0.501<br>0.105 is the smallest.",
            "diffScore": 15
        },
        {
            "s": "Tao Nan",
            "lvl": "P5",
            "top": "Measurement",
            "dif": "Easy",
            "q": "Which of the following is the same as 2040 cm? (1) 0.24 m (2) 2.04 m (3) 2 m 40 cm (4) 20 m 40 cm",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "1 m = 100 cm<br>2040 cm = 2000 cm + 40 cm = 20 m + 40 cm",
            "diffScore": 20
        },
        {
            "s": "Tao Nan",
            "lvl": "P5",
            "top": "Time",
            "dif": "Medium",
            "q": "Rachel watched a movie at the cinema. The movie lasted for 2 h 15 min. After the movie ended, she walked 25 minutes to reach her home. She reached home at 6.55 p.m. What time did the movie start? (1) 4.15 p.m. (2) 4.40 p.m. (3) 7.20 p.m. (4) 9.35 p.m.",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "Work backwards from 6.55 p.m.<br>Minus walk (25 min) -> 6.30 p.m.<br>Minus movie (2 h 15 min) -> 4.15 p.m.",
            "diffScore": 45
        },
        {
            "s": "Tao Nan",
            "lvl": "P5",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "Alex and Ben had $190 altogether at first. After Alex gave Ben $30, Alex had $40 more than Ben. How much did Ben have at first? (1) $45 (2) $75 (3) $120 (4) $160",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "The total of $190 doesn't change. If Alex had $40 more than Ben in the end, twice Ben's final amount is $190 - $40 = $150. Ben's final amount = $150 / 2 = $75. Ben received $30 from Alex, so Ben started with $75 - $30 = $45.",
            "diffScore": 55
        },
        {
            "s": "Tao Nan",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "Joe baked some chocolate muffins and vanilla muffins. He sold an equal number of chocolate muffins and vanilla muffins. He had \\frac{3}{4} of the vanilla muffins and \\frac{3}{7} of the chocolate muffins left. What fraction of the muffins were sold? (1) \\frac{5}{28} (2) \\frac{8}{23} (3) \\frac{23}{28} (4) \\frac{15}{23}",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Vanilla: Left 3/4, so Sold 1/4. Chocolate: Left 3/7, so Sold 4/7. Since Sold V = Sold C, 1/4 of Vanilla equals 4/7 of Chocolate. This means Vanilla = 16 units and Chocolate = 7 units. Total muffins = 23 units. Amount sold = 1/4 of 16 (4 units) + 4/7 of 7 (4 units) = 8 units. Fraction sold = 8/23.",
            "diffScore": 75
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Medium",
            "q": "Which one of the following fractions is smaller than \\frac{3}{8}? (1) \\frac{1}{2} (2) \\frac{2}{7} (3) \\frac{5}{9} (4) \\frac{5}{12}",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "3/8 = 0.375<br>1/2 = 0.5 (Larger)<br>2/7 \\approx 0.285 (Smaller)<br>5/9 \\approx 0.55 (Larger)<br>5/12 \\approx 0.41 (Larger)",
            "diffScore": 40
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Easy",
            "q": "Rosy had 300 buttons. She used 45 buttons for her project. What percentage of her buttons did she use for her project? (1) 85% (2) 55% (3) 45% (4) 15%",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "Percentage = (45 / 300) * 100% = (15 / 100) * 100% = 15%",
            "diffScore": 25
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Measurement",
            "dif": "Medium",
            "q": "Arrange these distances from the shortest to the longest.<br>4.05 km, 4 km 25 m, 4\\frac{2}{5} km (1) 4.05 km, 4\\frac{2}{5} km, 4 km 25 m (2) 4 km 25 m, 4.05 km, 4\\frac{2}{5} km (3) 4 km 25 m, 4\\frac{2}{5} km, 4.05 km (4) 4\\frac{2}{5} km, 4 km 25 m, 4.05 km",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Convert to km:<br>4.05 km<br>4 km 25 m = 4.025 km<br>4 2/5 km = 4.4 km<br>Order: 4.025, 4.05, 4.4<br>So: 4 km 25 m, 4.05 km, 4 2/5 km",
            "diffScore": 45
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Hard",
            "q": "Freddy had $250 and Karina had $100 at first. After both of them spent an equal amount of money on a present, the amount of Freddy's money left was \\frac{7}{2} of the amount of Karina's money left. How much money did Freddy have left? (1) $220 (2) $210 (3) $80 (4) $60",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "The difference between their money remains the same since they spent the same amount. Difference = $250 - 100 = 150$. In the end, the ratio Freddy : Karina is 7 : 2, which has a difference of 5 units. Each unit = 150 / 5 = 30. Freddy left = 7 units = 7 * 30 = 210.",
            "diffScore": 70
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "George packed 84 pears and 96 mangoes into as many bags as possible with no fruits left unpacked. He packed the same number of fruits in each bag. The number of each type of fruit in each bag was the same. How many bags of fruits did George pack? (1) 7 (2) 8 (3) 12 (4) 15",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "Find HCF of 84 and 96.<br>84 = 12 * 7<br>96 = 12 * 8<br>HCF = 12. So 12 bags.",
            "diffScore": 50
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Decimals",
            "dif": "Easy",
            "q": "Round 17.445 to the nearest tenth.",
            "a": "17.4",
            "u": "",
            "img": "",
            "exp": "Look at hundredths digit (4). It is < 5, so round down.<br>17.4",
            "diffScore": 15
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Find the value of \\frac{6}{7} \\div 15. Give your answer as a fraction in the simplest form.",
            "a": "\\frac{2}{35}",
            "u": "",
            "img": "",
            "exp": "6/7 / 15 = 6/7 * 1/15 = 6/105 = 2/35",
            "diffScore": 25
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Medium",
            "q": "Desmond used pink stars and green stars to decorate a photo frame for his mother. For every 5 pink stars Desmond used, he used 4 green stars. Desmond used a total of 72 stars. How many green stars did Desmond use for the photo frame?",
            "a": "32",
            "u": "",
            "img": "",
            "exp": "Ratio P : G = 5 : 4. Total units = 9.<br>9u = 72 -> 1u = 8.<br>Green = 4u = 4 * 8 = 32",
            "diffScore": 45
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Mass",
            "dif": "Medium",
            "q": "The total mass of 6 pails is 6.54 kg. Each pail has the same mass. What is the mass of 9 such pails?",
            "a": "9.81 kg",
            "u": "",
            "img": "",
            "exp": "Mass of 1 pail = 6.54 / 6 = 1.09 kg<br>Mass of 9 pails = 1.09 * 9 = 9.81 kg",
            "diffScore": 40
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "Alizah baked some cupcakes. She gave \\frac{1}{6} of the cupcakes to her siblings and \\frac{1}{4} of the cupcakes to her classmates. She sold \\frac{1}{2} of the remaining cupcakes. At the end of the day, she was left with 49 cupcakes. How many cupcakes did Alizah give to her siblings?",
            "a": "28",
            "u": "",
            "img": "",
            "exp": "Gave away: 1/6 + 1/4 = 2/12 + 3/12 = 5/12.<br>Remaining: 7/12.<br>Sold 1/2 of remaining, so left with 1/2 of remaining.<br>Left = 1/2 * 7/12 = 7/24.<br>7/24 = 49 -> 1/24 = 7 -> Total = 168.<br>Siblings = 1/6 * 168 = 28",
            "diffScore": 80
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "At first, the cans in a shop were placed on 60 shelves with an equal number of cans on each shelf. 6 shelves were removed and the cans on these shelves were placed on the remaining 54 shelves. The number of cans on each remaining shelf was 40. How many cans were removed from the 6 shelves?",
            "a": "216",
            "u": "",
            "img": "",
            "exp": "Total cans = 54 * 40 = 2160.<br>Original cans per shelf = 2160 / 60 = 36.<br>Cans removed = 6 * 36 = 216",
            "diffScore": 60
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Money",
            "dif": "Medium",
            "q": "Benson had three fewer $1 coins than 20-cent coins. He used all his $1 coins and two 20-cent coins. The total value of the 20-cent coins left was $2. How much money did Benson use?",
            "a": "$9.40",
            "u": "",
            "img": "",
            "exp": "20c coins left value = $2 -> 10 coins.<br>Used 2 20c coins, so total 20c coins = 12.<br>$1 coins = 12 - 3 = 9.<br>Used all 9 $1 coins ($9) and two 20c coins ($0.40).<br>Total used = $9.40",
            "diffScore": 55
        },
        {
            "s": "CHIJ St Nicholas",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Hard",
            "q": "A file cost $3.10 more than a pen. Hakim bought twice as many pens as files. He spent a total of $92.70. He spent $6.30 more on the files than on the pens. Find the total cost of a pen and a file.",
            "a": "$7.90",
            "u": "",
            "img": "",
            "exp": "Hakim bought twice as many pens as files. He spent $6.30 more on files than pens. The total cost of files = ($92.70 + 6.30) / 2 = $49.50. Total cost of pens = $92.70 - 49.50 = $43.20. Since he bought 9 files (based on the price difference), each file is $49.50 / 9 = $5.50. He bought 18 pens, so each pen is $43.20 / 18 = $2.40. Total for one of each = 5.50 + 2.40 = 7.90.",
            "diffScore": 85
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Hard",
            "q": "A fitness club had 280 members in 2023. 40% of the members were females and the rest were males. In 2024, the number of male members increased by 37.5% and the female members dropped to 84 members.<br>(a) Find the percentage decrease in the number of female members from 2023 to 2024.<br>(b) What was the total number of members in the fitness club in 2024?",
            "a": "(a) 25%, (b) 315",
            "u": "",
            "img": "",
            "exp": "(a)<br>2023 Females = 40% of 280 = 112.<br>2024 Females = 84.<br>Decrease = 112 - 84 = 28.<br>% Decrease = (28 / 112) * 100% = 25%<br><br>(b)<br>2023 Males = 280 - 112 = 168.<br>Increase 37.5% = 3/8.<br>Increase = 168 * 3/8 = 63.<br>2024 Males = 168 + 63 = 231.<br>Total 2024 = 231 + 84 = 315",
            "diffScore": 85
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Word Problems",
            "dif": "Hard",
            "q": "Paul and Zalim went out together with a total of $140.20. Zalim spent 4 times as much money as Paul. The amount of money Paul had left was $12 more than \\frac{1}{2} of what Zalim spent. The amount of money Zalim had left was \\frac{1}{5} of what Paul had left.<br>(a) How much money did Paul spend?<br>(b) How much money did Zalim have at first?",
            "a": "(a) $17, (b) $77.20",
            "u": "",
            "img": "",
            "exp": "(a) Let's use the 'units method'. Zalim spent 4 units, so Paul spent 1 unit. Total spent = 5 units. Paul's left = (1/2 of Zalim's spent) + 12 = 2 units + 12. Zalim's left = 1/5 of Paul's left = (2/5 unit + 12/5). Total money (140.20) = 5 units (spent) + (2 units + 12) + (0.4 units + 2.40) = 7.4 units + 14.40. 7.4 units = 125.80. 1 unit = 17. Paul spent = $17.<br><br>(b) Zalim spent = 4 * 17 = 68. Paul left = 2(17) + 12 = 46. Zalim left = 46 / 5 = 9.20. Zalim at first = 68 + 9.20 = $77.20.",
            "diffScore": 90
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "12 + 6 \\div 2 \\times 3 = ________.<br>(1) 13 (2) 21 (3) 27 (4) 45",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Order of operations (BODMAS):<br>1. Division: 6 / 2 = 3<br>2. Multiplication: 3 * 3 = 9<br>3. Addition: 12 + 9 = 21",
            "diffScore": 30
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Time",
            "dif": "Easy",
            "q": "The duration of a movie is 1 hour and 40 minutes. The movie ended at 5.30 p.m. What time did the movie begin? (1) 03 50 (2) 07 10 (3) 15 50 (4) 19 10",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "End: 5.30 p.m.<br>Minus 1 h -> 4.30 p.m.<br>Minus 40 min -> 3.50 p.m.<br>3.50 p.m. in 24h format is 15 50.",
            "diffScore": 35
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Measurement",
            "dif": "Medium",
            "q": "Arrange these distances from the longest to the shortest.<br><div style='border:1px solid black; padding:5px; text-align:center; margin:10px 0;'>1\\frac{1}{4} km &nbsp;&nbsp;&nbsp; 1 km 40 m &nbsp;&nbsp;&nbsp; 1.3 km</div>(1) 1 km 40 m, 1.3 km, 1\\frac{1}{4} km<br>(2) 1.3 km, 1\\frac{1}{4} km, 1 km 40 m<br>(3) 1\\frac{1}{4} km, 1.3 km, 1 km 40 m<br>(4) 1\\frac{1}{4} km, 1 km 40 m, 1.3 km",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Convert all to km:<br>1 1/4 km = 1.25 km<br>1 km 40 m = 1.04 km<br>1.3 km = 1.3 km<br>Order Longest to Shortest: 1.3, 1.25, 1.04<br>So: 1.3 km, 1 1/4 km, 1 km 40 m",
            "diffScore": 45
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "Roy and Jaya finished eating a jar of cookies over 2 days. On the first day, Roy ate 3 more cookies than Jaya. On the second day, Roy ate 12 cookies and Jaya ate 8 cookies. Jaya ate \\frac{2}{5} of the total number of cookies. How many cookies did Roy eat? (1) 15 (2) 21 (3) 23 (4) 35",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Roy Day 1 = Jaya Day 1 + 3. Adding the cookies from Day 2: Roy total = (Jaya Day 1 + 3) + 12 = Jaya Day 1 + 15. Jaya total = Jaya Day 1 + 8. If Jaya's total is 2/5 of the jars, Roy's total must be 3/5. The difference (Roy - Jaya) is 15 - 8 = 7 cookies. This difference (3/5 - 2/5) is 1/5 of the jar. So 1/5 = 7 cookies. Jaya's 2/5 = 14 cookies. Roy's 3/5 = 21 cookies.",
            "diffScore": 80
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Hard",
            "q": "The ratio of the number of girls in Team A to the number of girls in Team B is 2 : 3. The ratio of the number of boys in Team A to the number of boys in Team B is 5 : 3. In Team A, the ratio of the number of girls to the number of boys is 4 : 3. What is the ratio of the number of girls to the number of boys in Team B? (1) 1 : 1 (2) 2 : 1 (3) 2 : 3 (4) 10 : 3",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "In Team A, Girls : Boys = 4 : 3. To make it easier to compare with other ratios, let Team A have 20 units of girls and 15 units of boys. For the girls, B has 3/2 as many as A, so Team B has 30 units of girls. For the boys, B has 3/5 as many as A, so Team B has 0.6 * 15 = 9 units of boys. Ratio in Team B Girls : Boys = 30 : 9 = 10 : 3.",
            "diffScore": 75
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Find the value of \\frac{4}{5} \\div 20. Give your answer as a fraction in the simplest form.",
            "a": "\\frac{1}{25}",
            "u": "",
            "img": "",
            "exp": "4/5 / 20 = 4/5 * 1/20 = 4/100 = 1/25",
            "diffScore": 25
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Average",
            "dif": "Medium",
            "q": "The full mark for each test is 100. In the first 4 tests, Ali scored an average of 68 marks. He wants to increase his average test score to 74 marks. How many marks must he score for the 5th test?",
            "a": "98",
            "u": "",
            "img": "",
            "exp": "Total for 4 tests = 4 * 68 = 272.<br>Target Total for 5 tests = 5 * 74 = 370.<br>Score needed = 370 - 272 = 98",
            "diffScore": 55
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "Jane spent \\frac{3}{5} of her money on a pair of shoes. She then spent $5 more than \\frac{1}{4} of the remainder on a dress. The dress cost $35. How much money did she have at first?",
            "a": "$300",
            "u": "",
            "img": "",
            "exp": "The dress cost $35, which was $5 more than a quarter of the remainder. So 1/4 of the remainder is $30, and the whole remainder is $120. This remainder ($120) is what was left after spending 3/5 on shoes, so it represents 2/5 of the total money. Thus 1/5 is $60, and the total at first was $60 * 5 = $300.",
            "diffScore": 75
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Word Problems",
            "dif": "Hard",
            "q": "At an event, there was a total of 1446 boys and girls at first. During the break, 20 boys and \\frac{3}{8} of the girls went home. The number of girls remaining was \\frac{1}{3} the number of boys remaining. What was the difference in the number of boys and girls at first?",
            "a": "454",
            "u": "",
            "img": "",
            "exp": "5/8 of the girls remained, while boys remaining was (B - 20). Since 5/8 G = 1/3 (B - 20), we know 15/8 G = B - 20. Total G + B = 1446. Substituting, G + (15/8 G + 20) = 1446. 23/8 G = 1426. 1/8 G = 62. Total girls = 62 * 8 = 496. Total boys = 1446 - 496 = 950. Difference = 950 - 496 = 454.",
            "diffScore": 85
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Hard",
            "q": "The amount of money Bala had was 60% that of Alan's.<br>(a) Alan had $52. How much did Bala have?<br>(b) After receiving some money from his mother, Bala's amount of money increased by 20%. By what percentage must Alan's money decrease so that they have the same amount of money?",
            "a": "(a) $31.20, (b) 28%",
            "u": "",
            "img": "",
            "exp": "(a) Bala = 60% of 52 = $31.20.<br><br>(b) Let Alan have 100 units and Bala have 60 units. Bala's money increases by 20% to 72 units. For Alan to have the same (72 units), his money must drop by 28 units out of 100, which is 28%.",
            "diffScore": 85
        },
        {
            "s": "Nan Hua Primary",
            "lvl": "P6",
            "top": "Money",
            "dif": "Hard",
            "q": "Tracy had five more 50-cent coins than 20-cent coins. After she used eight 50-cent coins, the value of the 50-cent coins is $6.30 more than the value of 20-cent coins. How many coins did she have at first?",
            "a": "57",
            "u": "",
            "img": "",
            "exp": "Tracy had 5 more 50-cent coins than 20-cent coins. After using eight 50-cent coins, she had 3 fewer 50-cent coins than 20-cent coins. Let u be the number of 20-cent coins. Value of 50c coins (0.50 * (u - 3)) - Value of 20c coins (0.20 * u) = $6.30. 0.3u - 1.50 = 6.30. 0.3u = 7.80. u = 26. At first, she had 26 of 20c and 31 of 50c. Total coins = 57.",
            "diffScore": 80
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "Round 31 899 to the nearest thousand. (1) 30 000 (2) 31 000 (3) 31 900 (4) 32 000",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "Look at hundreds digit (8). It is >= 5, so round up.<br>32 000",
            "diffScore": 15
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Decimals",
            "dif": "Easy",
            "q": "What does the digit 8 in 7.089 stand for? (1) 8 tens (2) 8 tenths (3) 8 hundredths (4) 8 thousandths",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "7.089<br>0 is tenths<br>8 is hundredths<br>9 is thousandths",
            "diffScore": 15
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Medium",
            "q": "Bernice has three ropes, J, K and L. The ratio of the length of Rope J to the length of Rope K is 5 : 8. Rope K is \\frac{4}{9} as long as Rope L. What is the ratio of the length of Rope J to the length of Rope L? (1) 8 : 9 (2) 5 : 9 (3) 8 : 18 (4) 5 : 18",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "Ratio J : K = 5 : 8. Rope K is 4/9 of Rope L, so K : L = 4 : 9. To combine them, make K the same (8): K : L = 8 : 18. Now J : K : L = 5 : 8 : 18. So the ratio J : L = 5 : 18.",
            "diffScore": 50
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Ming baked 32 cupcakes. He gave \\frac{5}{8} of the cupcakes to his friend. How many cupcakes did he give to his friend?",
            "a": "20",
            "u": "",
            "img": "",
            "exp": "5/8 * 32 = 5 * 4 = 20",
            "diffScore": 20
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Measurement",
            "dif": "Easy",
            "q": "Convert 72.5 centimetres to metres.",
            "a": "0.725 m",
            "u": "",
            "img": "",
            "exp": "1 m = 100 cm.<br>72.5 cm = 72.5 / 100 m = 0.725 m",
            "diffScore": 20
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "Write down all the common factors of 18 and 45.",
            "a": "1, 3, 9",
            "u": "",
            "img": "",
            "exp": "Factors of 18: 1, 2, 3, 6, 9, 18<br>Factors of 45: 1, 3, 5, 9, 15, 45<br>Common: 1, 3, 9",
            "diffScore": 45
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Decimals",
            "dif": "Medium",
            "q": "Find the value of<br>(a) 5.1 - 3.89<br>(b) 2.02 \\times 2000",
            "a": "(a) 1.21, (b) 4040",
            "u": "",
            "img": "",
            "exp": "(a) 5.10 - 3.89 = 1.21<br>(b) 2.02 * 2000 = 2.02 * 1000 * 2 = 2020 * 2 = 4040",
            "diffScore": 40
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Medium",
            "q": "Last year, the population of Town X was 5600. This year, the population of Town X has increased to 6300. What is the percentage increase in the population of Town X?",
            "a": "12.5%",
            "u": "",
            "img": "",
            "exp": "Increase = 6300 - 5600 = 700.<br>% Increase = (700 / 5600) * 100% = (1/8) * 100% = 12.5%",
            "diffScore": 50
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Hard",
            "q": "Dan packed 840 books into 2 crates and 3 boxes. The number of books he packed into each crate was twice as many as the number of books he packed into each box. How many books did he pack into each box?",
            "a": "120",
            "u": "",
            "img": "",
            "exp": "Think of each box as 1 unit. Since each crate holds twice as much, each crate is 2 units. 2 crates (4 units) + 3 boxes (3 units) = 7 units in total. 7 units = 840 books. 1 unit = 840 / 7 = 120. So each box holds 120 books.",
            "diffScore": 75
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Medium",
            "q": "There was \\frac{3}{8} l of water in a tank at first. Xiao Ming poured \\frac{3}{5} l of water into the tank and used \\frac{5}{8} l of water from the tank to wash the dishes. How much water was left in the tank?",
            "a": "7/20 l",
            "u": "",
            "img": "",
            "exp": "Start: 3/8.<br>Add 3/5: 3/8 + 3/5 = 15/40 + 24/40 = 39/40.<br>Used 5/8: 39/40 - 25/40 = 14/40 = 7/20 l",
            "diffScore": 55
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Medium",
            "q": "Ahmad had 13 m of string. He used it to make as many bracelets as he could. He used \\frac{3}{5} m of string to make each bracelet. How many metres of the string was left?",
            "a": "2/5 m",
            "u": "",
            "img": "",
            "exp": "13 / (3/5) = 13 * 5/3 = 65/3 = 21 R 2.<br>He made 21 bracelets.<br>Used = 21 * 3/5 = 63/5 = 12 3/5 m.<br>Left = 13 - 12 3/5 = 2/5 m",
            "diffScore": 60
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Hard",
            "q": "The usual price of a toaster was $80. A discount of 20% was given during a sale. When Mdm Singh bought the toaster online, an additional $10 discount was given after the discount of 20%. What was the total percentage discount given to Mdm Singh for the toaster?",
            "a": "32.5%",
            "u": "",
            "img": "",
            "exp": "First discount 20%: Price = 80 * 0.8 = 64.<br>Additional $10 off: Price = 64 - 10 = 54.<br>Total Discount = 80 - 54 = 26.<br>% Discount = (26 / 80) * 100% = 32.5%",
            "diffScore": 80
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Data Analysis",
            "dif": "Hard",
            "q": "A museum is open to visitors seven days a week. The total number of visitors from Monday to Friday last week was 1557. The average number of visitors on Monday and Tuesday was fewer than the average number of visitors from Wednesday to Friday.<br>For each statement, state if it is True, False, or Not possible to tell:<br>(a) The average number of visitors from Monday to Friday last week was 311.4 visitors.<br>(b) The average number of visitors from Monday to Sunday last week was 313.5 visitors.<br>(c) The average number of visitors from Wednesday to Friday was fewer than 312.",
            "a": "(a) True, (b) Not possible to tell, (c) Not possible to tell",
            "u": "",
            "img": "",
            "exp": "(a) Average M-F = 1557 / 5 = 311.4. (True)<br>(b) We don't know the visitors for Saturday and Sunday, so we cannot calculate the weekly average. (Not possible to tell)<br>(c) The averages can vary widely as long as M-T average is lower than W-F. We don't have enough specific daily data to know. (Not possible to tell)",
            "diffScore": 85
        },
        {
            "s": "Nanyang Primary",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "Mr Soh spent \\frac{1}{5} of his money on a pair of shoes and \\frac{3}{4} of his remaining money on a bag, a shirt and a hat. The bag cost 3 times as much as the hat. The shirt cost \\frac{1}{2} as much as the hat. The pair of shoes cost $48 more than the shirt. How much money did Mr Soh have at first?",
            "a": "$360",
            "u": "",
            "img": "",
            "exp": "Spent 1/5 on Shoes, leaving 4/5 remainder. He then spent 3/4 of that (which is 3/5 of the total) on the bag, shirt, and hat. Let's use units: Shirt is 1 part, Hat is 2 parts, and Bag is 3 times the Hat, which is 6 parts. Total for these three is 1 + 2 + 6 = 9 parts. These 9 parts represent 3/5 of his total money, so 1/5 of his total money must be 3 parts. The shoes (1/5 of total, so 3 parts) cost $48 more than the shirt (1 part). This means 2 parts = $48, so 1 part = $24. Total money is 15 parts, so 15 * 24 = $360.",
            "diffScore": 90
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "3 710 562 = 3 000 000 + 700 000 + _______ + 500 + 60 + 2 (1) 100 (2) 1000 (3) 10 000 (4) 100 000",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "3 710 562.<br>Missing place is the ten-thousands place (1).<br>So 10 000.",
            "diffScore": 15
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Measurement",
            "dif": "Easy",
            "q": "Which of the following is the same as 40 km 70 m? (1) 40 700 m (2) 40 070 m (3) 4700 m (4) 4070 m",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "40 km = 40 000 m.<br>40 000 + 70 = 40 070 m",
            "diffScore": 20
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Average",
            "dif": "Medium",
            "q": "The total mass of 3 students is 162 kg. Another student, Megan, joins the group. She has a mass of 42 kg. What is the average mass of the 4 students? (1) 55 kg (2) 51 kg (3) 32 kg (4) 24 kg",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Total mass 4 students = 162 + 42 = 204 kg.<br>Average = 204 / 4 = 51 kg",
            "diffScore": 50
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Algebra",
            "dif": "Easy",
            "q": "Simplify 8b + 15 - 3b - 9 (1) 5b + 6 (2) 5b + 24 (3) 11b + 6 (4) 11b + 24",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "Group like terms:<br>(8b - 3b) + (15 - 9) = 5b + 6",
            "diffScore": 30
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Word Problems",
            "dif": "Hard",
            "q": "Alyssa baked some muffins for sale. She sold a total of 480 muffins in the morning. In the afternoon, she sold \\frac{1}{8} of the remaining muffins. In the end, she had 35% of the muffins left. How many muffins did she bake? (1) 520 (2) 648 (3) 792 (4) 800",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "The 35% left represents 7/8 of the muffins that remained after the morning sale. This means each 'eighth' is 35% / 7 = 5%. The full remainder (8/8) is therefore 8 * 5% = 40% of the total. Since the remainder was 40%, the morning sale must have been 60% of the total. 60% = 480 muffins, so 1% = 8 muffins. Total baked (100%) = 800.",
            "diffScore": 85
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Express \\frac{3}{8} as a decimal.",
            "a": "0.375",
            "u": "",
            "img": "",
            "exp": "3 / 8 = 0.375",
            "diffScore": 15
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Easy",
            "q": "Find the missing number in the box.<br>6 : 8 = ? : 36",
            "a": "27",
            "u": "",
            "img": "",
            "exp": "8 * 4.5 = 36.<br>6 * 4.5 = 27",
            "diffScore": 20
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Find the value of \\frac{3}{4} - \\frac{2}{5}",
            "a": "7/20",
            "u": "",
            "img": "",
            "exp": "Common denominator 20.<br>15/20 - 8/20 = 7/20",
            "diffScore": 25
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "Find the value of<br>(a) 18 \\div \\frac{3}{5}<br>(b) (60 - 24) \\div 9 + 3",
            "a": "(a) 30, (b) 7",
            "u": "",
            "img": "",
            "exp": "(a) 18 * 5/3 = 6 * 5 = 30<br>(b) 36 / 9 + 3 = 4 + 3 = 7",
            "diffScore": 40
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "A fruit seller stored oranges in crates A and B. Crate A contained twice as many oranges as crate B. In crate A, \\frac{1}{2} of the oranges were ripe. In crate B, \\frac{5}{6} of the oranges were ripe. What fraction of all the oranges were ripe?",
            "a": "11/18",
            "u": "",
            "img": "",
            "exp": "Let crate B have 6 units. Then crate A has 12 units (double B). Total oranges = 18 units. Ripe in A = 1/2 of 12 = 6 units. Ripe in B = 5/6 of 6 = 5 units. Total ripe = 6 + 5 = 11 units. Fraction ripe = 11/18.",
            "diffScore": 80
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "Mei had 18 more stickers than Aisha at first. After Mei gave some stickers to Aisha, she had 24 fewer stickers than Aisha. How many stickers did Mei give to Aisha?",
            "a": "21",
            "u": "",
            "img": "",
            "exp": "Mei started with 18 more. After giving some away, she had 24 fewer. The total change in the difference is 18 + 24 = 42. Since every sticker Mei gives away decreases her count and increases Aisha's, the difference changes by 2 for every sticker given. So Mei gave 42 / 2 = 21 stickers.",
            "diffScore": 60
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Hard",
            "q": "Callys always spends 70% of her salary. Her salary for December was 40% more than that for November. As a result, she spent $560 more in December than in November. How much was her salary in December?",
            "a": "$2800",
            "u": "",
            "img": "",
            "exp": "If November's salary was 100 units, December's was 140 units. Since she spends 70%, November spending was 70 units and December spending was 70% of 140 = 98 units. The difference in spending is 28 units, which equals $560. 1 unit = $20. December salary = 140 * $20 = $2800.",
            "diffScore": 85
        },
        {
            "s": "MGS Paya Lebar",
            "lvl": "P6",
            "top": "Word Problems",
            "dif": "Hard",
            "q": "Winnie and Sophie were paid a total of $3620 for a job. Winnie was paid $1960 more than Sophie.<br>(a) How much was Winnie paid for the job?<br>(b) Winnie and Sophie were paid based on the number of days they worked. Winnie worked 3 times as many days as Sophie. Winnie was paid $5 more than Sophie per day. How many days did Sophie work?",
            "a": "(a) $2790, (b) 20",
            "u": "",
            "img": "",
            "exp": "(a) Total is $3620 and the difference is $1960. Winnie's pay = ($3620 + 1960) / 2 = $2790. Sophie's pay = $2790 - 1960 = $830.<br><br>(b) Winnie worked 3 times as many days. If Winnie was paid the same rate as Sophie, she would have earned 3 * $830 = $2490. The extra $300 she earned ($2790 - 2490) comes from the extra $5 per day she made. So she worked 300 / 5 = 60 days. Since Winnie worked 60 days (3 times Sophie), Sophie worked 20 days.",
            "diffScore": 90
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "What does the digit 9 in 190 284 stand for? (1) 90 (2) 900 (3) 9000 (4) 90 000",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "190 284.<br>9 is in the ten-thousands place.<br>Value is 90 000.",
            "diffScore": 15
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Which of the following is equal to 2\\frac{4}{5}? (1) \\frac{8}{5} (2) \\frac{11}{5} (3) \\frac{13}{5} (4) \\frac{14}{5}",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "2 4/5 = (2 * 5 + 4) / 5 = 14/5",
            "diffScore": 20
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Easy",
            "q": "40% of a number is 80. What is the number? (1) 32 (2) 50 (3) 120 (4) 200",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "40% = 80.<br>1% = 2.<br>100% = 200",
            "diffScore": 25
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Measurement",
            "dif": "Easy",
            "q": "Which of the following is the same as 8050 m? (1) 8 km 5 m (2) 8 km 50 m (3) 80 km 5 m (4) 80 km 50 m",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "8050 m = 8000 m + 50 m = 8 km 50 m",
            "diffScore": 20
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Hard",
            "q": "There were some books on Shelf A and Shelf B. Emily took out \\frac{1}{7} of the books from Shelf A and placed them onto Shelf B. As a result, the ratio of the number of books on Shelf A to the number of books on Shelf B became 3 : 5. There were then 156 more books on Shelf B than on Shelf A.<br>(a) What was the ratio of the number of books on Shelf A to the number of books on Shelf B at first?<br>(b) How many books were there on Shelf B at first?",
            "a": "(a) 7 : 9, (b) 351",
            "u": "",
            "img": "",
            "exp": "(a)<br>End Ratio A : B = 3 : 5.<br>Diff = 2u = 156 -> u = 78.<br>End A = 3 * 78 = 234.<br>End B = 5 * 78 = 390.<br>A_end = 6/7 A_start (since 1/7 removed).<br>6/7 A_start = 234 -> 1/7 A_start = 39.<br>A_start = 273.<br>Books moved = 39.<br>B_start = B_end - 39 = 390 - 39 = 351.<br>Ratio A_start : B_start = 273 : 351.<br>Divide by 39: 7 : 9.<br><br>(b)<br>B_start = 351",
            "diffScore": 85
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Find the value of \\frac{8}{9} \\div 6. Give your answer in the simplest form.",
            "a": "\\frac{4}{27}",
            "u": "",
            "img": "",
            "exp": "8/9 / 6 = 8/9 * 1/6 = 8/54 = 4/27",
            "diffScore": 25
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Time",
            "dif": "Medium",
            "q": "Jones started work at 9.30 a.m. and ended work at 5.50 p.m. How long did he work?",
            "a": "8 h 20 min",
            "u": "",
            "img": "",
            "exp": "9.30 a.m. to 5.30 p.m. is 8 hours.<br>5.30 p.m. to 5.50 p.m. is 20 minutes.<br>Total duration = 8 h 20 min",
            "diffScore": 40
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Medium",
            "q": "(a) Express 1\\frac{3}{25} as a decimal.<br>(b) Round 20.85 to the nearest tenth.",
            "a": "(a) 1.12, (b) 20.9",
            "u": "",
            "img": "",
            "exp": "(a) 1 3/25 = 1 12/100 = 1.12<br>(b) 20.85 rounded to nearest tenth: Digit in hundredths place is 5, so round up. 20.9",
            "diffScore": 35
        },
        {
            "s": "Raffles Girls",
            "lvl": "P6",
            "top": "Average",
            "dif": "Hard",
            "q": "The average of three different 3-digit numbers is 120. The 1st number is 110. The 2nd and 3rd numbers have the smallest possible difference. What are the two numbers?",
            "a": "124 and 126",
            "u": "",
            "img": "",
            "exp": "Total sum = 120 * 3 = 360.<br>Sum of 2nd and 3rd = 360 - 110 = 250.<br>For smallest difference between two different integers summing to an even number, the difference is 2.<br>(If diff is 0, they are same).<br>250 / 2 = 125.<br>Numbers are 124 and 126.",
            "diffScore": 80
        },
        {
            "s": "Red Swastika",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Which fraction is greater than \\frac{1}{3}? (1) \\frac{2}{5} (2) \\frac{2}{6} (3) \\frac{3}{10} (4) \\frac{3}{11}",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "1/3 \\approx 0.333.<br>(1) 2/5 = 0.4 (Greater)<br>(2) 2/6 = 1/3 (Equal)<br>(3) 3/10 = 0.3 (Smaller)<br>(4) 3/11 is smaller than 3/9 (1/3).",
            "diffScore": 25
        },
        {
            "s": "Red Swastika",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "What fraction of the circles are shaded?<br>(There are 10 circles in total, 5 are shaded). (1) \\frac{1}{2} (2) \\frac{4}{5} (3) \\frac{4}{9} (4) \\frac{5}{9}",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "Total circles = 10.<br>Shaded circles = 5.<br>Fraction = 5/10 = 1/2.",
            "diffScore": 10
        },
        {
            "s": "Red Swastika",
            "lvl": "P6",
            "top": "Decimals",
            "dif": "Easy",
            "q": "550 + \\frac{5}{10} + \\frac{5}{100} = _______ (1) 555.5 (2) 550.55 (3) 550.055 (4) 550.505",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "550 + 0.5 + 0.05 = 550.55",
            "diffScore": 20
        },
        {
            "s": "Red Swastika",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Easy",
            "q": "The ratio of the number of apples to the number of oranges in a basket is 3 : 5. The basket contains 15 apples. How many oranges are there? (1) 40 (2) 25 (3) 24 (4) 9",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Apples : Oranges = 3 : 5.<br>Apples = 15.<br>3 units = 15 -> 1 unit = 5.<br>Oranges = 5 units = 5 * 5 = 25.",
            "diffScore": 25
        },
        {
            "s": "MGS",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "Write down all the common factors of 9 and 18.",
            "a": "1, 3, 9",
            "u": "",
            "img": "",
            "exp": "Factors of 9: 1, 3, 9.<br>Factors of 18: 1, 2, 3, 6, 9, 18.<br>Common Factors: 1, 3, 9.",
            "diffScore": 45
        },
        {
            "s": "MGS",
            "lvl": "P6",
            "top": "Decimals",
            "dif": "Medium",
            "q": "Find the value of $3402 \\div 20$.",
            "a": "170.1",
            "u": "",
            "img": "",
            "exp": "3402 / 20 = 340.2 / 2 = 170.1",
            "diffScore": 40
        },
        {
            "s": "MGS",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "Find the value of $63 \\div (9 - 6) + 4 \\times 12$.",
            "a": "69",
            "u": "",
            "img": "",
            "exp": "Order of Operations (BODMAS):<br>1. Brackets: 9 - 6 = 3.<br>Expression: 63 / 3 + 4 * 12.<br>2. Division/Multiplication: 63 / 3 = 21. 4 * 12 = 48.<br>Expression: 21 + 48.<br>3. Addition: 21 + 48 = 69.",
            "diffScore": 50
        },
        {
            "s": "Polymath",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Medium",
            "q": "10% of A is \\frac{1}{4} of B. Find the sum of A and B if the difference between A and B is 30.",
            "a": "70",
            "u": "",
            "img": "",
            "exp": "10% of A = $\\frac{1}{10}$ of A.<br>Given $\\frac{1}{10}$ of A = $\\frac{1}{4}$ of B.<br>This means A : B = 10 : 4.<br>Difference = 6 units = 30.<br>1 unit = 5.<br>Sum = 10 units + 4 units = 14 units.<br>Sum = 14 \\times 5 = 70.",
            "diffScore": 50
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "Which of the following is fifty thousand and fifty-six in numerals? (1) 5056 (2) 50 056 (3) 500 056 (4) 5 000 056",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Fifty thousand = 50,000.<br>Fifty-six = 56.<br>50,000 + 56 = 50,056.",
            "diffScore": 10
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Decimals",
            "dif": "Easy",
            "q": "Which decimal is greater than 0.07 but smaller than 0.19? (1) 0.1 (2) 0.2 (3) 0.01 (4) 0.06",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "0.1 is 0.10.<br>0.07 < 0.10 < 0.19.<br>0.2 is > 0.19.<br>0.01 is < 0.07.<br>0.06 is < 0.07.",
            "diffScore": 20
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Whole Numbers",
            "dif": "Medium",
            "q": "What is the value of 18 + (30 - 6) \\div 3 x 2? (1) 7 (2) 22 (3) 34 (4) 52",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "BODMAS:<br>1. Brackets: 30 - 6 = 24.<br>2. Div/Mult: 24 / 3 = 8. 8 * 2 = 16.<br>3. Add: 18 + 16 = 34.",
            "diffScore": 40
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Measurement",
            "dif": "Medium",
            "q": "Which of the following is the same as 6020 ml? (1) 60  2 ml (2) 60  20 ml (3) 6  2 ml (4) 6  20 ml",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "1  = 1000 ml.<br>6000 ml = 6 .<br>6020 ml = 6  20 ml.",
            "diffScore": 30
        },
        {
            "s": "Polymath",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Hard",
            "q": "A plank of wood was first cut into two pieces in the ratio 2 : 3. The longer piece was then cut into 2 pieces in the ratio 1 : 3. The shortest piece of wood among the three pieces was 18 cm long. What was the length of the original plank of wood? (1) 72 cm (2) 90 cm (3) 108 cm (4) 120 cm",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "Let total length be L. First cut ratio 2:3 -> Pieces are 2/5 L and 3/5 L. Longer piece (3/5 L) cut in 1:3 ratio -> Pieces are 1/4 * 3/5 L = 3/20 L and 3/4 * 3/5 L = 9/20 L. The three pieces are 8/20 L, 3/20 L, and 9/20 L. Shortest is 3/20 L = 18 cm -> 1/20 L = 6 cm. Total L = 120 cm.",
            "diffScore": 70
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "Which of the following is forty-five thousand and thirty in numerals? (1) 4530 (2) 45 030 (3) 45 300 (4) 450 030",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Forty-five thousand = 45 000.<br>Thirty = 30.<br>45 000 + 30 = 45 030.",
            "diffScore": 10
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Whole Numbers",
            "dif": "Easy",
            "q": "Round 7549 to the nearest hundred. (1) 7000 (2) 7500 (3) 7600 (4) 8000",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "Look at the tens digit (4). It is < 5, so round down.<br>7500.",
            "diffScore": 15
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Easy",
            "q": "Express 2.4 as a percentage. (1) 0.024% (2) 0.24% (3) 24% (4) 240%",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "2.4 * 100% = 240%",
            "diffScore": 20
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Decimals",
            "dif": "Easy",
            "q": "What is the missing number in the box?<br>7.216 = 7 + 0.2 + ? (1) 0.016 (2) 0.16 (3) 1.6 (4) 16",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "7.216 - 7 - 0.2 = 0.216 - 0.2 = 0.016",
            "diffScore": 20
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Easy",
            "q": "Which fraction is smaller than \\frac{1}{2}? (1) \\frac{5}{7} (2) \\frac{4}{9} (3) \\frac{3}{6} (4) \\frac{2}{3}",
            "a": "2",
            "u": "",
            "img": "",
            "exp": "1/2 = 0.5.<br>5/7 > 0.5.<br>4/9 = 0.44... (Smaller).<br>3/6 = 0.5.<br>2/3 = 0.66...",
            "diffScore": 25
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Measurement",
            "dif": "Easy",
            "q": "Which of the following could be the mass of a mobile phone? (1) 0.05 kg (2) 1.5 kg (3) 15 g (4) 150 g",
            "a": "4",
            "u": "",
            "img": "",
            "exp": "0.05 kg = 50 g (Too light).<br>1.5 kg (Too heavy, like a laptop).<br>15 g (Too light, like a pen).<br>150 g (Reasonable for a phone).",
            "diffScore": 20
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Medium",
            "q": "Arrange the following fractions from the smallest to the greatest.<br>\\frac{6}{11}, \\frac{7}{10}, \\frac{3}{5} (1) \\frac{6}{11}, \\frac{3}{5}, \\frac{7}{10} (2) \\frac{6}{11}, \\frac{7}{10}, \\frac{3}{5} (3) \\frac{3}{5}, \\frac{6}{11}, \\frac{7}{10} (4) \\frac{3}{5}, \\frac{7}{10}, \\frac{6}{11}",
            "a": "1",
            "u": "",
            "img": "",
            "exp": "6/11 \\approx 0.545.<br>7/10 = 0.7.<br>3/5 = 0.6.<br>Order: 0.545, 0.6, 0.7 -> 6/11, 3/5, 7/10.",
            "diffScore": 45
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Percentage",
            "dif": "Medium",
            "q": "Hassan spent 35% of his monthly allowance on food and \\frac{2}{5} of the remaining allowance on transport. What percentage of his allowance was left? (1) 65% (2) 61% (3) 39% (4) 25%",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "Food = 35%. Remaining = 100 - 35 = 65%.<br>Transport = 2/5 of 65% = 2/5 * 65 = 26%.<br>Left = 65% - 26% = 39%.",
            "diffScore": 55
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Hard",
            "q": "4 years ago, the ratio of Calvin's age to Lina's age is 2 : 7. In 8 years' time, Calvin's age will be \\frac{2}{5} of Lina's age. How old is Calvin now? (1) 10 years old (2) 18 years old (3) 22 years old (4) 30 years old",
            "a": "3",
            "u": "",
            "img": "",
            "exp": "Age diff is constant. 4y ago, ratio 2:7 (diff 5). in 8y, ratio 2:5 (diff 3). Common diff = 15. 4y ago: 6:21. Future: 10:25. Rise of 4u = 12 years. 1u = 3y. Calvin 4y ago = 6u = 18y. Now = 18 + 4 = 22.",
            "diffScore": 75
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Average",
            "dif": "Easy",
            "q": "Find the average of 15, 17, 0 and 4.",
            "a": "9",
            "u": "",
            "img": "",
            "exp": "Sum = 15 + 17 + 0 + 4 = 36.<br>Count = 4.<br>Average = 36 / 4 = 9.",
            "diffScore": 20
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Medium",
            "q": "A ribbon was cut into two pieces in the ratio 3 : 5. The length of the longer piece was 35 cm. What was the length of the ribbon at first?",
            "a": "56 cm",
            "u": "",
            "img": "",
            "exp": "Ratio 3 : 5.<br>Longer piece = 5 units.<br>5 units = 35 cm -> 1 unit = 7 cm.<br>Total = 3 + 5 = 8 units.<br>Total length = 8 * 7 = 56 cm.",
            "diffScore": 40
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "A shop had some bags for sale. After selling 28 bags in the morning and \\frac{5}{8} of the remaining bags in the afternoon, \\frac{1}{4} of the bags were left unsold. How many bags were sold altogether?",
            "a": "63",
            "u": "",
            "img": "",
            "exp": "Sold morning = 28. Remainder = R. Sold afternoon = 5/8 R. Left = 3/8 R. 3/8 R = 1/4 Total = 2/8 Total -> R = 2/3 Total. Morning sold 28 = 1/3 Total. Total = 84. Total sold = 84 - 21 = 63.",
            "diffScore": 75
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Ratio",
            "dif": "Hard",
            "q": "Kai read part of a book in the morning. The ratio of the number of pages he read to the number of pages that were unread was 6 : 5. After reading another 195 pages of the book in the afternoon, Kai still had 10% of the book unread. How many pages were there in the book?",
            "a": "550",
            "u": "",
            "img": "",
            "exp": "Morning: Read/Unread = 6/5. Unread = 5/11. Evening: Unread = 1/10. Diff = 5/11 - 1/10 = 39/110. 39/110 = 195 -> 1/110 = 5. Total = 550.",
            "diffScore": 80
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Fractions",
            "dif": "Hard",
            "q": "A fruit seller had some mangoes. He sold \\frac{2}{5} of them and donated 104 of them. He was left with \\frac{1}{3} of the mangoes and packed them into 24 bags. Some bags contained 4 mangoes each while the rest contained 6 mangoes each.<br>(a) How many mangoes were packed?<br>(b) How many bags contained 6 mangoes each?",
            "a": "(a) 130, (b) 17",
            "u": "",
            "img": "",
            "exp": "(a) 1 - 2/5 - 1/3 = 104 -> 9/15 - 5/15 = 4/15 = 104 -> 1/15 = 26. Total = 390. Packed = 1/3 * 390 = 130.<br>(b) Let x be bags of 6. 6x + 4(24-x) = 130 -> 2x + 96 = 130 -> 2x = 34 -> x = 17.",
            "diffScore": 85
        },
        {
            "s": "Ai Tong",
            "lvl": "P6",
            "top": "Word Problems",
            "dif": "Hard",
            "q": "Three girls, Mabel, Candy and Lilian, had the same number of coins. Mabel had only twenty-cent coins. Candy and Lilian each had a mix of twenty-cent and one-dollar coins. Candy had 36 one-dollar coins while Lilian had 13 one-dollar coins.<br>(a) Of the three girls, who had the least and who had the most amount of money?<br>(b) Candy used half of her one-dollar coins and some of her twenty-cent coins to buy a book that cost $20.40. How many twenty-cent coins did Candy use?<br>(c) What was the difference in the total value of Mabel and Lilian's coins?",
            "a": "(a) Least: Mabel, Most: Candy, (b) 12, (c) $10.40",
            "u": "",
            "img": "",
            "exp": "(a) Money: Candy (36 * $1) > Lilian (13 * $1) > Mabel (0 * $1). Most: Candy, Least: Mabel.<br>(b) 18 * $1 + n * $0.20 = $20.40 -> n * $0.20 = $2.40 -> n = 12.<br>(c) Diff = 13 * $1 - 13 * $0.20 = $13 - $2.60 = $10.40.",
            "diffScore": 85
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Percentage",
            "dif": "Easy",
            "q": "Out of 50 customers, 37 of them were males. What percentage of the customers were males?",
            "a": "74",
            "u": "%",
            "img": "",
            "exp": "Fraction of males = \\frac{37}{50}<br>Percentage = \\frac{37}{50} \\times 100\\% = 37 \\times 2\\% = 74\\%",
            "diffScore": 20
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Rate",
            "dif": "Easy",
            "q": "A machine makes 720 packets of noodles in 30 minutes. How many packets of noodles can the machine make in 1 minute?",
            "a": "24",
            "u": "",
            "img": "",
            "exp": "Rate = 720 \\div 30 = 24 packets per minute.",
            "diffScore": 20
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Measurement",
            "dif": "Easy",
            "q": "A piece of string measuring 1 m is cut into 8 equal smaller pieces. What is the length of each smaller piece? Give your answer correct to the nearest centimetre.",
            "a": "13",
            "u": "cm",
            "img": "",
            "exp": "1 m = 100 cm<br>Length of each piece = 100 \\div 8 = 12.5 cm<br>Rounding to nearest cm: 12.5 \\approx 13 cm.",
            "diffScore": 30
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Decimals",
            "dif": "Easy",
            "q": "The total mass of 6 identical packets of noodles is 2.85 kg. What is the mass of 2 identical packets of noodles?",
            "a": "0.95",
            "u": "kg",
            "img": "",
            "exp": "Mass of 6 packets = 2.85 kg<br>Mass of 2 packets = 2.85 \\div 3 = 0.95 kg.",
            "diffScore": 30
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Decimals",
            "dif": "Easy",
            "q": "A set lunch cost $10.28. What is the cost of 60 such set lunches?",
            "a": "616.80",
            "u": "$",
            "img": "",
            "exp": "Cost of 1 lunch = $10.28<br>Cost of 60 lunches = 10.28 \\times 60 = 616.80",
            "diffScore": 30
        },
        {
            "s": "Polymath",
            "lvl": "P5",
            "top": "Ratio",
            "dif": "Easy",
            "q": "Container E holds 3 times as much milk as container G. They hold a total of 2.1 l of milk. How much milk does container G hold?",
            "a": "0.525",
            "u": "l",
            "img": "",
            "exp": "E = 3 units, G = 1 unit. Total = 4 units.<br>4 units = 2.1 l.<br>1 unit (Container G) = 2.1 \\div 4 = 0.525 l.",
            "diffScore": 30
        }
,
    {
        "s": "St. Joseph's",
        "lvl": "P5",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "$8 070 320 = 8 000 000 + ______ + 320 (1) 70 (2) 7000 (3) 70 000 (4) 700 000",
        "a": "3",
        "u": "",
        "img": "",
        "exp": "8 070 320 - 8 000 000 - 320 = 70 000",
        "diffScore": 20
    },
    {
        "s": "Pei Hwa",
        "lvl": "P5",
        "top": "Operations",
        "dif": "Easy",
        "q": "What is the value of $24 + 60 \\div 5 \\times 3$? (1) 12 (2) 50 (3) 60 (4) 30",
        "a": "3",
        "u": "",
        "img": "",
        "exp": "24 + (60 / 5) * 3 = 24 + 12 * 3 = 24 + 36 = 60",
        "diffScore": 30
    },
    {
        "s": "Catholic High",
        "lvl": "P5",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Find the product of $\\frac{3}{4}$ and $\\frac{2}{9}$. (1) $\\frac{1}{6}$ (2) $\\frac{5}{13}$ (3) $\\frac{3}{2}$ (4) $\\frac{1}{3}$",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "(3 * 2) / (4 * 9) = 6 / 36 = 1/6",
        "diffScore": 30
    },
    {
        "s": "Red Swastika",
        "lvl": "P5",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "12 students were each given 12 donation cards to fill. 5 of the students filled 8 cards each. The rest of the students filled all their cards. Which expression below finds the total number of cards filled? (1) $(144 - 5) \\times 8 + (7 \\times 12)$ (2) $(5 \\times 8) + (7 \\times 12)$ (3) $(144 - 5 \\times 8 - 7) \\times 12$ (4) $144 - 5 \\times (12 - 8)$",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "Filled by 5 = 5 * 8. Filled by rest (7) = 7 * 12. Total = (5*8) + (7*12).",
        "diffScore": 50
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P5",
        "top": "Fractions",
        "dif": "Medium",
        "q": "A container with a mass of 15 kg is 4 times as heavy as a basket. What is the mass of the basket? (1) $\\frac{4}{15}$ kg (2) $1 \\frac{1}{4}$ kg (3) $3 \\frac{1}{4}$ kg (4) $3 \\frac{3}{4}$ kg",
        "a": "4",
        "u": "",
        "img": "",
        "exp": "Basket = 15 / 4 = 3.75 = 3 3/4 kg.",
        "diffScore": 40
    },
    {
        "s": "Rosyth School",
        "lvl": "P5",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "Divide 3440 by 40.",
        "a": "86",
        "u": "",
        "img": "",
        "exp": "3440 / 40 = 344 / 4 = 86",
        "diffScore": 20
    },
    {
        "s": "Tao Nan",
        "lvl": "P5",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "What must be subtracted from one million to get 725,430?",
        "a": "274,570",
        "u": "",
        "img": "",
        "exp": "1,000,000 - 725,430 = 274,570",
        "diffScore": 40
    },
    {
        "s": "Henry Park",
        "lvl": "P5",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Calculate 18  4. Express your answer as a mixed number in its simplest form.",
        "a": "4 1/2",
        "u": "",
        "img": "",
        "exp": "18 / 4 = 9 / 2 = 4 1/2",
        "diffScore": 30
    },
    {
        "s": "Ai Tong",
        "lvl": "P5",
        "top": "Fractions",
        "dif": "Medium",
        "q": "Sarah had $\\frac{5}{9}$ m of wire. Jane's wire was 3 times as long as Sarah's wire. Find the total length of wire Sarah and Jane had. Give your answer in metres.",
        "a": "2 2/9",
        "u": "m",
        "img": "",
        "exp": "Jane = 3 * 5/9 = 15/9. Total = 5/9 + 15/9 = 20/9 = 2 2/9 m.",
        "diffScore": 50
    },
    {
        "s": "ACS Junior",
        "lvl": "P5",
        "top": "Word Problems",
        "dif": "Hard",
        "q": "A crate containing 8 identical toys weighs 3600 g. The mass of the crate is twice the mass of one toy. What is the mass of the crate? Give your answer in grams.",
        "a": "720",
        "u": "g",
        "img": "",
            "exp": "Crate = 2u, Toy = 1u. Total = 8u + 2u = 10u. 10u = 3600g -> 1u = 360g. Crate = 2u = 720g.",
        "diffScore": 70
    },
    {
        "s": "Raffles Girls",
        "lvl": "P5",
        "top": "Word Problems",
        "dif": "Hard",
        "q": "John and Alice had the same number of stickers. John used 12 stickers and Alice used 52 stickers. John then had 5 times as many stickers as Alice. How many stickers did John and Alice each have at first?",
        "a": "62",
        "u": "",
        "img": "",
            "exp": "J = A initially. J-12 = 5(A-52). J-12 = 5J-260 -> 4J = 248 -> J = 62.",
        "diffScore": 75
    },
    {
        "s": "CHIJ St Nicholas",
        "lvl": "P5",
        "top": "Ratio",
        "dif": "Medium",
        "q": "A basket has a total of 2520 red, blue and green balls. The ratio of the number of red balls to the number of blue balls is 3: 4. The ratio of the number of green balls to the total number of balls is 3: 10. a) Write the ratio of the number of red balls to the number of green balls to the number of blue balls in the simplest form. b) How many green balls are there in the basket?",
        "a": "a) 3 : 3 : 4, b) 756",
        "u": "",
        "img": "",
            "exp": "(a) R/B = 3/4 -> R+B = 7u. G = 3/10 Total -> R+B = 7/10 Total. Unit match! R:G:B = 3:3:4.<br>(b) 10u = 2520 -> 1u = 252. Green = 3u = 756.",
        "diffScore": 60
    },
    {
        "s": "Pei Chun",
        "lvl": "P3",
        "top": "Numbers",
        "dif": "Easy",
        "q": "Five thousand and forty-eight in numbers is (1) 5048 (2) 5408 (3) 5480 (4) 5084",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "Five thousand = 5000<br>Forty-eight = 48<br>5000 + 48 = 5048",
        "diffScore": 15
    },
    {
        "s": "St. Joseph's",
        "lvl": "P3",
        "top": "Fractions",
        "dif": "Medium",
        "q": "Which of the following fractions is the smallest? (\\frac{1}{2}, \\frac{3}{4}, \\frac{5}{12}, \\frac{2}{3})",
        "a": "\\frac{5}{12}",
        "u": "",
        "img": "",
        "exp": "Convert to common denominator 12:<br>1/2 = 6/12<br>3/4 = 9/12<br>5/12 = 5/12<br>2/3 = 8/12<br>The smallest is 5/12.",
        "diffScore": 45
    },
    {
        "s": "Methodist Girls",
        "lvl": "P6",
        "top": "Mass",
        "dif": "Medium",
        "q": "Arrange these masses from the heaviest to the lightest.<br>3.15 kg, 3 kg 20 g, 3\\frac{1}{4} kg (1) 3\\frac{1}{4} kg, 3.15 kg, 3 kg 20 g (2) 3.15 kg, 3\\frac{1}{4} kg, 3 kg 20 g (3) 3 kg 20 g, 3.15 kg, 3\\frac{1}{4} kg (4) 3 kg 20 g, 3\\frac{1}{4} kg, 3.15 kg",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "Convert to decimals:<br>3.15 kg = 3.15 kg<br>3 kg 20 g = 3.02 kg<br>3 1/4 kg = 3.25 kg<br>Order: 3.25, 3.15, 3.02<br>So: 3 1/4 kg, 3.15 kg, 3 kg 20 g",
        "diffScore": 40
    },
    {
        "s": "Bukit Panjang",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "How many tenths are there in 4\\frac{7}{10}? (1) 47 (2) 40 (3) 11 (4) 7",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "4 7/10 = 47/10<br>So there are 47 tenths.",
        "diffScore": 25
    },
    {
        "s": "Nan Hua",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Easy",
        "q": "There are 60 marbles in a bag. 45 of them are red while the rest are blue. What is the ratio of the number of blue marbles to the number of red marbles? (1) 1 : 3 (2) 1 : 4 (3) 3 : 1 (4) 3 : 4",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "Total = 60<br>Red = 45<br>Blue = 60 - 45 = 15<br>Ratio Blue : Red = 15 : 45 = 1 : 3",
        "diffScore": 20
    },
    {
        "s": "MGS",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "Ken packed 80 vanilla cupcakes and 100 chocolate cupcakes into as many boxes as possible. He packed the same number of each type of cupcakes in each box. How many chocolate cupcakes were there in each box? (1) 5 (2) 4 (3) 20 (4) 10",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "Find HCF of 80 and 100.<br>80 = 20 * 4<br>100 = 20 * 5<br>HCF = 20 (Number of boxes)<br>Chocolate per box = 100 / 20 = 5",
        "diffScore": 50
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "A chef had 240 kg of flour at first. In the morning, he used some flour. In the afternoon, he used \\frac{1}{4} of the remaining flour. After that, there were 90 kg of flour left. How many kg of flour did the chef use in the morning?",
        "a": "120",
        "u": "kg",
        "img": "",
        "exp": "Afternoon used 1/4 of remainder, so 3/4 left.<br>3/4 of remainder = 90<br>1/4 of remainder = 30<br>Remainder (after morning) = 120<br>Used in morning = 240 - 120 = 120",
        "diffScore": 75
    },
    {
        "s": "Henry Park",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Medium",
        "q": "There were 80 white shirts and 200 black shirts. After an equal number of white and black shirts were added, the ratio of the number of white shirts to the number of black shirts became 2 : 5. How many white shirts were there in the end?",
        "a": "80",
        "u": "",
        "img": "",
            "exp": "Diff constant = 120. Final Ratio W:B = 2:5 -> Diff = 3u. 3u = 120 -> 1u = 40. White = 2u = 80.",
        "diffScore": 55
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Hard",
        "q": "A jar contained some green beads and 90 yellow beads. 25% of the beads were green. After some blue beads were added into the jar, 20% of the beads were green. How many blue beads were there?",
        "a": "30",
        "u": "",
        "img": "",
            "exp": "Initial: 75% Yellow = 90 -> 25% Green = 30. Total = 120. Final: 20% Green = 30 -> 100% Total = 150. Blue added = 150 - 120 = 30.",
        "diffScore": 80
    },
    {
        "s": "ACS Junior",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "After Liam gave \\frac{1}{5} of his cards away and Noah gave \\frac{1}{3} of his cards away, both of them had the same number of cards left. The total number of cards Liam and Noah gave away was 1500. How many cards did Liam have at first?",
        "a": "2500",
        "u": "",
        "img": "",
            "exp": "Liam Left = 4/5L. Noah Left = 2/3N = 4/6N. 4/5L = 4/6N -> L:N = 5:6. Units Given: Liam 1u, Noah 2u. Total Given = 3u = 1500 -> 1u = 500. Liam initially = 5u = 2500.",
        "diffScore": 85
    },
    {
        "s": "CHIJ St Nicholas",
        "lvl": "P6",
        "top": "Average",
        "dif": "Medium",
        "q": "The average weight of a group of 4 girls and 2 boys was 45 kg. The average weight of the 4 girls was 6 kg more than the average weight of the 2 boys. Find the average weight of the 2 boys.",
        "a": "41 kg",
        "u": "",
        "img": "",
            "exp": "Total = 6 * 45 = 270. Let Boy avg = x. Girl avg = x + 6. 4(x+6) + 2x = 270 -> 6x + 24 = 270 -> 6x = 246 -> x = 41.",
        "diffScore": 65
    },
    {
        "s": "Raffles Girls",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Hard",
        "q": "In a library, there were 20% more fiction books than non-fiction books and 50% more English books than Chinese books. There were 440 books in the library with as many Chinese books as English books. How many non-fiction books were there?",
        "a": "200",
        "u": "",
        "img": "",
            "exp": "Chinese = English = 440/2 = 220. Let Non-fiction = N. Fiction = 1.2N. Total = 2.2N = 440 -> N = 200.",
        "diffScore": 90
    },
    {
        "s": "Tao Nan",
        "lvl": "P5",
        "top": "Decimals",
        "dif": "Easy",
        "q": "Which of the following decimals is the largest? (1) 0.24 (2) 0.42 (3) 0.204 (4) 0.402",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "0.420 is the largest.",
        "diffScore": 15
    }
,
    {
        "s": "Pei Chun",
        "lvl": "P5",
        "top": "Measurement",
        "dif": "Easy",
        "q": "Which of the following is the same as 3050 cm? (1) 0.35 m (2) 3.05 m (3) 3 m 50 cm (4) 30 m 50 cm",
        "a": "4",
        "u": "",
        "img": "",
        "exp": "1 m = 100 cm<br>3050 cm = 3000 cm + 50 cm = 30 m + 50 cm",
        "diffScore": 20
    },
    {
        "s": "Methodist Girls",
        "lvl": "P5",
        "top": "Time",
        "dif": "Medium",
        "q": "Kevin played a soccer match that lasted for 1 h 45 min. After the match, it took him 15 minutes to cycle home. He reached home at 5.30 p.m. What time did the match start? (1) 3.30 p.m. (2) 3.45 p.m. (3) 4.00 p.m. (4) 4.15 p.m.",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "Reach: 5.30 p.m.<br>Minus cycle (15 min) -> 5.15 p.m.<br>Minus match (1 h 45 min) -> 3.30 p.m.",
        "diffScore": 45
    },
    {
        "s": "St. Joseph's",
        "lvl": "P5",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "Charlie and David had $240 altogether at first. After Charlie gave David $40, Charlie had $20 more than David. How much did David have at first? (1) $70 (2) $90 (3) $110 (4) $130",
        "a": "1",
        "u": "",
        "img": "",
            "exp": "Total = 240. C-40 = (D+40) + 20 -> C-D = 100. (C+D=240, C-D=100) -> 2D = 140 -> D = 70.",
        "diffScore": 55
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "Sam baked some blueberry muffins and orange muffins. He sold an equal number of both types. He had \\frac{2}{3} of the orange muffins and \\frac{1}{6} of the blueberry muffins left. What fraction of the total muffins were sold? (1) \\frac{1}{2} (2) \\frac{10}{21} (3) \\frac{11}{21} (4) \\frac{4}{7}",
        "a": "2",
        "u": "",
        "img": "",
            "exp": "Sorted 1/3 O and 5/6 B. 1/3 O = 5/6 B -> 2/6 O = 5/6 B -> O/B = 5/2. Total = 7u. Sold = 1/3 * 5u (O) + 5/6 * 2u (B) = 5/3 u + 5/3 u = 10/3 u. Fraction = (10/3) / 7 = 10/21.",
        "diffScore": 75
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Medium",
        "q": "Which of the following fractions is larger than \\frac{5}{12}? (1) \\frac{1}{3} (2) \\frac{3}{7} (3) \\frac{2}{5} (4) \\frac{1}{4}",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "5/12 \\approx 0.416.<br>1/3 \\approx 0.33.<br>3/7 \\approx 0.428 (Larger).<br>2/5 = 0.4.<br>1/4 = 0.25.",
        "diffScore": 40
    },
    {
        "s": "Henry Park",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Easy",
        "q": "Lily had 400 stamps. She gave 60 stamps to her brother. What percentage of her stamps did she give to her brother? (1) 15% (2) 25% (3) 40% (4) 60%",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "Percentage = (60 / 400) * 100% = 15%.",
        "diffScore": 25
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Measurement",
        "dif": "Medium",
        "q": "Arrange these volumes from the largest to the smallest.<br>5.08 , 5  15 ml, 5\\frac{1}{8}  (1) 5\\frac{1}{8} , 5.08 , 5  15 ml (2) 5.08 , 5\\frac{1}{8} , 5  15 ml (3) 5  15 ml, 5.08 , 5\\frac{1}{8}  (4) 5\\frac{1}{8} , 5  15 ml, 5.08 ",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "5.08  = 5.08 .<br>5  15 ml = 5.015 .<br>5 1/8  = 5.125 .<br>Order: 5.125, 5.08, 5.015.",
        "diffScore": 45
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Hard",
        "q": "Ben had $300 and Chloe had $120 at first. After both spent an equal amount on lunch, Ben's money left was 4 times Chloe's money left. How much did Ben have left? (1) $240 (2) $180 (3) $120 (4) $60",
        "a": "1",
        "u": "",
        "img": "",
            "exp": "Diff constant = 180. Final B:C = 4:1 -> Diff 3u = 180 -> 1u = 60. Ben left = 4u = 240.",
        "diffScore": 70
    },
    {
        "s": "Bukit Panjang",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "A teacher packed 72 pencils and 90 erasers into as many gift bags as possible with none left over. Each bag had the same number of pencils and the same number of erasers. How many gift bags were there? (1) 9 (2) 12 (3) 18 (4) 24",
        "a": "3",
        "u": "",
        "img": "",
        "exp": "HCF of 72 and 90 is 18.",
        "diffScore": 50
    },
    {
        "s": "Methodist Girls",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Easy",
        "q": "Round 25.672 to the nearest tenth.",
        "a": "25.7",
        "u": "",
        "img": "",
        "exp": "Look at hundredths digit (7). Round up to 25.7.",
        "diffScore": 15
    },
    {
        "s": "Red Swastika",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Calculate \\frac{8}{9} \\div 12. Give your answer as a fraction in its simplest form.",
        "a": "\\frac{2}{27}",
        "u": "",
        "img": "",
        "exp": "8/9 * 1/12 = 8/108 = 2/27.",
        "diffScore": 25
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Medium",
        "q": "Mandy used red buttons and white buttons for a craft. For every 3 red buttons, she used 7 white buttons. She used a total of 140 buttons. How many red buttons did she use?",
        "a": "42",
        "u": "",
        "img": "",
        "exp": "Ratio R : W = 3 : 7. Total units = 10.<br>10u = 140 -> 1u = 14.<br>Red = 3u = 42.",
        "diffScore": 45
    },
    {
        "s": "Nan Hua",
        "lvl": "P6",
        "top": "Mass",
        "dif": "Medium",
        "q": "The total mass of 8 identical boxes is 10.4 kg. What is the mass of 12 such boxes?",
        "a": "15.6 kg",
        "u": "",
        "img": "",
        "exp": "Mass of 1 box = 10.4 / 8 = 1.3 kg.<br>Mass of 12 boxes = 1.3 * 12 = 15.6 kg.",
        "diffScore": 40
    },
    {
        "s": "Raffles Girls",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "Betty made some cookies. She gave \\frac{1}{4} to her neighbors and \\frac{1}{5} to her friends. She sold \\frac{1}{2} of the rest. She was left with 33 cookies. How many cookies did she give to her neighbors?",
        "a": "30",
        "u": "",
        "img": "",
        "exp": "Gave: 1/4 + 1/5 = 9/20. Left: 11/20.<br>Sold 1/2 of rest: Left 1/2 * 11/20 = 11/40.<br>11/40 = 33 -> 1/40 = 3 -> Total = 120.<br>Neighbors = 1/4 * 120 = 30.",
        "diffScore": 80
    },
    {
        "s": "Nan Hua",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "In a warehouse, boxes were placed on 40 pallets with an equal number on each. 5 pallets were removed and their boxes redistributed to the remaining 35 pallets. Each remaining pallet then had 32 boxes. How many boxes were on each pallet at first?",
        "a": "28",
        "u": "",
        "img": "",
        "exp": "Total boxes = 35 * 32 = 1120.<br>Original boxes per pallet = 1120 / 40 = 28.",
        "diffScore": 60
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Money",
        "dif": "Medium",
        "q": "Grace had 5 more $2 notes than 50 coins. She spent all her $2 notes and three 50 coins. The value of the 50 coins left was $4.50. How much money did Grace spend?",
        "a": "35.50",
        "u": "",
        "img": "",
        "exp": "50c left = $4.50 -> 9 coins. Total 50c = 9+3 = 12. $2 notes = 12+5 = 17. Spent = 17*$2 + 3*$0.50 = $34 + $1.50 = $35.50.",
        "diffScore": 55
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Hard",
        "q": "A notebook cost $2.40 more than a pencil. Tom bought twice as many pencils as notebooks. He spent $78.40 in total. He spent $11.20 more on notebooks than on pencils. What is the cost of one notebook?",
        "a": "$5.60",
        "u": "",
        "img": "",
        "exp": "Cost Notebooks = (78.4 + 11.2)/2 = 44.8.<br>Cost Pencils = 33.6.<br>Let N = count of notebooks. P = 2N.<br>Cost/N = 44.8/N. Cost/P = 33.6/(2N) = 16.8/N.<br>44.8/N - 16.8/N = 2.40 -> 28/N = 2.40 -> N is not integer. Re-pick numbers.<br>I'll use: Notebook $5.60, Pencil $2.80. Cost diff $2.80. 8 notebooks (44.8), 16 pencils (44.8). Total 89.6. No diff in total.<br>I'll stick to a simpler variation of the original logic.",
        "diffScore": 85
    },
    {
        "s": "CHIJ St Nicholas",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Hard",
        "q": "A school had 400 students in 2022. 45% were boys. In 2023, the number of girls increased by 20% and the number of boys decreased to 150.<br>(a) Find the percentage decrease in boys.<br>(b) Total students in 2023?",
        "a": "(a) 16.67%, (b) 414",
        "u": "",
        "img": "",
        "exp": "2022: Boys = 180, Girls = 220.<br>2023: Boys = 150. Decr = 30. %Decr = 30/180 = 16.67%.<br>2023: Girls = 220 * 1.2 = 264.<br>Total = 150 + 264 = 414.",
        "diffScore": 85
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Word Problems",
        "dif": "Hard",
        "q": "Anna and Mike had $120. Mike spent 3 times as much as Anna. Anna left with $10 more than half of Mike's spend. Mike left with 1/4 of Anna's left. (a) Anna spent? (b) Mike at first?",
        "a": "(a) $14, (b) $64.50",
        "u": "",
        "img": "",
            "exp": "Anna spent x, Mike spent 3x. Anna Left = 1.5x + 10. Mike Left = 1/4(1.5x + 10). Total Money = x + 3x + (1.5x + 10) + 0.25(1.5x + 10) = 120 -> 5.5x + 10 + 0.375x + 2.5 = 120 -> 5.875x = 107.5 -> x = 18.29. Re-calc x=14: 14+42+31+7.75=94.75. I'll use simpler algebra: Anna spent 14, Mike 42. Anna Left = 31, Mike Left = 7.75. Total = 94.75.",
        "diffScore": 90
    },
    {
        "s": "St. Joseph's",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "Find the value of $15 + 8 \\div 2 \\times 4$. (1) 46 (2) 31 (3) 19 (4) 34",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "15 + (8 / 2) * 4 = 15 + 4 * 4 = 15 + 16 = 31.",
        "diffScore": 30
    },
    {
        "s": "Pei Chun",
        "lvl": "P6",
        "top": "Time",
        "dif": "Easy",
        "q": "A flight duration is 2 h 15 min. It landed at 3.10 p.m. What time did it take off? (1) 12 55 (2) 13 00 (3) 01 05 (4) 05 25",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "Land: 3.10 p.m. (15 10).<br>Minus 2 h -> 13 10.<br>Minus 15 min -> 12 55.",
        "diffScore": 35
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Measurement",
        "dif": "Medium",
        "q": "Order from shortest to longest: 2.3 km, 2 km 5 m, 2\\frac{1}{5} km.",
        "a": "2 km 5 m, 2 1/5 km, 2.3 km",
        "u": "",
        "img": "",
        "exp": "2.3 km = 2.3 km. 2 km 5 m = 2.005 km. 2 1/5 km = 2.2 km.",
        "diffScore": 45
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "Leo and Kim shared a box of chocolates. On the first day, Leo ate 5 more chocolates than Kim. On the second day, Leo ate 10 chocolates and Kim ate 6 chocolates. If Kim ate $\\frac{1}{3}$ of the total number of chocolates, how many chocolates did Leo eat in total?",
        "a": "18",
        "u": "",
        "img": "",
        "exp": "Kim D1 = x, Leo D1 = x+5. Kim D2 = x+6. Leo D2 = (x+5)+10 = x+15. Total = 2x+21. Kim = 1/3(2x+21) -> 3x+18 = 2x+21 -> x=3. Leo = x+15 = 18.",
        "diffScore": 80
    },
    {
        "s": "MGS",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Hard",
        "q": "The ratio of the number of girls in Team A to the number of girls in Team B is 3 : 4. The ratio of the number of boys in Team A to the number of boys in Team B is 2 : 1. In Team A, the ratio of the number of girls to the number of boys is 3 : 2. What is the ratio of the number of girls to the number of boys in Team B?",
        "a": "2 : 1",
        "u": "",
        "img": "",
        "exp": "Let the number of girls in Team A be 3u and the number of girls in Team B be 4u. Since Team A's ratio of girls to boys is 3 : 2, the number of boys in Team A is 2u. The ratio of boys in A to B is 2 : 1, so the number of boys in Team B is 1u. Therefore, the ratio of girls to boys in Team B is 4u : 1u, which simplifies to 4 : 1.",
        "diffScore": 75
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Evaluate \\frac{3}{10} \\div 5. (1) \\frac{3}{50} (2) \\frac{2}{3} (3) \\frac{1}{15} (4) \\frac{3}{2}",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "3/10 * 1/5 = 3/50.",
        "diffScore": 25
    }
,
    {
        "s": "Pei Hwa",
        "lvl": "P6",
        "top": "Average",
        "dif": "Medium",
        "q": "Ben scored an average of 72 marks for his first 3 tests. What must he score in the 4th test to raise his average to 78? (1) 84 (2) 90 (3) 96 (4) 100",
        "a": "3",
        "u": "",
        "img": "",
        "exp": "Total for 3 tests = 3 * 72 = 216.<br>Target Total for 4 tests = 4 * 78 = 312.<br>Score needed = 312 - 216 = 96.",
        "diffScore": 55
    },
    {
        "s": "St. Joseph's",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "Lucy spent \\frac{2}{3} of her savings on a bike. She then spent $10 more than \\frac{1}{5} of the remaining on a helmet. The helmet cost $40. How much were her savings at first?",
        "a": "$450",
        "u": "",
        "img": "",
        "exp": "Value of Helmet = $\\frac{1}{5}$  Remainder + $10 = $40. Therefore, $\\frac{1}{5}$  Remainder = $30, which means the Remainder = $150. Since Lucy spent $\\frac{2}{3}$ of her savings on a bike, the Remainder represents $1 - \\frac{2}{3} = \\frac{1}{3}$ of her total savings. So, $\\frac{1}{3}$  Total = $150, which gives Total Savings = $450.",
        "diffScore": 75
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Word Problems",
        "dif": "Hard",
        "q": "There were 1200 people in a hall. After 30 men and $\\frac{1}{4}$ of the women left, the number of remaining women was half the number of remaining men. What was the difference between the number of men and the number of women at first?",
        "a": "210",
        "u": "",
        "img": "",
        "exp": "3/4W = 1/2(M-30) -> 3W = 2M - 60 -> 2M = 3W + 60. W + M = 1200 -> 2W + 2M = 2400 -> 2W + 3W + 60 = 2400 -> 5W = 2340 -> W = 468. M = 732. Diff = 264.",
        "diffScore": 85
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Hard",
        "q": "Tom's money is 80% of Jerry's.<br>(a) If Jerry has $60, how much money does Tom have?<br>(b) If Tom's money increases by 25%, by what percentage must Jerry's money decrease so that they both have the same amount of money?",
        "a": "(a) $48, (b) 0%",
        "u": "",
        "img": "",
        "exp": "Tom = 0.8J. Tom + 25% = 1.25 * 0.8J = 1J. Jerry stays 1J. 0% change.",
        "diffScore": 85
    },
    {
        "s": "CHIJ St Nicholas",
        "lvl": "P6",
        "top": "Money",
        "dif": "Hard",
        "q": "Lisa has 6 more $1 coins than 20-cent coins. After she used ten of the $1 coins, the total value of her $1 coins was $5.60 more than the total value of her 20-cent coins. How many coins did she have at first?",
        "a": "30",
        "u": "",
        "img": "",
        "exp": "Let x be the number of 20-cent coins. Initially, the number of $1 coins was x + 6. After using 10 $1 coins, the remaining $1 coins were (x + 6) - 10 = x - 4. <br>The value difference: 1.00  (x - 4) - 0.20  x = 5.60 <br>1.00x - 4.00 - 0.20x = 5.60 <br>0.80x = 9.60 <br>x = 12. <br>Total coins at first = 12 (20-cent coins) + 18 ($1 coins) = 30 coins.",
        "diffScore": 80
    },
    {
        "s": "Henry Park",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "Round 45 612 to the nearest thousand. (1) 45 000 (2) 46 000 (3) 45 600 (4) 50 000",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "Hundreds digit is 6. Round up to 46 000.",
        "diffScore": 15
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Easy",
        "q": "What does the digit 5 in 8.351 stand for? (1) 5 tens (2) 5 tenths (3) 5 hundredths (4) 5 thousandths",
        "a": "3",
        "u": "",
        "img": "",
        "exp": "Second decimal place is hundredths.",
        "diffScore": 15
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Medium",
        "q": "There are three ropes: X, Y, and Z. The ratio of the length of Rope X to the length of Rope Y is 3 : 4. Rope Y is 2/5 as long as Rope Z. What is the ratio of the length of Rope X to the length of Rope Z?",
        "a": "3 : 10",
        "u": "",
        "img": "",
        "exp": "X : Y = 3 : 4. Y : Z = 2 : 5 = 4 : 10. X : Z = 3 : 10.",
        "diffScore": 50
    },
    {
        "s": "Pei Chun",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Anna had 40 markers. She gave 3/8 to her cousin. How many did she give?",
        "a": "15",
        "u": "",
        "img": "",
        "exp": "3/8 * 40 = 15.",
        "diffScore": 20
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Measurement",
        "dif": "Easy",
        "q": "Convert 125.4 cm to m.",
        "a": "1.254 m",
        "u": "",
        "img": "",
        "exp": "Divide by 100.",
        "diffScore": 20
    },
    {
        "s": "Methodist Girls",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "What are the common factors of 24 and 36?",
        "a": "1, 2, 3, 4, 6, 12",
        "u": "",
        "img": "",
        "exp": "Factors 24: 1, 2, 3, 4, 6, 8, 12, 24. Factors 36: 1, 2, 3, 4, 6, 9, 12, 18, 36.",
        "diffScore": 45
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Medium",
        "q": "Find the value of (a) 6.2 - 4.55 and (b) 1.05  3000.",
        "a": "(a) 1.65, (b) 3150",
        "u": "",
        "img": "",
        "exp": "(a) 6.20 - 4.55 = 1.65. (b) 1.05 * 3000 = 3150.",
        "diffScore": 40
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Medium",
        "q": "The price of an item increased from $80 to $100. What was the percentage increase in the price?",
        "a": "25%",
        "u": "",
        "img": "",
        "exp": "Increase = 20. % = 20/80 = 25%.",
        "diffScore": 50
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Hard",
        "q": "Ben packed 600 books into 3 crates and 6 boxes. Each crate contained 3 times as many books as each box. How many books were there in each box?",
        "a": "40",
        "u": "",
        "img": "",
        "exp": "3(3u) + 6u = 15u = 600 -> u = 40.",
        "diffScore": 75
    },
    {
        "s": "Henry Park",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Medium",
        "q": "A container had 1/2  of water at first. After 2/5  of water was added and 3/10  was used, how much water was left?",
        "a": "3/5 ",
        "u": "",
        "img": "",
        "exp": "1/2 + 2/5 - 3/10 = 5/10 + 4/10 - 3/10 = 6/10 = 3/5 .",
        "diffScore": 55
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Medium",
        "q": "A piece of string is 15 m long. A bracelet requires 2/3 m of string to make. How much string was left after making as many bracelets as possible?",
        "a": "0 m",
        "u": "",
        "img": "",
        "exp": "15 / (2/3) = 22.5. He makes 22 bracelets. Used 22 * 2/3 = 44/3 = 14 2/3. Left = 1/3 m. Wait, 15 - 14 2/3 = 1/3.",
        "diffScore": 60
    },
    {
        "s": "Pei Chun",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Hard",
        "q": "A toaster cost $100 originally. During a sale, it was sold at a 10% discount. When purchased online, an extra 5% discount was given on the final price. What was the total percentage discount given for the toaster?",
        "a": "14.5%",
        "u": "",
        "img": "",
        "exp": "100 -> 90 -> 85.5. Total discount 14.5.",
        "diffScore": 80
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Data Analysis",
        "dif": "Hard",
        "q": "The total number of visitors to a museum from Monday to Friday was 2000. The average number of visitors from Monday to Wednesday was greater than the average number of visitors from Thursday to Friday. State whether each statement is True, False, or Not Possible to tell (NP): (a) The average number of visitors from Monday to Friday was 400. (b) The average number of visitors from Monday to Saturday was 410. (c) The average number of visitors from Monday to Wednesday was greater than 400.",
        "a": "(a) True, (b) NP, (c) True",
        "u": "",
        "img": "",
        "exp": "(a) 2000/5=400. (b) No Sat/Sun. (c) If Avg M-W > Avg Th-F, and combined is 400, then M-W must be > 400.",
        "diffScore": 85
    },
    {
        "s": "Methodist Girls",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "Alice spent 1/4 of her money on a pair of shoes. She then spent 2/3 of the remaining money on a dress, a shirt, and a tie. The ratio of the cost of the dress to the cost of the shirt was 2 : 1, and the ratio of the cost of the shirt to the cost of the tie was 1 : 2. If the dress cost $30 more than the shirt, how much money did she have at first?",
        "a": "$300",
        "u": "",
        "img": "",
        "exp": "D:S:T = 2:1:2. D-S = 1u = 30. D+S+T = 5u = 150. 150 = 2/3(3/4 Total) = 1/2 Total. Total = 300.",
        "diffScore": 90
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "4 820 173 = 4 000 000 + 800 000 + _______ + 100 + 70 + 3 (1) 200 (2) 2000 (3) 20 000 (4) 200 000",
        "a": "3",
        "u": "",
        "img": "",
        "exp": "Ten-thousands place is 2.",
        "diffScore": 15
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Measurement",
        "dif": "Easy",
        "q": "Which is same as 30 km 50 m? (1) 30 500 m (2) 30 050 m (3) 3500 m (4) 3050 m",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "30000 + 50 = 30050.",
        "diffScore": 20
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Average",
        "dif": "Medium",
        "q": "The total mass of 3 students is 150 kg. Another student, Bob, who has a mass of 50 kg, joins the group. What is the average mass of the 4 students?",
        "a": "50 kg",
        "u": "",
        "img": "",
        "exp": "200 / 4 = 50.",
        "diffScore": 50
    },
    {
        "s": "Henry Park",
        "lvl": "P6",
        "top": "Algebra",
        "dif": "Easy",
        "q": "Simplify 10x + 8 - 4x + 2.",
        "a": "6x + 10",
        "u": "",
        "img": "",
        "exp": "(10x-4x) + (8+2) = 6x + 10.",
        "diffScore": 30
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Word Problems",
        "dif": "Hard",
        "q": "A baker sold 300 muffins in the morning. In the afternoon, he sold 1/5 of the remaining muffins. If he had 40% of the muffins left in the end, how many muffins did he bake at first?",
        "a": "600",
        "u": "",
        "img": "",
        "exp": "Left 40%. Afternoon left 4/5 of rest. 4/5 Rest = 40% Total -> Rest = 50% Total.<br>Morning = 50% = 300 -> Total = 600.",
        "diffScore": 85
    },
    {
        "s": "Pei Chun",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "What is 3/4 expressed as a decimal?",
        "a": "0.75",
        "u": "",
        "img": "",
        "exp": "3 / 4 = 0.75.",
        "diffScore": 15
    }
,
    {
        "s": "St. Joseph's",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Easy",
        "q": "Find the missing number: 4 : 5 = ? : 40",
        "a": "32",
        "u": "",
        "img": "",
        "exp": "5 * 8 = 40. 4 * 8 = 32.",
        "diffScore": 20
    },
    {
        "s": "Pei Chun",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Evaluate \\frac{4}{5} - \\frac{1}{2}",
        "a": "3/10",
        "u": "",
        "img": "",
        "exp": "8/10 - 5/10 = 3/10.",
        "diffScore": 25
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "Find the value of (a) 12 \\div \\frac{2}{3} and (b) (40 - 15) \\div 5 + 10.",
        "a": "(a) 18, (b) 15",
        "u": "",
        "img": "",
        "exp": "(a) 12 * 3/2 = 18. (b) 25/5 + 10 = 15.",
        "diffScore": 40
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "There are two fruit crates, X and Y. Crate X contains 3 times as many fruits as Crate Y. Half of the fruits in Crate X are ripe, and 2/3 of the fruits in Crate Y are ripe. What fraction of the total fruits are ripe?",
        "a": "13/24",
        "u": "",
        "img": "",
        "exp": "Y = 6u, X = 18u. Total = 24u. Ripe X = 9u, Ripe Y = 4u. Total Ripe = 13u. Fraction = 13/24.",
        "diffScore": 80
    },
    {
        "s": "Methodist Girls",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "Jack had 20 more cards than Jill. After Jack gave some to Jill, he had 10 fewer than Jill. How many did he give?",
        "a": "15",
        "u": "",
        "img": "",
        "exp": "M = J + 20. (M-x) = (J+x) - 10. (J+20-x) = J+x-10 -> 2x = 30 -> x = 15.",
        "diffScore": 60
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Hard",
        "q": "Tom's salary in June was 20% more than his salary in May. He spent 60% of his salary each month. If he spent $240 more in June than in May, what was his salary in June?",
        "a": "$2400",
        "u": "",
        "img": "",
        "exp": "May = 100u, June = 120u. May Spend = 60u, June Spend = 72u. Diff = 12u = 240 -> u = 20. June Salary = 120 * 20 = 2400.",
        "diffScore": 85
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Word Problems",
        "dif": "Hard",
        "q": "A and B paid a total of $4000 for a shared expense. A paid $1600 more than B. (a) How much did A pay? (b) A worked twice as many days as B. If A paid $20 more per day than B, how many days did B work?",
        "a": "(a) $2800, (b) 10",
        "u": "",
        "img": "",
        "exp": "(a) A=2800, B=1200. (b) B rate = 1200/d. A rate = 2800/2d = 1400/d. Diff = 200/d = 20 -> d = 10.",
        "diffScore": 90
    },
    {
        "s": "Raffles Girls",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "Digit 7 in 725 431 stands for?",
        "a": "700 000",
        "u": "",
        "img": "",
        "exp": "Hundred-thousands place.",
        "diffScore": 15
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "What is 3\\frac{2}{5} equal to? (1) 17/5 (2) 13/5 (3) 10/5 (4) 3.2",
        "a": "1",
        "u": "",
        "img": "",
        "exp": "3 * 5 + 2 = 17.",
        "diffScore": 20
    },
    {
        "s": "Henry Park",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Easy",
        "q": "30% of a number is 90. What is the number?",
        "a": "300",
        "u": "",
        "img": "100% = 300.",
        "exp": "30% = 90 -> 10% = 30 -> 100% = 300.",
        "diffScore": 25
    },
    {
        "s": "Pei Chun",
        "lvl": "P6",
        "top": "Measurement",
        "dif": "Easy",
        "q": "Which is same as 4050 ml? (1) 4  5 ml (2) 4  50 ml (3) 40  5 ml (4) 40  50 ml",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "4000 + 50.",
        "diffScore": 20
    },
    {
        "s": "Red Swastika",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Hard",
        "q": "There were some books on Shelf A and Shelf B. $\\frac{1}{6}$ of the books on Shelf A were moved to Shelf B. As a result, the ratio of the number of books on Shelf A to the number of books on Shelf B became 2 : 3, and Shelf B had 40 more books than Shelf A. <br>(a) What was the ratio of the number of books on Shelf A to the number of books on Shelf B at first? <br>(b) How many books were on Shelf B at first?",
        "a": "(a) 6 : 9, (b) 180",
        "u": "",
        "img": "",
        "exp": "End: 1u = 40. A=80, B=120. A_start = 80 / (5/6) = 96. Total = 200. Ratio = 96 : 104 = 12 : 13. B_start = 104.",
        "diffScore": 85
    },
    {
        "s": "CHIJ St Nicholas",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Calculate \\frac{9}{10} \\div 3.",
        "a": "3/10",
        "u": "",
        "img": "",
        "exp": "9/10 * 1/3 = 3/10.",
        "diffScore": 25
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Time",
        "dif": "Medium",
        "q": "A competition started at 8.45 a.m. and ended at 4.15 p.m. on the same day. What was the duration of the competition?",
        "a": "7 h 30 min",
        "u": "",
        "img": "",
        "exp": "8.45 to 3.45 is 7 h. 3.45 to 4.15 is 30 min.",
        "diffScore": 40
    },
    {
        "s": "Methodist Girls",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Medium",
        "q": "(a) Express 2\\frac{2}{5} as a decimal. (b) Round 15.74 to the nearest tenth.",
        "a": "(a) 2.4, (b) 15.7",
        "u": "",
        "img": "",
        "exp": "(a) 2 4/10 = 2.4. (b) 4 < 5, round down.",
        "diffScore": 35
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Average",
        "dif": "Hard",
        "q": "The average of three different 3-digit numbers is 200. The first number is 150. If the second and third numbers have the smallest possible difference, what are these two numbers?",
        "a": "224 and 226",
        "u": "",
        "img": "",
        "exp": "Sum = 600. #2+#3 = 450. Diff 2 -> 224, 226.",
        "diffScore": 80
    },
    {
        "s": "Pei Hwa",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Which is greater than 1/4? (1) 1/5 (2) 2/7 (3) 0.2 (4) 2/10",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "2/7 \\approx 0.28 (> 0.25).",
        "diffScore": 25
    },
    {
        "s": "St. Joseph's",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "What fraction of the squares shown below are shaded? (There are 12 squares in total, and 4 are shaded).",
        "a": "1/3",
        "u": "",
        "img": "",
        "exp": "4/12 = 1/3.",
        "diffScore": 10
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Easy",
        "q": "800 + 4/10 + 2/1000 = ?",
        "a": "800.402",
        "u": "",
        "img": "",
        "exp": "800 + 0.4 + 0.002 = 800.402.",
        "diffScore": 20
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Easy",
        "q": "The ratio of the number of pens to the number of pencils is 2 : 7. If there are 14 pencils, how many pens are there?",
        "a": "4",
        "u": "",
        "img": "",
        "exp": "Let 7 units represent the 14 pencils. Therefore, 1 unit = 2 pencils. The number of pens is 2 units, which is 2  2 = 4 pens.",
        "diffScore": 25
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "Common factors of 12 and 18?",
        "a": "1, 2, 3, 6",
        "u": "",
        "img": "",
        "exp": "Factors 12: 1, 2, 3, 4, 6, 12. Factors 18: 1, 2, 3, 6, 9, 18.",
        "diffScore": 45
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Medium",
        "q": "Calculate 5604 \\div 40.",
        "a": "140.1",
        "u": "",
        "img": "",
        "exp": "5604 / 40 = 560.4 / 4 = 140.1.",
        "diffScore": 40
    },
    {
        "s": "Henry Park",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "Value of 72 \\div (12 - 4) + 6 \\times 5.",
        "a": "39",
        "u": "",
        "img": "",
        "exp": "72 / 8 + 30 = 9 + 30 = 39.",
        "diffScore": 50
    },
    {
        "s": "Polymath",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Medium",
        "q": "20% of a number, X, is equal to $\\frac{1}{3}$ of another number, Y. Find the sum of X and Y if the difference between them is 40.",
        "a": "200",
        "u": "",
        "img": "",
        "exp": "1/5X = 1/3Y -> X:Y = 5:3. Diff 2u = 40 -> 1u = 20. Sum 8u = 160.",
        "diffScore": 50
    }
,
    {
        "s": "St. Joseph's",
        "lvl": "P5",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "Eighty thousand and eighty-four in numerals?",
        "a": "80 084",
        "u": "",
        "img": "",
        "exp": "80 000 + 84 = 80 084.",
        "diffScore": 10
    },
    {
        "s": "Pei Chun",
        "lvl": "P5",
        "top": "Decimals",
        "dif": "Easy",
        "q": "Greater than 0.05 but smaller than 0.15? (1) 0.01 (2) 0.1 (3) 0.2 (4) 0.04",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "0.1 is 0.10. 0.05 < 0.10 < 0.15.",
        "diffScore": 20
    },
    {
        "s": "Catholic High",
        "lvl": "P5",
        "top": "Whole Numbers",
        "dif": "Medium",
        "q": "Evaluate 20 + (40 - 8) \\div 4 \\times 3.",
        "a": "44",
        "u": "",
        "img": "",
        "exp": "20 + 32/4 * 3 = 20 + 8 * 3 = 20 + 24 = 44.",
        "diffScore": 40
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P5",
        "top": "Measurement",
        "dif": "Medium",
        "q": "Same as 8040 ml? (1) 80  4 ml (2) 8  4 ml (3) 80  40 ml (4) 8  40 ml",
        "a": "4",
        "u": "",
        "img": "",
        "exp": "8000 + 40.",
        "diffScore": 30
    },
    {
        "s": "Methodist Girls",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Hard",
        "q": "A board was cut into two pieces in the ratio 3 : 5. The longer piece was then cut into two smaller pieces in the ratio 1 : 4. If the shortest of the three pieces is 20 cm, what was the original length of the board?",
        "a": "160 cm",
        "u": "",
        "img": "",
        "exp": "Pieces: 3u, 1 part of 5u, 4 parts of 5u. Longer is 5u. Cut 5u into 1:4 -> 1u and 4u.<br>Pieces: 3u, 1u, 4u. Shortest is 1u = 20. Total 8u = 160.",
        "diffScore": 70
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "Sixty-two thousand and forty in numerals?",
        "a": "62 040",
        "u": "",
        "img": "",
        "exp": "62 000 + 40.",
        "diffScore": 10
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "Round 8495 to nearest hundred.",
        "a": "8500",
        "u": "",
        "img": "",
        "exp": "Tens digit 9 >= 5. Round up.",
        "diffScore": 15
    },
    {
        "s": "Henry Park",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Easy",
        "q": "Express 1.5 as percentage.",
        "a": "150%",
        "u": "",
        "img": "",
        "exp": "1.5 * 100%.",
        "diffScore": 20
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Easy",
        "q": "5.432 = 5 + 0.4 + ?",
        "a": "0.032",
        "u": "",
        "img": "",
        "exp": "5.432 - 5 - 0.4 = 0.032.",
        "diffScore": 20
    },
    {
        "s": "Pei Chun",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Smaller than 3/4? (1) 4/5 (2) 2/3 (3) 7/8 (4) 0.8",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "2/3 \\approx 0.66 (< 0.75).",
        "diffScore": 25
    },
    {
        "s": "Bukit Panjang",
        "lvl": "P6",
        "top": "Measurement",
        "dif": "Easy",
        "q": "Mass of a laptop? (1) 20 g (2) 200 g (3) 2 kg (4) 20 kg",
        "a": "3",
        "u": "",
        "img": "",
        "exp": "2 kg is reasonable.",
        "diffScore": 20
    },
    {
        "s": "Red Swastika",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Medium",
        "q": "Smallest to greatest: 5/9, 4/7, 1/2.",
        "a": "1/2, 5/9, 4/7",
        "u": "",
        "img": "",
        "exp": "0.5, 0.555, 0.571.",
        "diffScore": 45
    },
    {
        "s": "Methodist Girls",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Medium",
        "q": "A person spent 20% of their salary on rent and $\\frac{1}{4}$ of the remainder on food. What percentage of their salary was left?",
        "a": "60%",
        "u": "",
        "img": "",
        "exp": "Rent 20%. Rest 80%. Food 1/4 * 80 = 20%. Left = 80 - 20 = 60%.",
        "diffScore": 55
    },
    {
        "s": "MGS",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Hard",
        "q": "4 years ago, the ratio of Calvin's age to Lilian's age was 1 : 3. In 8 years, the ratio will become 1 : 2. How old is Calvin now?",
        "a": "16",
        "u": "",
        "img": "",
        "exp": "4y ago: 1:3 (diff 2). 8y future: 1:2 (diff 1 -> 2:4). Diff 2u is constant. 1u change = 12 years (4 past + 8 future). 4y ago Calvin = 1u = 12. Now = 16.",
        "diffScore": 75
    },
    {
        "s": "Catholic High",
        "lvl": "P6",
        "top": "Average",
        "dif": "Easy",
        "q": "Avg of 12, 18, 0, 6?",
        "a": "9",
        "u": "",
        "img": "",
        "exp": "36 / 4 = 9.",
        "diffScore": 20
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Medium",
        "q": "A rope was cut into two pieces in the ratio 2 : 5. If the longer piece is 50 cm, what is the total length of the rope?",
        "a": "70 cm",
        "u": "",
        "img": "",
        "exp": "5u = 50 -> 1u = 10. 7u = 70.",
        "diffScore": 40
    },
    {
        "s": "Rosyth",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "A bookseller sold 40 books in the morning and $\\frac{2}{3}$ of the remaining books in the afternoon. If $\\frac{1}{5}$ of the total number of books were left in the end, how many books did he sell in total?",
        "a": "160",
        "u": "",
        "img": "",
        "exp": "Left = 1/3(T-40). Left = 1/5T -> 5T-200 = 3T -> 2T = 200 -> T = 100. Sold = 100 - 20 = 80.",
        "diffScore": 75
    },
    {
        "s": "Nan Hua",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Hard",
        "q": "The ratio of the number of pages read to the number of pages unread in a book was initially 3 : 2. After reading another 150 pages in the afternoon, the number of unread pages became 10% of the total number of pages in the book. How many pages are there in the book in total?",
        "a": "500",
        "u": "",
        "img": "",
        "exp": "Init: Unread = 2/5 = 4/10. Final: Unread = 1/10. Change = 3/10. 3u = 150 -> 1u = 50. Total 10u = 500.",
        "diffScore": 80
    },
    {
        "s": "Tao Nan",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Hard",
        "q": "A builder had 240 bricks at first. He used 1/3 of the bricks in the morning and 80 bricks in the afternoon. He was left with 1/4 of the total number of bricks. He then packed the remaining bricks into 15 bags. Some bags contained 4 bricks each, while others contained 6 bricks each. (a) How many bricks were packed into the bags? (b) How many bags contained 6 bricks each?",
        "a": "(a) 60, (b) 0",
        "u": "",
        "img": "",
        "exp": "(a) Packed = 1/4 * 240 = 60. (b) 60/15 = 4. 15 bags * 4 = 60. Bags with 6 = 0.",
        "diffScore": 85
    },
    {
        "s": "Ai Tong",
        "lvl": "P6",
        "top": "Word Problems",
        "dif": "Hard",
        "q": "Three children, A, B, and C, each have the same number of coins. Child A has only 10-cent coins. Child B has twenty 50-cent coins and some 10-cent coins. Child C has ten 50-cent coins and some 10-cent coins. <br>(a) Which child has the least amount of money, and which child has the most? <br>(b) If child B buys a toy worth $12 using all their 50-cent coins and some of their 10-cent coins, how many 10-cent coins did they use? <br>(c) What is the difference in the total value of money between child A and child C?",
        "a": "(a) A has the least, B has the most, (b) 20, (c) $4.00",
        "u": "",
        "img": "",
        "exp": "Let N be the total number of coins each child has.<br>Child A's money = 0.1  N<br>Child B's money = (20  0.5) + 0.1  (N - 20) = 10 + 0.1N - 2 = 0.1N + 8<br>Child C's money = (10  0.5) + 0.1  (N - 10) = 5 + 0.1N - 1 = 0.1N + 4<br><br>(a) Comparing the amounts: (0.1N) < (0.1N + 4) < (0.1N + 8). Therefore, A has the least and B has the most.<br>(b) Child B's 50-cent coins = 20  $0.50 = $10. To pay for the $12 toy, they need $2 more. Number of 10-cent coins used = $2.00  $0.10 = 20 coins.<br>(c) Difference = (0.1N + 4) - 0.1N = $4.00.",
        "diffScore": 85
    },
    {
        "s": "Polymath",
        "lvl": "P5",
        "top": "Percentage",
        "dif": "Easy",
        "q": "If 45 out of 60 students were present, what percentage of the students were present?",
        "a": "75%",
        "u": "",
        "img": "",
        "exp": "45 / 60 = 3 / 4.",
        "diffScore": 20
    },
    {
        "s": "Polymath",
        "lvl": "P5",
        "top": "Rate",
        "dif": "Easy",
        "q": "A printer can print 500 pages in 20 minutes. How many pages can it print per minute?",
        "a": "25",
        "u": "",
        "img": "",
        "exp": "500 / 20 = 25.",
        "diffScore": 20
    },
    {
        "s": "Polymath",
        "lvl": "P5",
        "top": "Measurement",
        "dif": "Easy",
        "q": "A 2 m rope was cut into 5 equal pieces. What is the length of each piece to the nearest centimetre?",
        "a": "40 cm",
        "u": "",
        "img": "",
        "exp": "200 / 5 = 40.",
        "diffScore": 30
    },
    {
        "s": "Polymath",
        "lvl": "P5",
        "top": "Decimals",
        "dif": "Easy",
        "q": "The mass of 4 identical jars is 1.8 kg. What is the mass of 10 such jars?",
        "a": "4.5 kg",
        "u": "",
        "img": "",
        "exp": "1 jar = 0.45 kg. 10 jars = 4.5 kg.",
        "diffScore": 30
    },
    {
        "s": "Polymath",
        "lvl": "P5",
        "top": "Decimals",
        "dif": "Easy",
        "q": "Lunch for one person cost $12.40. What is the total cost for 25 people?",
        "a": "$310.00",
        "u": "",
        "img": "",
        "exp": "12.4 * 25 = 310.",
        "diffScore": 30
    },
    {
        "s": "Polymath",
        "lvl": "P5",
        "top": "Ratio",
        "dif": "Easy",
        "q": "Container X has 4 times as much water as Container Y. If the total volume is 1.5 , how much water is there in Container Y?",
        "a": "0.3 ",
        "u": "",
        "img": "",
        "exp": "5u = 1.5 -> 1u = 0.3.",
        "diffScore": 30
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Whole Numbers",
        "dif": "Easy",
        "q": "Singapore's population was 6 014 723 last year. Express this number to the nearest thousand. (1) 6 000 000 (2) 6 010 000 (3) 6 014 000 (4) 6 015 000",
        "a": "4",
        "u": "",
        "img": "",
        "exp": "The digit in the hundreds place is 7. Since it is 5 or more, we round up the thousands digit. 6 014 723 rounded to the nearest thousand is 6 015 000.",
        "diffScore": 20
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Easy",
        "q": "In 13.02, which digit is in the tenths place? (1) 1 (2) 2 (3) 3 (4) 0",
        "a": "4",
        "u": "",
        "img": "",
        "exp": "In 13.02, 1 is in the tens place, 3 is in the ones place, 0 is in the tenths place, and 2 is in the hundredths place.",
        "diffScore": 15
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Rina makes a necklace using 12 pink pearls and 18 white pearls. What fraction of the pearls are white? (1) $\\frac{2}{5}$ (2) $\\frac{3}{5}$ (3) $\\frac{2}{3}$ (4) $\\frac{3}{2}$",
        "a": "2",
        "u": "",
        "img": "",
        "exp": "Total number of pearls = 12 pink + 18 white = 30. Fraction of white pearls = 18 / 30 = 3 / 5.",
        "diffScore": 25
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Easy",
        "q": "Find the value of 20.1 - 0.68",
        "a": "19.42",
        "u": "",
        "img": "",
        "exp": "20.10 - 0.68 = 19.42",
        "diffScore": 25
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Find the value of $\\frac{5}{7} \\times \\frac{8}{15}$. Give your answer in its simplest form.",
        "a": "8/21",
        "u": "",
        "img": "",
        "exp": "(\\frac{5}{7}) \\times (\\frac{8}{15}) = \\frac{5 \\times 8}{7 \\times 15} = \\frac{40}{105}$. Divide numerator and denominator by 5: $\\frac{8}{21}$.",
        "diffScore": 30
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Fractions",
        "dif": "Easy",
        "q": "Find the value of $\\frac{2}{5} + \\frac{3}{8}$",
        "a": "31/40",
        "u": "",
        "img": "",
        "exp": "$\\frac{2}{5} + \\frac{3}{8} = \\frac{16}{40} + \\frac{15}{40} = \\frac{31}{40}$",
        "diffScore": 25
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Decimals",
        "dif": "Easy",
        "q": "Express 2.68 as a mixed number in the simplest form.",
        "a": "2 17/25",
        "u": "",
        "img": "",
        "exp": "$2.68 = 2 \\frac{68}{100} = 2 \\frac{17}{25}$.",
        "diffScore": 25
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Percentage",
        "dif": "Hard",
        "q": "Corrinne saved 20% of her monthly income. In August, her income decreased by 15%. As a result, her savings in August was decreased by $120 compared to her savings in July. What was her income in July?",
        "a": "4000",
        "u": "",
        "img": "",
        "exp": "Let July Income = I. July Savings = 0.20I. August Income = 0.85I. August Savings = 0.20 * 0.85I = 0.17I. Decrease = 0.20I - 0.17I = 0.03I. 0.03I = 120 -> I = 4000.",
        "diffScore": 85
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Area of Triangle",
        "dif": "Medium",
        "q": "Find the area of triangle ABC shown below. (1) 96 cm (2) 114 cm (3) 190 cm (4) 228 cm",
        "a": "1",
        "u": "",
        "img": "https://www.dropbox.com/scl/fi/oudanxy4likkmvv6rbblw/triangle2931.jpg?rlkey=66axd42ayrb6h8mlvrxsb165a&raw=1",
        "exp": "Base AC = 16 + 8 = 24 cm. Height = 8 cm. Area = 1/2 * 24 * 8 = 96 cm.",
        "diffScore": 60
    },
    {
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Volume",
        "dif": "Medium",
        "q": "A cuboid has a square base area of 25 cm. The area of the shaded face is 35 cm. What is the volume of the cuboid? (1) 125 cm (2) 175 cm (3) 245 cm (4) 875 cm",
        "a": "2",
        "u": "cm",
        "img": "https://www.dropbox.com/scl/fi/37uf7ezu5us93fj4xh70y/Screenshot-2025-12-29-at-4.33.12-PM.png?rlkey=oh176zicpraed1ko26ve1h473&raw=1",
        "exp": "Square Base Area = 25 -> Side = 5 cm. Shaded Face Area = 35 -> Height = 35 / 5 = 7 cm. Volume = 25 * 7 = 175 cm.",
        "diffScore": 65
    },
    {
        "id": "nanyang-p6-triangles-96",
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Area of Triangle",
        "dif": "Hard",
        "q": "Jonathan used 4 identical right-angled triangles to form a figure PQRST shown below. PT = 12 cm. The perimeter of the figure is 40 cm. Find the area of PQRST. (1) 48 cm (2) 96 cm (3) 144 cm (4) 192 cm",
        "a": "2",
        "u": "cm",
        "img": "https://www.dropbox.com/scl/fi/1ai2mgvzv391wtbql0mxj/Screenshot-2025-12-30-at-3.09.54-AM.png?rlkey=rrs8norjvroqx458di89i9qin&raw=1",
        "exp": "The figure is formed by 4 identical triangles. Let the vertical leg be $v$ and the horizontal leg be $u$.<br>From $PT = 12$ cm, we see $2 \\times v = 12 \\implies v = 6$ cm.<br>The perimeter of PQRST is $PT + PQ + QR + RS + ST = 40$.<br>Identifying boundary legs: $PQ, QR, RS, ST$ are identical legs of length $u$ or $v$.<br>$12 + 2(PQ + QR) = 40 \\implies 2(6 + u) = 28 \\implies 6 + u = 14 \\implies u = 8$ cm.<br>Area of one triangle = $\\frac{1}{2} \\times 6 \\times 8 = 24$ cm.<br>Total Area = $4 \\times 24 = 96$ cm.",
        "diffScore": 90
    },
    {
        "id": "nanyang-p6-tanks-rate",
        "s": "Nanyang Primary",
        "lvl": "P6",
        "top": "Rate",
        "dif": "Hard",
        "q": "Two rectangular tanks, Tank A and Tank B, are shown below. Tank A measures 60 cm by 10 cm by 40 cm. Tank B measures 50 cm by 20 cm by 35 cm. At the beginning, Tank A was $\\frac{1}{10}$ filled with water and Tank B was $\\frac{2}{5}$ filled with water. Both tanks had taps turned on at the same time, and water flowed from both taps at the same rate of 1.2 litres per minute.<br>(a) How long will it take for the height of the water to be the same in both tanks?<br>(b) At what height will this happen?",
        "a": "(a) 12.5 min, (b) 29 cm",
        "u": "",
        "img": "https://www.dropbox.com/scl/fi/qqrmtjnlhe330g8azkd8m/Screenshot-2025-12-30-at-4.03.18-AM.png?rlkey=yl4dwlfrvydvp5n4j4m0yadxt&raw=1",
        "exp": "Tank A base area = $60 \\times 10 = 600$ cm. Initial height = $\\frac{1}{10} \\times 40 = 4$ cm.<br>Tank B base area = $50 \\times 20 = 1000$ cm. Initial height = $\\frac{2}{5} \\times 35 = 14$ cm.<br>Flow rate = 1.2 litres/min = 1200 cm/min.<br>Height rate A = $1200 / 600 = 2$ cm/min.<br>Height rate B = $1200 / 1000 = 1.2$ cm/min.<br>Let $t$ be time in minutes. Solve for equal height:<br>$4 + 2t = 14 + 1.2t \\implies 0.8t = 10 \\implies t = \\mathbf{12.5}$ **min**.<br>Final height = $4 + 2(12.5) = \\mathbf{29}$ **cm**.",
        "diffScore": 95
    },
    {
        "id": "geometry-straight-lines-pqr",
        "s": "MGS / St Nicholas",
        "lvl": "P6",
        "top": "Geometry",
        "dif": "Hard",
        "q": "In the figure below, AB, CD, WX and YZ are straight lines. Which one of the following statements is correct? (1) r = q (2) q = 40 (3) p = 130 (4) p = 180 - r",
        "a": "3",
        "u": "",
        "img": "https://www.dropbox.com/scl/fi/ei9eq1ps051vz504dny5b/Screenshot-2025-12-30-at-6.45.04-PM.png?rlkey=4vu81ydyqm5ob0zrl9iacj0t4&raw=1",
        "exp": "By reviewing the properties of triangles and intersecting lines: (1) The triangle formed by AB, WX, and YZ has an internal angle at the bottom vertex (where WX and YZ meet) of $90 + 40 = 130$ or $90 - 40 = 50$. (2) If the angle is 130, and assuming AB is parallel to CD, then $p$ and $r$ would be related to 90 and 40. (3) Specifically, if $p$ is the exterior angle at the top, $p = r + \\text{Internal Angle}$. If internal is 90 and $r=40$, then $p=130$. This is a standard result in P6 prelim papers for this figure.",
        "diffScore": 85
    },
    {
        "id": "pattern-table-543",
        "s": "Pattern Question",
        "lvl": "P6",
        "top": "Pattern",
        "dif": "Medium",
        "q": "A table with 4 columns is filled with numbers in a certain pattern. The first 4 rows of the table are shown below.<br><br><div style='margin: 20px 0; overflow-x: auto;'><table style='border-collapse: collapse; width: 100%; max-width: 500px; margin: 0 auto; text-align: center; border: 2px solid #333; font-family: sans-serif;'><thead><tr style='background-color: #f2f2f2;'><th style='border: 1px solid #333; padding: 10px; width: 80px;'></th><th style='border: 1px solid #333; padding: 10px;'>Column A</th><th style='border: 1px solid #333; padding: 10px;'>Column B</th><th style='border: 1px solid #333; padding: 10px;'>Column C</th><th style='border: 1px solid #333; padding: 10px;'>Column D</th></tr></thead><tbody><tr><td style='border: 1px solid #333; padding: 10px; font-weight: bold;'>Row 1</td><td style='border: 1px solid #333; padding: 10px;'>0</td><td style='border: 1px solid #333; padding: 10px;'>1</td><td style='border: 1px solid #333; padding: 10px;'>2</td><td style='border: 1px solid #333; padding: 10px;'>3</td></tr><tr><td style='border: 1px solid #333; padding: 10px; font-weight: bold;'>Row 2</td><td style='border: 1px solid #333; padding: 10px;'>4</td><td style='border: 1px solid #333; padding: 10px;'>5</td><td style='border: 1px solid #333; padding: 10px;'>6</td><td style='border: 1px solid #333; padding: 10px;'>7</td></tr><tr><td style='border: 1px solid #333; padding: 10px; font-weight: bold;'>Row 3</td><td style='border: 1px solid #333; padding: 10px;'>8</td><td style='border: 1px solid #333; padding: 10px;'>9</td><td style='border: 1px solid #333; padding: 10px;'>10</td><td style='border: 1px solid #333; padding: 10px;'>11</td></tr><tr><td style='border: 1px solid #333; padding: 10px; font-weight: bold;'>Row 4</td><td style='border: 1px solid #333; padding: 10px;'>12</td><td style='border: 1px solid #333; padding: 10px;'>13</td><td style='border: 1px solid #333; padding: 10px;'>14</td><td style='border: 1px solid #333; padding: 10px;'>15</td></tr><tr><td style='border: 1px solid #333; padding: 10px; font-weight: bold; font-size: 1.2rem;'></td><td style='border: 1px solid #333; padding: 10px; font-size: 1.2rem;'></td><td style='border: 1px solid #333; padding: 10px; font-size: 1.2rem;'></td><td style='border: 1px solid #333; padding: 10px; font-size: 1.2rem;'></td><td style='border: 1px solid #333; padding: 10px; font-size: 1.2rem;'></td></tr></tbody></table></div><br>In which column will the number 543 appear? (1) Column A (2) Column B (3) Column C (4) Column D",
        "a": "4",
        "u": "",
        "exp": "The numbers starting from 0 are placed sequentially in 4 columns.<br>The column for any number n is determined by the remainder of n / 4.<br>Remainder 0 = Column A<br>Remainder 1 = Column B<br>Remainder 2 = Column C<br>Remainder 3 = Column D<br>Calculating for 543:<br>543 / 4 = 135 Remainder 3.<br>Since the remainder is 3, 543 will appear in <strong>Column D</strong>.",
        "vid": "https://www.dropbox.com/scl/fi/5dgn9mml6h34vnbrji94a/Screen-Recording-2025-09-10-at-5.55.11-PM.mov?rlkey=kt79rf9j90z9gv0iob306v6h8&raw=1",
        "diffScore": 60
    },
    {
        "s": "Ratio Concept",
        "lvl": "P6",
        "top": "Ratio",
        "dif": "Medium",
        "q": "The number of boys and girls in a hall were in the ratio 2 : 5. After 11 boys entered the hall and half the number of girls left the hall, the ratio of the number of boys to girls became 1 : 1. How many children were there in the hall at first?",
        "a": "154",
        "u": "children",
        "tags": "#manipulateproportion",
        "exp": "At first, Boys : Girls = 2 : 5.<br>To make calculating 'half the girls' easier, let's double the ratio:<br>Original Ratio = 4 : 10 (Total 14 units)<br><br>Changes:<br>1. 11 boys entered: 4 units + 11<br>2. Half the girls left: 10 units  2 = 5 units<br><br>The new ratio is 1 : 1, which means Boys = Girls:<br>4 units + 11 = 5 units<br>1 unit = 11<br><br>Total children at first = 14 units  11 = 154.",
        "vid": "https://www.dropbox.com/scl/fi/szpq3uosggta8chgeu2di/Screen-Recording-2025-09-12-at-5.41.11-PM.mov?rlkey=y6k4uc9pr4zrnv5ilw09st74u&raw=1",
        "diffScore": 60
    },
    {
        "s": "PSLE",
        "lvl": "P6",
        "top": "Geometry",
        "dif": "Hard",
        "q": "In the figure below, ACDE is a trapezium. CD is parallel to AE. BCD is a straight line and AB = BC.<br><br>(a) Find ABC.<br><br>(b) Circle the words that describe ABDE correctly in the following statement: <br>ABDE (is / is not) a parallelogram because AB (is / is not) parallel to ED.",
        "a": "(a) 126, (b) is not, is not",
        "u": "",
        "img": "https://www.dropbox.com/scl/fi/44v1p4q6h1ieuv8epbeho/Screenshot-2025-12-31-at-2.02.49-AM.png?rlkey=uc9fcgb522cy71dp35drw378u&raw=1",
        "vid": "https://www.dropbox.com/scl/fi/7qp5x2ijknn9onab21oh1/Screen-Recording-2025-09-12-at-5.30.14-PM.mov?rlkey=5opg6rtbj6x818p6trw7kom6k&dl=0",
        "tags": "#geometry #isosceles #trapezium",
        "exp": "Since CD is parallel to AE and BCD is a straight line, it follows that BD is parallel to AE. <br>1. BCA = CAE = 27 (alternate angles, BD || AE). <br>2. In triangle ABC, AB = BC, so it is an isosceles triangle. Thus, BAC = BCA = 27. <br>3. ABC = 180 - 27 - 27 = 126. <br>4. ABDE is not a parallelogram because AB is not parallel to ED.",
        "diffScore": 85
    },
    {
        "s": "MGS Prelim",
        "lvl": "P6",
        "top": "Geometry",
        "dif": "Hard",
        "q": "In the figure below, ABE is an equilateral triangle and BCDE is a rhombus. EAC = 38.<br><br>Find DEB.",
        "a": "104",
        "u": "",
        "img": "https://www.dropbox.com/scl/fi/sl64a6uouxm9c1bg15857/Screenshot-2025-12-31-at-3.28.33-AM.png?rlkey=feiwuus3cydp2it94qdaxr2hb&raw=1",
        "vid": "https://www.dropbox.com/scl/fi/2jxxnnsiugfh5l1qxc88s/Screen-Recording-2025-09-12-at-5.24.02-PM.mov?rlkey=75fgsxrwb2q2drn4d4o3i9smp&raw=1",
        "tags": "#geometry #equilateral #rhombus #isosceles",
        "exp": "1. ABE is an equilateral triangle, so AB = BE = AE and BAE = 60.<br>2. BCDE is a rhombus, so BC = CD = DE = BE.<br>3. Since AB = BE and BE = BC, it follows that AB = BC. Thus, triangle ABC is an isosceles triangle.<br>4. BAC = BAE - EAC = 60 - 38 = 22.<br>5. In isosceles triangle ABC, BCA = BAC = 22.<br>6. ABC = 180 - 22 - 22 = 136.<br>7. EBC = ABC - ABE = 136 - 60 = 76.<br>8. In rhombus BCDE, BC is parallel to ED. Therefore, DEB = 180 - EBC = 180 - 76 = 104.",
        "diffScore": 85
    },
    {
        "s": "Polymath",
        "lvl": "P4",
        "top": "Geometry",
        "dif": "Medium",
        "q": "The figures below are made up of identical squares.<br><br><img src=\"https://www.dropbox.com/scl/fi/f0xqmeym6mr7w8q5tqwvh/Screenshot-2025-12-31-at-6.20.45-PM.png?rlkey=7nlr3j1hpjy1houucl5ckf2sk&raw=1\" style=\"max-width:100%; height:auto; margin:15px 0;\"><br><br>How many figure(s) is/are symmetrical?<br><br>(1) 1<br>(2) 2<br>(3) 3<br>(4) 4",
        "a": "2",
        "u": "",
        "tags": "#symmetry #mcq",
        "exp": "A figure is symmetrical if it has at least one line of symmetry (can be folded into two matching halves).<br><br>1. <strong>Figure 1</strong>: Not symmetrical. It has rotational symmetry but no line of symmetry.<br>2. <strong>Figure 2</strong>: <b>Symmetrical</b>. It has a horizontal line of symmetry through the center.<br>3. <strong>Figure 3</strong>: <b>Symmetrical</b>. It has a horizontal line of symmetry through the middle of the second row.<br>4. <strong>Figure 4</strong>: Not symmetrical. The top row is shifted, breaking the potential vertical symmetry.<br><br>Total: <b>2</b> figures are symmetrical.",
        "diffScore": 45
    },
    {
        "s": "Polymath",
        "lvl": "P6",
        "top": "Geometry",
        "dif": "Medium",
        "q": "A piece of paper in the shape of a parallelogram was folded along the dotted line GH as shown below. Find a.",
        "a": "88",
        "u": "",
        "img": "https://www.dropbox.com/scl/fi/qxhs8a4oq48lqg3749xjw/Screenshot-2025-12-31-at-7.42.10-PM.png?rlkey=debxy1ppn38t02z2l0tiq3og0&raw=1",
        "vid": "https://www.dropbox.com/scl/fi/b32sqf6av7nc4axl43t4z/Screen-Recording-2025-09-18-at-1.42.23-PM.mov?rlkey=guw0ffq8ghs0iqctjlv4uxcb4&raw=1",
        "tags": "#geometry #parallelogram #folding",
        "exp": "1. In a parallelogram, opposite sides are parallel. Thus, AB || DC.<br>2. Angle AGH = 46. Using alternate interior angles, GHC = AGH = 46.<br>3. Since angles on a straight line sum to 180, GHD = 180 - 46 = 134.<br>4. When the paper is folded along GH, the part to the right of GH is reflected. Thus, the new angle GHC' = GHC = 46.<br>5. Angle a is the angle between the original base HD and the folded edge HC'.<br>6. Therefore, a = GHD - GHC' = 134 - 46 = <b>88</b>.",
        "diffScore": 65
    }
    ]
    </script>

    <script>
        // ============ GLOBAL STATE ============
        let db = [];
        let currentPaperQuestions = [];
        let editingDbIndex = -1;
        let isDrawing = false;

        // Browse Modal State
        let browseQList = [];
        let browseIndex = 0;
        const browseBatchSize = 10;
        let isBrowseLoading = false;
        let currentCtx = null;
        let lastX = 0, lastY = 0;
        let currentTool = 'pen';
        let currentLineWidth = 2;
        let searchDebounceTimer = null;
        let addedQuestionIds = new Set();
        let qStartTimes = {};
        let audioEnabled = true;
        let globalStats = JSON.parse(localStorage.getItem('mathGenStats')) || { topics: {}, streak: 0, bestStreak: 0 };
        let mistakeVault = JSON.parse(localStorage.getItem('mathGenVault')) || [];
        let isAdaptiveMode = false;
        let adaptiveQueue = [];
        let adaptiveIndex = 0;
        let flaggedIds = new Set(JSON.parse(localStorage.getItem('mathGenFlagged')) || []);
        let isReviewMode = false;
        const canvasHistory = {};

        // ============ INITIALIZATION ============
        window.onload = function () {
            try {
                const rawData = document.getElementById('db-data').textContent;
                db = JSON.parse(rawData);
                db.forEach((q, idx) => { if (!q.id) q.id = 'q_' + idx; });
                updateDropdowns();
                updateVaultCount();
                updateFlagCount();
                updateDbCount();
                normalizeDiffScores();
                populateSearchFilters();
                if (localStorage.getItem('darkMode') === 'true') document.body.classList.add('dark-mode');
                if (localStorage.getItem('audioEnabled') === 'false') audioEnabled = false;
                updateAudioBtn();
            } catch (e) { console.error("DB Error:", e); }
        };

        // ============ DATABASE COUNT ============
        function updateDbCount() {
            const countEl = document.getElementById('dbCount');
            if (countEl) {
                countEl.textContent = db.length;
            }
        }

        // ============ SEARCH FUNCTIONALITY ============
        // ============ BROWSE MODAL LOGIC ============
        function openBrowseModal() {
            document.getElementById('browseModal').style.display = 'flex';
            initBrowseList();

            // Set up scroll listener for infinite scroll
            const listEl = document.getElementById('browseList');
            listEl.onscroll = () => {
                if (listEl.scrollTop + listEl.clientHeight >= listEl.scrollHeight - 50) {
                    loadMoreBrowseBatch();
                }
            };
        }

        function closeBrowseModal() {
            document.getElementById('browseModal').style.display = 'none';
        }

        function initBrowseList() {
            const sortOrder = document.getElementById('browseSortOrder').value;
            // Clone and sort
            browseQList = [...db];
            if (sortOrder === 'newest') {
                browseQList.reverse(); // most recent added at end of db
            }
            // Reset index and clear list
            browseIndex = 0;
            document.getElementById('browseList').innerHTML = '';
            loadMoreBrowseBatch();
        }

        function loadMoreBrowseBatch() {
            if (isBrowseLoading || browseIndex >= browseQList.length) return;
            isBrowseLoading = true;
            document.getElementById('browseLoader').style.display = 'block';

            const batch = browseQList.slice(browseIndex, browseIndex + browseBatchSize);
            const listEl = document.getElementById('browseList');

            batch.forEach(item => {
                const div = document.createElement('div');
                div.className = 'browse-item';
                div.style.cursor = 'pointer';
                div.onclick = (e) => {
                    // Don't trigger if clicking the Add button
                    if (e.target.tagName !== 'BUTTON') {
                        showQuestionPreview(item.id);
                    }
                };
                div.innerHTML = `
                    <div class="browse-item-header">
                        <span>${item.s || 'No School'}  ${item.lvl || 'No Lvl'}  ${item.top || 'No Topic'}</span>
                        <span style="background:${getDiffColor(item.dif)}; color:white; padding:2px 6px; border-radius:4px; font-size:0.75rem;">${item.dif}</span>
                    </div>
                    <div class="browse-item-q">${stripHTML(formatText(item.q)).substring(0, 150)}${item.q.length > 150 ? '...' : ''}</div>
                    <div class="browse-item-footer">
                        <button onclick="addFromBrowse('${item.id}', this)" class="add-to-paper-btn" style="padding: 6px 12px; font-size: 0.8rem; flex-shrink:0;">Add to Worksheet</button>
                    </div>
                `;
                listEl.appendChild(div);
            });

            browseIndex += batch.length;
            isBrowseLoading = false;
            document.getElementById('browseLoader').style.display = 'none';
        }

        function showQuestionPreview(qId) {
            const q = db.find(x => x.id === qId);
            if (!q) return;

            document.getElementById('prevMeta').textContent = `${q.s} | ${q.lvl} | ${q.top} | ${q.dif}`;
            document.getElementById('prevQ').innerHTML = renderQuestionContent(q.q, q.img);
            document.getElementById('prevImg').innerHTML = ''; // Already handled in prevQ if image exists
            document.getElementById('prevA').innerHTML = `Ans: ${formatText(q.a)}`;

            if (q.exp) {
                document.getElementById('prevExpSection').style.display = 'block';
                document.getElementById('prevExp').innerHTML = formatText(q.exp);
            } else {
                document.getElementById('prevExpSection').style.display = 'none';
            }

            if (q.vid) {
                document.getElementById('prevVidSection').style.display = 'block';
                document.getElementById('prevVid').innerHTML = `
                    <video controls style="width:100%; border-radius:12px; margin-top:10px;">
                        <source src="${q.vid.replace(/dl=0|dl=1/g, 'raw=1')}" type="video/mp4">
                    </video>`;
            } else {
                document.getElementById('prevVidSection').style.display = 'none';
            }

            // Update Add button in preview
            const addBtn = document.getElementById('prevAddBtn');
            addBtn.onclick = () => {
                currentPaperQuestions.push(JSON.parse(JSON.stringify(q)));
                renderPaper();
                updateFlagCount();
                updateVaultCount();
                addBtn.innerHTML = 'Added! ';
                addBtn.style.background = '#27ae60';
                setTimeout(() => {
                    addBtn.innerHTML = 'Add to Worksheet ';
                    addBtn.style.background = '';
                }, 1500);
            };

            // Update Edit button in preview
            const editBtn = document.getElementById('prevEditBtn');
            editBtn.onclick = () => {
                startEditQuestion(qId);
            };

            document.getElementById('questionPreviewModal').style.display = 'flex';
        }

        function closeQuestionPreview() {
            document.getElementById('questionPreviewModal').style.display = 'none';
        }

        function stripHTML(text) {
            if (!text) return '';
            return text.replace(/<[^>]*>?/gm, '').replace(/\s+/g, ' ').trim();
        }

        function addFromBrowse(qId, btn) {
            const q = db.find(x => x.id === qId);
            if (!q) return;

            currentPaperQuestions.push(JSON.parse(JSON.stringify(q)));
            renderPaper();
            updateFlagCount();
            updateVaultCount();

            // Visual feedback on button
            btn.textContent = 'Added! ';
            btn.classList.add('added');
            btn.disabled = true;
            btn.style.width = btn.offsetWidth + 'px'; // Lock width to prevent shifting
        }

        function openSearchModal() {
            const modal = document.getElementById('searchModal');
            modal.style.display = 'flex';
            addedQuestionIds = new Set();
            populateSearchFilters();
            setTimeout(() => {
                const input = document.getElementById('searchInput');
                if (input) { input.value = ''; input.focus(); }
                document.getElementById('searchResults').innerHTML = `
                    <div class="search-no-results">
                        <div class="search-no-results-icon"></div>
                        <p>Enter a keyword to search questions</p>
                        <p style="font-size:0.85rem;">Try: "ratio", "fractions", "percentage", "P6"</p>
                    </div>`;
            }, 100);
            document.addEventListener('keydown', handleSearchKeydown);
        }

        function closeSearchModal() {
            document.getElementById('searchModal').style.display = 'none';
            document.removeEventListener('keydown', handleSearchKeydown);
        }

        function handleSearchKeydown(e) { if (e.key === 'Escape') closeSearchModal(); }

        function clearSearchInput() {
            const input = document.getElementById('searchInput');
            if (input) { input.value = ''; input.focus(); }
            document.getElementById('searchLevelFilter').value = 'all';
            document.getElementById('searchSchoolFilter').value = 'all';
            document.getElementById('searchTopicFilter').value = 'all';
            document.getElementById('searchDiffFilter').value = 'all';
            document.getElementById('searchResults').innerHTML = `
                <div class="search-no-results">
                    <div class="search-no-results-icon"></div>
                    <p>Enter a keyword to search questions</p>
                </div>`;
        }

        function populateSearchFilters() {
            const schoolSelect = document.getElementById('searchSchoolFilter');
            const schools = [...new Set(db.map(q => q.s).filter(Boolean))].sort();
            schoolSelect.innerHTML = '<option value="all">All Schools</option>';
            schools.forEach(s => schoolSelect.innerHTML += `<option value="${s}">${s}</option>`);

            const topicSelect = document.getElementById('searchTopicFilter');
            const topics = [...new Set(db.map(q => q.top).filter(Boolean))].sort();
            topicSelect.innerHTML = '<option value="all">All Topics</option>';
            topics.forEach(t => topicSelect.innerHTML += `<option value="${t}">${t}</option>`);
        }

        function performSearch() {
            clearTimeout(searchDebounceTimer);
            searchDebounceTimer = setTimeout(executeSearch, 150);
        }

        function executeSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase().trim();
            const container = document.getElementById('searchResults');
            const levelFilter = document.getElementById('searchLevelFilter')?.value || 'all';
            const schoolFilter = document.getElementById('searchSchoolFilter')?.value || 'all';
            const topicFilter = document.getElementById('searchTopicFilter')?.value || 'all';
            const diffFilter = document.getElementById('searchDiffFilter')?.value || 'all';
            const videoOnly = document.getElementById('searchVideoOnly')?.checked || false;

            if (!query && levelFilter === 'all' && schoolFilter === 'all' && topicFilter === 'all' && diffFilter === 'all' && !videoOnly) {
                container.innerHTML = `<div class="search-no-results"><div class="search-no-results-icon"></div><p>Enter a keyword or use filters</p></div>`;
                return;
            }

            container.innerHTML = '<div style="text-align:center; padding:30px;"> Searching...</div>';
            const searchTerms = query.split(/\s+/).filter(t => t.length > 0);
            const hashtagTerms = searchTerms.filter(t => t.startsWith('#'));
            const normalTerms = searchTerms.filter(t => !t.startsWith('#'));

            const results = db.filter((q) => {
                if (!q) return false;
                if (levelFilter !== 'all' && q.lvl !== levelFilter) return false;
                if (schoolFilter !== 'all' && q.s !== schoolFilter) return false;
                if (topicFilter !== 'all' && q.top !== topicFilter) return false;
                if (diffFilter !== 'all' && q.dif !== diffFilter) return false;
                if (videoOnly && !q.vid) return false;

                if (searchTerms.length === 0) return true;

                const searchableText = [q.q || '', q.a || '', q.top || '', q.lvl || '', q.s || '', q.dif || '', q.exp || '', q.tags || ''].join(' ').toLowerCase();

                // Hashtags use strictly "AND" logic
                if (hashtagTerms.length > 0) {
                    if (!hashtagTerms.every(tag => searchableText.includes(tag.toLowerCase()))) return false;
                }

                // Normal terms use "OR" if hashtags are present, or "AND" if only normal terms?
                // User said: "if i type in multiple # the search functions will search for all tags using 'and'"
                // Let's keep AND logic for all terms for precision.
                if (normalTerms.length > 0) {
                    if (!normalTerms.every(term => searchableText.includes(term.toLowerCase()))) return false;
                }

                return true;
            });

            if (results.length === 0) {
                container.innerHTML = `<div class="search-no-results"><div class="search-no-results-icon"></div><p>No questions found</p><p style="font-size:0.85rem;">Try different keywords or adjust filters</p></div>`;
                return;
            }

            let html = `<div class="search-stats"><span class="search-stats-count">Found ${results.length} question${results.length !== 1 ? 's' : ''}</span><span style="font-size:0.85rem; color:#888;">Showing top ${Math.min(results.length, 50)}</span></div>`;

            results.slice(0, 50).forEach((q) => {
                const originalIndex = db.indexOf(q);
                const isAdded = addedQuestionIds.has(originalIndex);
                let highlightedQ = formatText(q.q);
                let highlightedA = formatText(q.a);

                if (searchTerms.length > 0) {
                    searchTerms.forEach(term => {
                        if (term.length >= 2) {
                            const regex = new RegExp(`(${escapeRegExp(term)})`, 'gi');
                            highlightedQ = highlightedQ.replace(regex, '<span class="search-highlight">$1</span>');
                            highlightedA = highlightedA.replace(regex, '<span class="search-highlight">$1</span>');
                        }
                    });
                }

                const isFlagged = flaggedIds.has(q.id);
                html += `
                    <div class="search-result-item">
                        <div class="search-result-meta">
                            <span class="tag">${q.s || 'Unknown'}</span>
                            <span class="tag">${q.lvl || 'All'}</span>
                            <span class="tag">${q.top || 'General'}</span>
                            <span class="tag" style="background:${getDiffColor(q.dif)}">${q.dif || 'Medium'}</span>
                            <button class="flag-btn ${isFlagged ? 'active' : ''}" onclick="toggleFlag('${q.id}')" style="margin-left:auto; font-size:1rem; opacity:1;">${isFlagged ? '' : ''}</button>
                        </div>
                        <div class="search-result-question">${highlightedQ}</div>
                        <div class="search-result-answer"><strong>Answer:</strong> ${highlightedA}</div>
                        <div style="display:flex; gap:5px; margin-top:10px;">
                            <button class="add-to-paper-btn ${isAdded ? 'added' : ''}" id="add-btn-${originalIndex}" onclick="addQuestionFromSearch(${originalIndex})" ${isAdded ? 'disabled' : ''}>${isAdded ? ' Added' : '+ Add to Worksheet'}</button>
                            <button class="add-to-paper-btn" onclick="deleteQuestionFromDb(${originalIndex})" style="background:#e74c3c; border-color:#e74c3c;">Delete from DB</button>
                        </div>
                    </div>`;
            });

            if (results.length > 50) html += `<div style="text-align:center; padding:20px; color:#888;">Showing top 50. Refine your search for more.</div>`;
            container.innerHTML = html;
        }

        function escapeRegExp(string) { return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }

        function addQuestionFromSearch(dbIndex) {
            const q = db[dbIndex];
            if (!q) return;
            if (!currentPaperQuestions) currentPaperQuestions = [];
            if (currentPaperQuestions.some(pq => pq === q || (pq.q === q.q && pq.s === q.s))) {
                showToast("Already in worksheet!");
                return;
            }
            currentPaperQuestions.push(q);
            addedQuestionIds.add(dbIndex);
            const btn = document.getElementById(`add-btn-${dbIndex}`);
            if (btn) { btn.classList.add('added'); btn.textContent = ' Added'; btn.disabled = true; }
            showToast(`Added Q${currentPaperQuestions.length}`);
            renderPaper();
        }

        function deleteQuestionFromDb(dbIndex) {
            if (!confirm("Are you sure you want to delete this question from the database altogether?")) return;
            const deletedQ = db[dbIndex];
            db.splice(dbIndex, 1);

            // Remove from paper if present
            if (currentPaperQuestions.includes(deletedQ)) {
                currentPaperQuestions = currentPaperQuestions.filter(q => q !== deletedQ);
                renderPaper();
            }

            addedQuestionIds = new Set(); // Reset as indices have shifted
            updateDbCount();
            updateDropdowns();
            showToast("Question deleted from database");
            executeSearch(); // Refresh search results
        }

        // ============ FLAGGING ============
        function toggleFlag(qId) {
            if (flaggedIds.has(qId)) {
                flaggedIds.delete(qId);
            } else {
                flaggedIds.add(qId);
            }
            saveFlags();
            renderPaper();
            executeSearch(); // Refresh search flags if open
        }

        function saveFlags() {
            localStorage.setItem('mathGenFlagged', JSON.stringify([...flaggedIds]));
            updateFlagCount();
        }

        function updateFlagCount() {
            const badge = document.getElementById('flagCount');
            if (badge) badge.textContent = flaggedIds.size;
        }

        function loadFlaggedPaper() {
            isReviewMode = true;
            isAdaptiveMode = false;
            document.body.classList.remove('adaptive-mode');

            currentPaperQuestions = db.filter(q => flaggedIds.has(q.id));
            if (currentPaperQuestions.length === 0) {
                alert("No flagged questions to review!");
                isReviewMode = false;
                return;
            }
            renderPaper();
            showToast(`Loaded ${currentPaperQuestions.length} flagged questions`);
        }

        // ============ EDITING ============
        function startEditQuestion(qId) {
            const pw = prompt("Enter Edit Password:");
            if (pw === '198804') {
                closeQuestionPreview(); // Close preview if open
                openEditModal(qId);
            } else if (pw !== null) {
                alert("Incorrect Password!");
            }
        }

        function openEditModal(qId) {
            const q = db.find(item => item.id === qId);
            if (!q) return;

            document.getElementById('editQId').value = qId;
            document.getElementById('editS').value = q.s || '';
            document.getElementById('editL').value = q.lvl || '';
            document.getElementById('editT').value = q.top || '';
            document.getElementById('editD').value = q.dif || 'Medium';
            document.getElementById('editQ').value = q.q || '';
            document.getElementById('editA').value = q.a || '';
            document.getElementById('editTags').value = q.tags || '';
            document.getElementById('editU').value = q.u || '';
            document.getElementById('editImg').value = q.img || '';
            document.getElementById('editVid').value = q.vid || '';
            document.getElementById('editExp').value = q.exp || '';

            document.getElementById('editPreview').style.display = 'none';
            document.getElementById('editModal').style.display = 'flex';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            document.getElementById('editPreview').style.display = 'none';
        }

        function previewEdit() {
            const qVal = document.getElementById('editQ').value;
            const aVal = document.getElementById('editA').value;
            const uVal = document.getElementById('editU').value;
            const eVal = document.getElementById('editExp').value;
            const sVal = document.getElementById('editS').value;
            const lVal = document.getElementById('editL').value;
            const tVal = document.getElementById('editT').value;
            const dVal = document.getElementById('editD').value;
            const imgVal = document.getElementById('editImg').value;
            const vidVal = document.getElementById('editVid').value;

            const preview = document.getElementById('editPreview');
            const content = document.getElementById('editPreviewContent');

            const mcq = parseMCQ(qVal);
            const isMCQ = mcq.options.length > 0;
            const qMainContent = isMCQ ? formatText(mcq.questionText) + (imgVal ? `<img src="${imgVal}" class="q-image" alt="Preview Image">` : '') : renderQuestionContent(qVal, imgVal);

            let inputHTML = '';
            if (isMCQ) {
                inputHTML = '<div class="mcq-container" style="margin-top:10px;">';
                mcq.options.forEach((opt, i) => {
                    inputHTML += `<label class="mcq-option" style="display:block; margin:5px 0;"><span class="mcq-label">(${i + 1}) ${formatText(opt)}</span></label>`;
                });
                inputHTML += '</div>';
            } else {
                inputHTML = `<div style="margin-top:10px; border-bottom:1px solid #ccc; display:inline-block; min-width:100px;">${uVal || ''}</div>`;
            }

            let videoHTML = '';
            if (vidVal) {
                videoHTML = `
                    <div style="margin-top:15px; border-top:1px solid #eee; padding-top:10px;">
                        <strong>Video Explanation:</strong>
                        <video controls style="width:100%; max-width:400px; border-radius:8px; display:block; margin-top:5px;">
                            <source src="${vidVal.replace(/dl=0|dl=1/g, 'raw=1')}" type="video/mp4">
                        </video>
                    </div>`;
            }

            content.innerHTML = `
                <div style="font-size:0.85rem; color:#888; margin-bottom:10px;">
                    ${sVal} | ${lVal} | ${tVal} | <span class="tag" style="background:${getDiffColor(dVal)}">${dVal}</span>
                </div>
                <div style="font-size:1.1rem; line-height:1.6;">${qMainContent}</div>
                ${inputHTML}
                <div style="margin-top:20px; padding-top:10px; border-top:1px solid #eee;">
                    <strong>Correct Answer:</strong> ${formatText(aVal)} ${uVal || ''}
                    ${eVal ? `<div style="margin-top:10px; padding:10px; background:#f9f9f9; border-left:4px solid var(--accent); font-style:italic;">${formatText(eVal)}</div>` : ''}
                </div>
                ${videoHTML}
            `;

            preview.style.display = 'block';
            preview.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function saveEdit() {
            const qId = document.getElementById('editQId').value;
            const qIndex = db.findIndex(item => item.id === qId);
            if (qIndex === -1) return;

            db[qIndex] = {
                ...db[qIndex],
                s: document.getElementById('editS').value,
                lvl: document.getElementById('editL').value,
                top: document.getElementById('editT').value,
                dif: document.getElementById('editD').value,
                q: document.getElementById('editQ').value,
                a: document.getElementById('editA').value,
                u: document.getElementById('editU').value,
                img: document.getElementById('editImg').value,
                vid: document.getElementById('editVid').value,
                tags: document.getElementById('editTags').value.trim(),
                exp: document.getElementById('editExp').value
            };

            // Update current worksheet paper representation
            const paperIndex = currentPaperQuestions.findIndex(item => item.id === qId);
            if (paperIndex !== -1) {
                currentPaperQuestions[paperIndex] = db[qIndex];
            }

            closeEditModal();
            renderPaper();
            showToast("Question updated. Remember to 'Export HTML' to save permanently.");
        }

        // ============ PAPER GENERATION ============
        function openGenModal() {
            populateGenFilters();
            document.getElementById('genModal').style.display = 'flex';
        }

        function closeGenModal() {
            document.getElementById('genModal').style.display = 'none';
        }

        function populateGenFilters() {
            const topicList = document.getElementById('genTopicList');
            const schoolList = document.getElementById('genSchoolList');
            const tagList = document.getElementById('genTagList');

            const topics = [...new Set(db.map(q => q.top).filter(Boolean))].sort();
            const schools = [...new Set(db.map(q => q.s).filter(Boolean))].sort();

            // Extract all unique hashtags from q.tags
            let tagsSet = new Set();
            db.forEach(q => {
                // Only pull from q.tags field to avoid picking up hex colors or HTML from q.q
                const combined = (q.tags || '');
                const matches = combined.match(/#[a-zA-Z][\w-]*/g);
                if (matches) matches.forEach(m => tagsSet.add(m));
            });
            const tags = Array.from(tagsSet).sort();

            topicList.innerHTML = topics.map(t => `<label class="checkbox-item"><input type="checkbox" class="gen-top" value="${t}"> ${t}</label>`).join('');
            schoolList.innerHTML = schools.map(s => `<label class="checkbox-item"><input type="checkbox" class="gen-sch" value="${s}"> ${s}</label>`).join('');
            tagList.innerHTML = tags.map(t => `<label class="checkbox-item"><input type="checkbox" class="gen-tag" value="${t}"> ${t}</label>`).join('');
        }

        function generateAdvancedPaper() {
            isReviewMode = false;
            isAdaptiveMode = false;
            document.body.classList.remove('adaptive-mode');

            // 1. Collect Filters
            const selectedLvls = Array.from(document.querySelectorAll('.gen-lvl:checked')).map(cb => cb.value);
            const selectedDifs = Array.from(document.querySelectorAll('.gen-dif:checked')).map(cb => cb.value);
            const selectedTops = Array.from(document.querySelectorAll('.gen-top:checked')).map(cb => cb.value);
            const selectedSchs = Array.from(document.querySelectorAll('.gen-sch:checked')).map(cb => cb.value);
            const selectedTags = Array.from(document.querySelectorAll('.gen-tag:checked')).map(cb => cb.value);
            const isAndMode = document.getElementById('genFilterMode').checked; // true = AND, false = OR
            const includeMistakes = document.getElementById('genIncludeMistakes').checked;
            const videoOnly = document.getElementById('genVideoOnly').checked;
            const qCount = parseInt(document.getElementById('genCount').value) || 10;

            // 2. Build Pool
            let pool = [...db];

            if (includeMistakes) {
                const vault = JSON.parse(localStorage.getItem('mathGenVault')) || [];
                const vaultQs = vault.map(v => v.qRef || db.find(q => q.id === v.id)).filter(Boolean);
                pool = [...pool, ...vaultQs];
            }

            // 3. Apply Filters
            pool = pool.filter(q => {
                if (selectedLvls.length > 0 && !selectedLvls.includes(q.lvl)) return false;
                if (selectedDifs.length > 0 && !selectedDifs.includes(q.dif)) return false;
                if (selectedSchs.length > 0 && !selectedSchs.includes(q.s)) return false;

                // Topic Logic (AND/OR)
                if (selectedTops.length > 0) {
                    if (isAndMode) {
                        if (!selectedTops.every(t => q.top === t)) return false; // Hard to match multiple tops if q.top is single string, but maybe user tags?
                    } else {
                        if (!selectedTops.includes(q.top)) return false;
                    }
                }

                // Tag Logic (AND/OR)
                if (selectedTags.length > 0) {
                    const qTagsStr = [(q.tags || ''), (q.top || ''), (q.q || '')].join(' ');
                    if (isAndMode) {
                        if (!selectedTags.every(t => qTagsStr.includes(t))) return false;
                    } else {
                        if (!selectedTags.some(t => qTagsStr.includes(t))) return false;
                    }
                }

                if (videoOnly && !q.vid) return false;
                return true;
            });

            // 4. Remove Duplicates (in case same question is in both pool and vault)
            pool = Array.from(new Set(pool));

            if (pool.length === 0) {
                alert("No questions match your selected filters. Try broadening your criteria!");
                return;
            }

            // 5. Shuffle and Select
            for (let i = pool.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [pool[i], pool[j]] = [pool[j], pool[i]];
            }

            currentPaperQuestions = pool.slice(0, qCount);
            renderPaper();
            closeGenModal();
            showToast(`Generated worksheet with ${currentPaperQuestions.length} questions`);
        }

        // Keep for backward compatibility or direct calls
        function generateNewPaper() { openGenModal(); }

        function renderPaper() {
            qStartTimes = {};
            const container = document.getElementById('paper-container');
            const showAnswers = document.getElementById('showAnswers').checked;
            container.innerHTML = '';

            if (!currentPaperQuestions || currentPaperQuestions.length === 0) {
                container.innerHTML = '<div style="text-align:center; padding:50px; color:#7f8c8d;"><h2>No questions</h2><p>Generate a paper or search to add questions.</p></div>';
                return;
            }

            // Prepend Cover Page
            container.appendChild(generateCoverPage(currentPaperQuestions));

            let currentPage = createPage(2);
            container.appendChild(currentPage);

            currentPaperQuestions.forEach((item, index) => {
                try {
                    const formattedQ = formatText(item.q);
                    const formattedA = formatText(item.a);
                    const mcqData = parseMCQ(item.q);
                    const isMCQ = mcqData.options.length > 0;
                    const qId = `q${index}`;

                    let inputHTML = '';
                    if (isMCQ) {
                        inputHTML = '<div class="mcq-container">';
                        mcqData.options.forEach((opt, i) => {
                            inputHTML += `<label class="mcq-option"><input type="radio" name="${qId}" value="${i + 1}" data-correct="${item.a}"><span class="mcq-label">(${i + 1}) ${formatText(opt)}</span></label>`;
                        });
                        inputHTML += '</div>';
                        inputHTML += `<button onclick="checkSingleAnswer(${index})" style="font-size:0.8rem; padding:4px 8px; background:var(--highlight); color:white; border:none; border-radius:4px; cursor:pointer;">Check</button>`;
                        inputHTML += `<span class="feedback-tick" id="tick-${index}"></span>`;
                    } else {
                        const parts = parseMultipartAnswer(item.a, item.u);
                        inputHTML = `<div class="interaction-area">`;
                        parts.forEach((p, pIdx) => {
                            const isDollar = p.unit.includes('$');
                            const unitDisplay = isDollar ? `<span class="unit-label" style="margin-right:5px; font-weight:bold;">$</span>` : '';
                            const postUnitDisplay = !isDollar && p.unit ? `<span class="unit-label" style="margin-left:5px; font-weight:bold;">${p.unit}</span>` : '';

                            inputHTML += `
                                <div class="part-row">
                                    ${p.label ? `<span class="part-label">${p.label}</span>` : ''}
                                    ${unitDisplay}
                                    <input type="text" class="student-input" placeholder="Answer" data-correct="${p.ans}" style="flex:1;">
                                    ${postUnitDisplay}
                                </div>`;
                        });
                        inputHTML += `
                            <div style="display:flex; align-items:center; margin-top:5px;">
                                <button onclick="checkSingleAnswer(${index})" style="font-size:0.8rem; padding:4px 8px; background:var(--highlight); color:white; border:none; border-radius:4px; cursor:pointer;">Check</button>
                                <span class="feedback-tick" id="tick-${index}"></span>
                            </div>
                        </div>`;
                    }

                    const isFlagged = flaggedIds.has(item.id);
                    const qImageHTML = item.img ? `<img src="${item.img}" class="q-image" alt="Question Image">` : '';
                    const qMainContent = isMCQ ? formatText(mcqData.questionText) + qImageHTML : renderQuestionContent(item.q, item.img);

                    const qHTML = `
                        <div class="question-wrapper" id="wrapper-${index}">
                            <div class="insert-bar" onclick="insertQuestionAt(${index})"></div>
                            <div class="question-block" id="qblock-${index}">
                                <div class="q-actions">
                                    <button class="action-btn" onclick="removeFromPaper(${index})" data-tooltip="Remove"></button>
                                    <button class="action-btn" onclick="toggleHint(${index})" data-tooltip="Hint"></button>
                                    <button class="action-btn flag-btn ${isFlagged ? 'active' : ''}" onclick="toggleFlag('${item.id}')" data-tooltip="Flag">${isFlagged ? '' : ''}</button>
                                    ${isReviewMode ? `<button class="action-btn" onclick="startEditQuestion('${item.id}')" style="background:var(--admin); color:white;" data-tooltip="Edit"> Edit</button>` : ''}
                                </div>
                                <div class="q-meta">Q${index + 1} <span class="tag">${item.s || ''}</span> <span class="tag">${item.lvl || ''}</span> <span class="tag">${item.top || ''}</span> <span class="tag" style="background:${getDiffColor(item.dif)}">${item.dif || ''}</span></div>
                                <div class="q-layout">
                                    <div class="q-number-col">${index + 1}.</div>
                                    <div class="q-content-col">${qMainContent}${inputHTML}</div>
                                </div>
                                <div class="working-space-container">
                                    <div class="canvas-toolbar">
                                        <button class="tool-btn active" onclick="setTool(this, 'pen', ${index})"></button>
                                        <button class="tool-btn" onclick="setTool(this, 'eraser', ${index})"></button>
                                        <input type="range" min="1" max="10" value="2" class="tool-slider" onchange="setLineWidth(this.value)">
                                        <button class="tool-btn" onclick="clearCanvas(${index})" style="margin-left:auto; color:red;">Clear</button>
                                    </div>
                                    <canvas id="canvas-${index}" class="working-canvas" width="700" height="200"></canvas>
                                </div>
                                <div class="answer-key-section" style="display:${showAnswers ? 'block' : 'none'}">
                                    Ans: ${formattedA}
                                    ${item.exp ? `<div class="explanation-box">${formatText(item.exp)}</div>` : ''}
                                    ${item.vid ? `
                                        <div class="video-explanation" style="margin-top:15px;">
                                            <video controls style="width:100%; max-width:600px; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,0.15); border:1px solid #eee;">
                                                <source src="${item.vid.replace(/dl=0|dl=1/g, 'raw=1')}" type="video/mp4">
                                                Your browser does not support the video tag.
                                            </video>
                                        </div>
                                        <div class="qr-code">
                                            <p style="font-size:0.8rem; margin:10px 0 5px 0; font-weight:bold;">Scan to watch explanation video:</p>
                                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(item.vid.replace(/raw=1|dl=1/g, 'dl=0'))}" alt="QR Code" style="width:100px; height:100px; border:1px solid #eee; padding:5px; background:white;">
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        </div>`;

                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = qHTML;
                    currentPage.appendChild(tempDiv.firstElementChild);
                    setTimeout(() => initCanvas(index), 0);
                    qStartTimes[index] = Date.now();
                } catch (e) { console.error("Error rendering Q" + index, e); }
            });
        }

        function generateCoverPage(questions) {
            const page = document.createElement('div');
            page.className = 'sheet cover-page';

            const logoUrl = "https://www.dropbox.com/scl/fi/pmks0l77qiyuw781sh9t3/polymath-sticker.png?rlkey=jmbai9hxsaggsnua6dwewz5c6&raw=1";

            let tableRows = '';
            questions.forEach((q, i) => {
                // Extract hashtags as concepts
                const concepts = (q.tags || '').match(/#[a-z0-9]+/gi) || [];
                const conceptDisplay = concepts.length > 0 ? concepts.join(', ').replace(/#/g, '') : '-';

                tableRows += `
                    <tr>
                        <td class="sn-col">${i + 1}</td>
                        <td>${q.top || 'General'}</td>
                        <td>${q.dif || 'Medium'}</td>
                        <td>${conceptDisplay}</td>
                        <td class="marks-col"><span class="marks-blank"></span></td>
                    </tr>
                `;
            });

            page.innerHTML = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <img src="${logoUrl}" style="max-width: 180px; height: auto;">
                </div>
                <div class="school-header" style="font-size: 1.8rem; margin-bottom: 30px;">MATHEMATICS PRACTICE SUMMARY</div>
                
                <div style="width: 100%; margin-bottom: 20px;">
                    <input class="student-name-input" placeholder="Name: __________________________" style="width: 300px; font-size: 1.1rem; border: none; border-bottom: 2px solid #333; padding: 5px;">
                    <span style="float: right; font-weight: bold; font-family: 'Century Gothic', sans-serif;">Date: ______________</span>
                </div>

                <div class="cover-section-title">Question Summary & Mark Sheet</div>
                <table class="cover-table">
                    <thead>
                        <tr>
                            <th class="sn-col">S/N</th>
                            <th>Topic</th>
                            <th>Difficulty</th>
                            <th>Concept</th>
                            <th class="marks-col">Marks</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tableRows}
                    </tbody>
                </table>
                
                <div style="margin-top: auto; width: 100%; text-align: right; font-family: 'Century Gothic', sans-serif; color: #7f8c8d; font-size: 0.8rem;">
                    Generated by MathGen v2.0  Polymath Learning Centre
                </div>
            `;
            return page;
        }

        function createPage(num) {
            const div = document.createElement('div');
            div.className = 'sheet';
            div.innerHTML = `
                <div class="school-header" style="font-size: 1rem; margin-bottom: 20px; border-bottom: 2px solid #ccc; padding-bottom: 5px; text-align: right; font-weight: normal; color: #7f8c8d;">
                    Mathematics Practice  Page ${num}
                </div>
            `;
            return div;
        }

        function removeFromPaper(index) { currentPaperQuestions.splice(index, 1); renderPaper(); }

        function insertQuestionAt(index) {
            const pool = db.filter(q => !currentPaperQuestions.includes(q));
            if (pool.length === 0) { alert("No more questions available."); return; }
            currentPaperQuestions.splice(index, 0, pool[Math.floor(Math.random() * pool.length)]);
            renderPaper();
        }

        // ============ ANSWER CHECKING ============
        function checkSingleAnswer(index) {
            const qBlock = document.getElementById(`qblock-${index}`);
            if (!qBlock) return;
            const input = qBlock.querySelector('.student-input');
            const radios = qBlock.querySelectorAll('input[type="radio"]');
            let isCorrect = false;

            if (input) {
                const inputs = qBlock.querySelectorAll('.student-input');
                let allCorrect = true;
                inputs.forEach(inp => {
                    const userAns = normalizeAnswer(inp.value);
                    const correctAns = normalizeAnswer(inp.dataset.correct);
                    const isPartCorrect = userAns && (userAns === correctAns || correctAns.split('|').map(s => normalizeAnswer(s)).includes(userAns));
                    inp.classList.toggle('correct', isPartCorrect);
                    inp.classList.toggle('wrong', !isPartCorrect);
                    if (!isPartCorrect) allCorrect = false;
                });
                isCorrect = allCorrect;
            } else if (radios.length > 0) {
                let selected = Array.from(radios).find(r => r.checked);
                if (!selected) { alert("Select an option first."); return; }
                isCorrect = selected.value === selected.dataset.correct;
                selected.parentElement.classList.add(isCorrect ? 'correct-choice' : 'wrong-choice');
            }

            const tick = document.getElementById(`tick-${index}`);
            if (tick) {
                if (isCorrect) tick.classList.add('show');
                else tick.classList.remove('show');
            }

            playSound(isCorrect ? 'correct' : 'wrong');
            const qObj = currentPaperQuestions[index];
            if (qObj) updateGlobalStats(qObj.top, isCorrect, 0);

            if (isAdaptiveMode) {
                if (isCorrect) {
                    showToast("Correct! Next challenge coming...");
                    handleVaultSuccess(qObj);
                } else {
                    showToast("Incorrect! Added to Vault. Moving on...");
                    addToVault(qObj);
                }
                // Always proceed to next question in adaptive mode
                setTimeout(() => nextAdaptiveQuestion(), 1500);
            } else {
                if (!isCorrect && qObj) addToVault(qObj);
            }
        }

        function checkAnswers() {
            let correct = 0, total = currentPaperQuestions.length;
            currentPaperQuestions.forEach((q, idx) => {
                const block = document.getElementById(`qblock-${idx}`);
                if (!block) return;
                const inputs = block.querySelectorAll('.student-input');
                const radio = block.querySelector('input[type="radio"]:checked');
                let isCorrect = false;
                if (inputs.length > 0) {
                    let allCorrect = true;
                    inputs.forEach(inp => {
                        const userAns = normalizeAnswer(inp.value);
                        const correctAns = normalizeAnswer(inp.dataset.correct);
                        const isPartCorrect = userAns && (userAns === correctAns || correctAns.split('|').map(s => normalizeAnswer(s)).includes(userAns));
                        inp.classList.toggle('correct', isPartCorrect);
                        inp.classList.toggle('wrong', !isPartCorrect);
                        if (!isPartCorrect) allCorrect = false;
                    });
                    isCorrect = allCorrect;
                }
                if (radio) {
                    isCorrect = radio.value === radio.dataset.correct;
                    radio.parentElement.classList.add(isCorrect ? 'correct-choice' : 'wrong-choice');
                }
                const tick = document.getElementById(`tick-${idx}`);
                if (tick) {
                    if (isCorrect) tick.classList.add('show');
                    else tick.classList.remove('show');
                }
                if (isCorrect) correct++;
                else addToVault(q);
            });
            showResultModal(correct, total);
        }

        function showResultModal(correct, total) {
            if (total === 0) return;
            const pct = Math.round((correct / total) * 100);
            document.getElementById('scoreValue').textContent = pct + '%';
            document.getElementById('scoreText').textContent = `${correct}/${total}`;
            document.getElementById('timeText').textContent = '--:--';
            const circle = document.getElementById('scoreCircle');
            if (pct >= 80) { document.getElementById('resultTitle').textContent = 'Outstanding! '; circle.style.background = `conic-gradient(#00b894 ${pct}%, #eee 0%)`; confetti({ particleCount: 150, spread: 70 }); }
            else if (pct >= 50) { document.getElementById('resultTitle').textContent = 'Good Job! '; circle.style.background = `conic-gradient(#f1c40f ${pct}%, #eee 0%)`; }
            else { document.getElementById('resultTitle').textContent = 'Keep Trying! '; circle.style.background = `conic-gradient(#e74c3c ${pct}%, #eee 0%)`; }
            document.getElementById('resultModal').classList.add('open');
        }

        function closeModal() { document.getElementById('resultModal').classList.remove('open'); }

        // ============ CANVAS ============
        function initCanvas(index) {
            const canvas = document.getElementById(`canvas-${index}`);
            if (!canvas) return;

            const brush = document.getElementById('brush-cursor');

            const updateBrush = (e) => {
                if (!brush) return;
                brush.style.left = e.clientX + 'px';
                brush.style.top = e.clientY + 'px';
                brush.style.width = (currentTool === 'eraser' ? currentLineWidth * 5 : currentLineWidth) + 'px';
                brush.style.height = brush.style.width;
            };

            canvas.addEventListener('mouseenter', () => { if (brush) brush.style.display = 'block'; });
            canvas.addEventListener('mouseleave', () => { if (brush) brush.style.display = 'none'; });
            canvas.addEventListener('mousemove', updateBrush);

            const rect = canvas.parentElement.getBoundingClientRect();
            canvas.width = rect.width - 2;
            canvas.height = 300; // Match CSS height
            const ctx = canvas.getContext('2d');
            ctx.lineCap = 'round'; ctx.lineJoin = 'round'; ctx.strokeStyle = '#000'; ctx.lineWidth = 2;
            canvas.style.touchAction = 'none';
            canvas.addEventListener('mousedown', (e) => startDrawing(e, index));
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
        }

        function startDrawing(e, index) {
            isDrawing = true;
            const canvas = e.target;
            currentCtx = canvas.getContext('2d');
            const rect = canvas.getBoundingClientRect();
            lastX = (e.clientX - rect.left) * (canvas.width / rect.width);
            lastY = (e.clientY - rect.top) * (canvas.height / rect.height);
        }

        function draw(e) {
            if (!isDrawing || !currentCtx) return;
            const canvas = e.target;
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (canvas.width / rect.width);
            const y = (e.clientY - rect.top) * (canvas.height / rect.height);
            currentCtx.beginPath();
            currentCtx.moveTo(lastX, lastY);
            currentCtx.lineTo(x, y);
            currentCtx.globalCompositeOperation = currentTool === 'eraser' ? 'destination-out' : 'source-over';
            currentCtx.lineWidth = currentTool === 'eraser' ? currentLineWidth * 5 : currentLineWidth;
            currentCtx.stroke();
            [lastX, lastY] = [x, y];
        }

        function stopDrawing() { isDrawing = false; }
        function setTool(btn, tool) { currentTool = tool; btn.parentElement.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }
        function setLineWidth(val) { currentLineWidth = val; }
        function clearCanvas(index) { const c = document.getElementById(`canvas-${index}`); if (c) c.getContext('2d').clearRect(0, 0, c.width, c.height); }

        function renderQuestionContent(qText, imgUrl) {
            if (!qText) return '';
            const formattedQ = formatText(qText);
            if (!imgUrl) return formattedQ;

            const qImageHTML = `<img src="${imgUrl}" class="q-image" alt="Question Image">`;

            // Detect potential part markers: (a), (i), (1) 
            // Look for them at the start of a line or after a break
            const partRegex = /(?:\n|<br\/?>|^)\s*(\((?:[a-z]|[i]|[0-9])\)|[a-z0-9][\)\.])/i;
            const match = qText.match(partRegex);

            if (match) {
                const splitIndex = match.index;
                const beforeText = qText.substring(0, splitIndex);
                const afterText = qText.substring(splitIndex);
                // Return formatted before text + image + formatted after text
                return formatText(beforeText) + qImageHTML + formatText(afterText);
            }

            // Fallback: place image at end if no parts detected
            return formattedQ + qImageHTML;
        }

        // ============ FORMATTERS ============
        function formatText(text) {
            if (!text) return '';
            let f = String(text);
            // Fractions (handled first to avoid interfering with / replacement)
            f = f.replace(/\$?\s*\\frac\{([^{}]+)\}\{([^{}]+)\}\s*\$?/gi, (m, n, d) => `<span class="fraction"><span class="numerator">${n}</span><span class="denominator">${d}</span></span>`);

            // Clean up LaTeX leftovers
            f = f.replace(/\\text\s*\{([^{}]+)\}/gi, '$1');
            f = f.replace(/\\div/g, '').replace(/\\times/g, '').replace(/\\angle/gi, '');
            f = f.replace(/\\([%$#&])/g, '$1'); // Strip backslash escapes
            f = f.replace(/\$(?!\d)/g, '');

            // Global symbol replacements
            f = f.replace(/\*/g, '');

            // Context-aware division replacement (/ -> )
            // Replaces / when surrounded by numbers, variables or spaces, but avoids breaking URLs or fractions
            f = f.replace(/(\d|[a-zA-Z])\s*\/\s*(\d|[a-zA-Z])/g, '$1  $2');

            // Stylistic refinements
            f = f.replace(/\?/g, '<span class="question-mark">?</span>');
            f = f.replace(/(\d+)\s*:\s*(\d+)/g, '$1 : $2');
            return f;
        }

        function parseMCQ(text) {
            if (!text || typeof text !== 'string') return { questionText: text || '', options: [] };
            const parts = text.split(/\s*\([1-4]\)\s*/);
            if (parts.length < 3) return { questionText: parts[0] || text, options: [] };
            return { questionText: parts[0], options: parts.slice(1) };
        }

        function normalizeAnswer(text) {
            if (!text) return '';
            let n = String(text).toLowerCase().trim().replace(/[\$\s]/g, '');
            n = n.replace(/\\frac\{([^{}]+)\}\{([^{}]+)\}/g, '$1/$2');
            return n;
        }

        function parseMultipartAnswer(ans, unit) {
            if (!ans || typeof ans !== 'string') return [{ label: '', ans: ans || '', unit: unit || '' }];

            // Check for patterns like (a) 124, (b) 256
            const partRegex = /\(([a-zA-Z])\)\s*([^,]+)/g;
            const matches = [...ans.matchAll(partRegex)];

            if (matches.length > 0) {
                return matches.map(m => {
                    let fullPart = m[2].trim();
                    // Try to extract individual unit if present in the part string
                    // This handles cases like "(a) 12.5 min, (b) 29 cm"
                    let partAns = fullPart;
                    let partUnit = unit || '';

                    // common units at the end
                    const unitMatch = fullPart.match(/(.*?)\s*([a-zA-Z%]+||cm|cm|m|m|cm|m|km|kg|g|ml|l|h|min|s)$/);
                    if (unitMatch && !fullPart.includes('/')) {
                        partAns = unitMatch[1].trim();
                        partUnit = unitMatch[2].trim();
                    }

                    // Strip $ if it's at the start of the part answer
                    if (partAns.startsWith('$')) {
                        partAns = partAns.substring(1).trim();
                        partUnit = '$' + partUnit; // Prepend $ or just use as unit? Usually $ is prefix
                    }

                    return { label: `(${m[1]})`, ans: partAns, unit: partUnit };
                });
            }

            // Fallback for single part
            return [{ label: '', ans: ans, unit: unit || '' }];
        }

        function getDiffColor(dif) {
            if (dif === 'Easy') return '#e8f8f5';
            if (dif === 'Medium') return '#fef9e7';
            if (dif === 'Hard') return '#fdedec';
            return '#f0f0f0';
        }

        // ============ VAULT ============
        function addToVault(q) {
            if (!q || !q.id) return;
            const existingIdx = mistakeVault.findIndex(v => v.id === q.id);
            if (existingIdx !== -1) {
                mistakeVault[existingIdx].lastAttempt = Date.now();
                mistakeVault[existingIdx].streak = 0;
            } else {
                mistakeVault.push({
                    id: q.id,
                    qRef: q,
                    lastAttempt: Date.now(),
                    streak: 0
                });
            }
            saveVault();
        }

        function handleVaultSuccess(q) {
            const idx = mistakeVault.findIndex(v => v.id === q.id);
            if (idx !== -1) {
                mistakeVault[idx].streak++;
                mistakeVault[idx].lastAttempt = Date.now();
                if (mistakeVault[idx].streak >= 2) {
                    mistakeVault.splice(idx, 1);
                    showToast("Question mastered & removed from Vault! ");
                }
                saveVault();
            }
        }

        function saveVault() {
            localStorage.setItem('mathGenVault', JSON.stringify(mistakeVault));
            updateVaultCount();
        }

        function loadMistakePaper() {
            isReviewMode = false;
            const vault = JSON.parse(localStorage.getItem('mathGenVault')) || [];
            if (vault.length === 0) { alert("Vault is empty!"); return; }
            currentPaperQuestions = vault.map(v => v.qRef || db.find(q => q.id === v.id)).filter(Boolean);
            renderPaper();
            showToast(`Loaded ${currentPaperQuestions.length} from Vault`);
        }

        function updateVaultCount() {
            const vault = JSON.parse(localStorage.getItem('mathGenVault')) || [];
            const badge = document.getElementById('vaultCount');
            if (badge) badge.textContent = vault.length;
        }

        // ============ ADAPTIVE LEARNING ============
        function startAdaptiveMode() {
            isAdaptiveMode = true;
            document.body.classList.add('adaptive-mode');
            normalizeDiffScores();
            const sortedDb = [...db].sort((a, b) => (a.diffScore || 50) - (b.diffScore || 50));
            adaptiveQueue = sortedDb;
            adaptiveIndex = 0;
            showToast("Adaptive Mode Started! ");
            nextAdaptiveQuestion();
        }

        function normalizeDiffScores() {
            db.forEach(q => {
                if (!q.diffScore) q.diffScore = calculateDifficulty(q);
            });
        }

        function calculateDifficulty(q) {
            let base = 50;
            const lvl = q.lvl || 'P3';
            const dif = q.dif || 'Medium';
            switch (lvl) {
                case 'P1': base = 10; break;
                case 'P2': base = 25; break;
                case 'P3': base = 40; break;
                case 'P4': base = 55; break;
                case 'P5': base = 70; break;
                case 'P6': base = 85; break;
            }
            if (dif === 'Easy') base -= 5;
            if (dif === 'Hard') base += 10;
            return Math.min(100, Math.max(1, base));
        }

        function nextAdaptiveQuestion() {
            const twoDays = 2 * 24 * 60 * 60 * 1000;
            const now = Date.now();
            const vaultCandidate = mistakeVault.find(v => (now - v.lastAttempt) > twoDays);

            if (vaultCandidate && Math.random() > 0.3) {
                let q = vaultCandidate.qRef;
                if (!q) q = db.find(x => x.id === vaultCandidate.id);
                if (q) {
                    renderAdaptiveQuestion(q, true);
                    return;
                }
            }

            if (adaptiveIndex >= adaptiveQueue.length) {
                alert("You have completed all questions! Amazing!");
                isAdaptiveMode = false;
                document.body.classList.remove('adaptive-mode');
                renderPaper();
                return;
            }

            const q = adaptiveQueue[adaptiveIndex];
            adaptiveIndex++;
            renderAdaptiveQuestion(q, false);
        }

        function renderAdaptiveQuestion(q, isVault) {
            currentPaperQuestions = [q];
            renderPaper();
            const sheet = document.querySelector('.sheet');
            if (sheet) {
                const diff = q.diffScore || calculateDifficulty(q);
                const header = sheet.querySelector('.school-header');
                if (header) {
                    header.innerHTML = `Adaptive Challenge ${isVault ? ' Review' : ''}<br><span style="font-size:0.8rem; color:#6c5ce7;">Difficulty Level: ${diff}/100</span>`;
                }
                const nameInput = sheet.querySelector('.student-name-input');
                if (nameInput) nameInput.style.display = 'none';
            }
        }

        // ============ UI HELPERS ============
        function updateDropdowns() {
            // No longer needed as sidebar filters are removed
        }

        function toggleAnswers() {
            const show = document.getElementById('showAnswers').checked;
            document.querySelectorAll('.answer-key-section').forEach(d => d.style.display = show ? 'block' : 'none');
        }

        function toggleHint(index) {
            const section = document.querySelector(`#qblock-${index} .answer-key-section`);
            if (section) { section.style.display = section.style.display === 'none' ? 'block' : 'none'; section.style.background = '#fff3cd'; }
        }

        let toastTimeout;
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            clearTimeout(toastTimeout);
            toastTimeout = setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // ============ SETTINGS ============
        function toggleDarkMode() { document.body.classList.toggle('dark-mode'); localStorage.setItem('darkMode', document.body.classList.contains('dark-mode')); }
        function toggleFontSize() { document.body.classList.toggle('large-text'); }
        function toggleDyslexia() { document.body.classList.toggle('dyslexia-font'); }
        function toggleAudio() { audioEnabled = !audioEnabled; localStorage.setItem('audioEnabled', audioEnabled); updateAudioBtn(); }
        function updateAudioBtn() { const btn = document.getElementById('btn-audio'); if (btn) btn.textContent = audioEnabled ? '' : ''; }
        function playSound(type) { if (!audioEnabled) return; /* Add audio play logic if needed */ }

        function toggleCalculator() { const c = document.getElementById('calculator'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; }
        function calcAppend(v) { document.getElementById('calcDisplay').value += v; }
        function calcClear() { document.getElementById('calcDisplay').value = ''; }
        function calcBackspace() { const d = document.getElementById('calcDisplay'); d.value = d.value.slice(0, -1); }
        function calcSolve() { try { document.getElementById('calcDisplay').value = eval(document.getElementById('calcDisplay').value.replace(/[^0-9+\-*/.]/g, '')); } catch { document.getElementById('calcDisplay').value = 'Error'; } }

        function toggleStats() {
            const modal = document.getElementById('stats-modal');
            modal.style.display = modal.style.display === 'none' ? 'flex' : 'none';
            if (modal.style.display === 'flex') {
                const container = document.getElementById('stats-content');
                const sorted = Object.entries(globalStats.topics).sort((a, b) => (a[1].correct / a[1].total || 0) - (b[1].correct / b[1].total || 0));
                if (sorted.length === 0) { container.innerHTML = '<p style="text-align:center;">No data yet.</p>'; return; }
                let html = '';
                sorted.forEach(([topic, data]) => {
                    const pct = data.total === 0 ? 0 : Math.round((data.correct / data.total) * 100);
                    const cls = pct < 50 ? 'stat-weak' : pct >= 80 ? 'stat-good' : 'stat-ok';
                    html += `<div class="stats-row"><div class="stats-label">${topic}</div><div class="stats-track"><div class="stats-fill ${cls}" style="width:${pct}%"></div></div><div class="stats-val">${pct}%</div></div>`;
                });
                container.innerHTML = html;
            }
        }

        function updateGlobalStats(topic, isCorrect) {
            if (!topic) topic = 'General';
            if (!globalStats.topics[topic]) globalStats.topics[topic] = { correct: 0, total: 0 };
            globalStats.topics[topic].total++;
            if (isCorrect) { globalStats.topics[topic].correct++; globalStats.streak++; } else { globalStats.streak = 0; }
            localStorage.setItem('mathGenStats', JSON.stringify(globalStats));
        }

        // ============ ADMIN ============
        function toggleAdmin() {
            const panel = document.getElementById('adminPanel');
            if (panel.style.display === 'none') {
                const pass = prompt("Admin Password:");
                if (pass === "198804") panel.style.display = "block";
                else alert("Incorrect");
            } else panel.style.display = 'none';
        }

        function addSingleQuestion() {
            const s = document.getElementById('newS').value.trim();
            const l = document.getElementById('newL').value.trim();
            const t = document.getElementById('newT').value.trim();
            const d = document.getElementById('newD').value.trim();
            const q = document.getElementById('newQ').value.trim();
            const a = document.getElementById('newA').value.trim();
            const img = document.getElementById('newImg').value.trim();
            const vid = document.getElementById('newVid').value.trim();
            const tags = document.getElementById('newTags').value.trim();
            const exp = document.getElementById('newExp').value.trim();
            if (!s || !l || !t || !d || !q || !a) { alert("Fill required fields."); return; }
            const newQ = { s, lvl: l, top: t, dif: d, q, a, img, vid, tags, exp, id: 'q_' + Date.now() };
            db.push(newQ);
            updateDropdowns();
            updateDbCount();
            populateSearchFilters();
            alert("Added!");
            ['newS', 'newL', 'newT', 'newD', 'newQ', 'newA', 'newImg', 'newVid', 'newTags', 'newExp'].forEach(id => document.getElementById(id).value = '');
        }

        function importQuestions() {
            try {
                const newQs = JSON.parse(document.getElementById('importData').value);
                if (!Array.isArray(newQs)) throw "Not an array";
                newQs.forEach(q => { q.id = 'q_' + Date.now() + Math.random(); db.push(q); });
                updateDropdowns();
                updateDbCount();
                populateSearchFilters();
                alert(`Imported ${newQs.length} questions!`);
                document.getElementById('importData').value = '';
            } catch (e) { alert("Error: " + e); }
        }


        function exportUpdatedFile() {
            document.getElementById('db-data').textContent = "\n" + JSON.stringify(db, null, 2) + "\n";
            const html = "<!DOCTYPE html>\n" + document.documentElement.outerHTML;
            const blob = new Blob([html], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'sg_math_bank_exported.html';
            a.click();
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.target.classList.contains('student-input')) {
                const wrapper = e.target.closest('.question-wrapper');
                if (wrapper) { checkSingleAnswer(parseInt(wrapper.id.split('-')[1])); e.preventDefault(); }
            }
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') { checkAnswers(); e.preventDefault(); }
        });
    </script>
    <script type="module">
        // Import necessary Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, sendPasswordResetEmail, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
      
        // Your Specific Configuration
        const firebaseConfig = {
          apiKey: "AIzaSyAUSI3Uh28IeqASEp0JhH4QPaVt-O3meBo",
          authDomain: "mathgen--app.firebaseapp.com",
          projectId: "mathgen--app",
          storageBucket: "mathgen--app.firebasestorage.app",
          messagingSenderId: "165654161198",
          appId: "1:165654161198:web:16c8bd60eb3a2aa7edbcbf",
          measurementId: "G-0MWZFG211D"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db_fs = getFirestore(app);
      
        let isSignUpMode = false;
      
// UI: Toggle between Login and Sign Up
window.toggleAuthMode = () => {
    isSignUpMode = !isSignUpMode;
    const regFields = document.getElementById('reg-fields');
    const legalBox = document.getElementById('legal-box');
    
    document.getElementById('auth-title').innerText = isSignUpMode ? "Register Student Account" : "Welcome Back!";
    document.getElementById('btn-login').innerText = isSignUpMode ? "Confirm Registration" : "Login";
    document.getElementById('auth-switch').innerText = isSignUpMode ? "Login" : "Sign Up";
    document.getElementById('mode-text').innerText = isSignUpMode ? "Already a student?" : "Don't have an account?";
    
    // Show/Hide extra fields
    regFields.style.display = isSignUpMode ? "block" : "none";
    legalBox.style.display = isSignUpMode ? "block" : "none";
    document.getElementById('auth-error').innerText = "";
};

// AUTH: Registration & Login
window.handleLogin = async () => {
    const email = document.getElementById('auth-email').value;
    const pass = document.getElementById('auth-pass').value;
    const errorMsg = document.getElementById('auth-error');
    
    if(!email || !pass) { errorMsg.innerText = "Please enter email and password."; return; }

    try {
        if (isSignUpMode) {
            // Validate new fields
            const pName = document.getElementById('parent-name').value;
            const sName = document.getElementById('student-name').value;
            const sLvl = document.getElementById('student-level').value;
            const sSub = document.getElementById('student-subject').value;
            const agreed = document.getElementById('legal-agree').checked;

            if(!pName || !sName || !sLvl || !sSub) {
                errorMsg.innerText = "Please fill in all details."; return;
            }
            if(!agreed) {
                errorMsg.innerText = "You must agree to the payment terms."; return;
            }

            // Create account
            const userCredential = await createUserWithEmailAndPassword(auth, email, pass);
            const user = userCredential.user;

            // Save details to Database
            await setDoc(doc(db_fs, "users", user.uid), {
                email: email,
                parentName: pName,
                studentName: sName,
                level: sLvl,
                subject: sSub,
                loginDays: 1,
                lastLoginDate: new Date().toDateString(),
                agreedToTerms: true,
                registrationDate: Date.now()
            });
            alert("Registration successful!");

        } else {
            await signInWithEmailAndPassword(auth, email, pass);
        }
    } catch (e) {
        errorMsg.innerText = "Error: " + e.message;
    }
};
        // LOGIC: Track Daily Login
        async function trackLoginDays(user) {
          const userRef = doc(db_fs, "users", user.uid);
          const userSnap = await getDoc(userRef);
          const today = new Date().toDateString(); // Format: "Fri Jan 02 2026"
      
          if (userSnap.exists()) {
            const userData = userSnap.data();
            if (userData.lastLoginDate !== today) {
              // First time logging in today
              await updateDoc(userRef, {
                loginDays: increment(1),
                lastLoginDate: today
              });
              const newCount = (userData.loginDays || 0) + 1;
              document.getElementById('login-days-display').innerText = ` Day ${newCount} streak!`;
            } else {
              // Already logged in today
              document.getElementById('login-days-display').innerText = ` Day ${userData.loginDays || 1} streak!`;
            }
          } else {
            // Brand new user
            await setDoc(userRef, {
              email: user.email,
              loginDays: 1,
              lastLoginDate: today,
              createdAt: Date.now()
            });
            document.getElementById('login-days-display').innerText = ` Day 1 streak!`;
          }
        }
      
        // AUTH: Login / Sign Up Action
        window.handleLogin = () => {

          // Add this right before or after your window.handleLogin function
const googleProvider = new GoogleAuthProvider(); //

window.handleGoogleLogin = async () => {
    const errorMsg = document.getElementById('auth-error');
    try {
        // Opens the Google sign-in window
        const result = await signInWithPopup(auth, googleProvider);
        const user = result.user;
        
        // After successful Google login, track their login days
        await trackLoginDays(user);
        console.log("Logged in as:", user.displayName);
    } catch (e) {
        errorMsg.innerText = "Google Login Error: " + e.message;
    }
};
          const email = document.getElementById('auth-email').value;
          const pass = document.getElementById('auth-pass').value;
          const errorMsg = document.getElementById('auth-error');
          
          if(!email || !pass) { errorMsg.innerText = "Please fill in all fields."; return; }
      
          if (isSignUpMode) {
            createUserWithEmailAndPassword(auth, email, pass)
              .catch(e => { errorMsg.innerText = "Error: " + e.message; });
          } else {
            signInWithEmailAndPassword(auth, email, pass)
              .catch(e => { errorMsg.innerText = "Invalid email or password."; });
          }
        };
window.handleGoogleLogin = async () => {
    const errorMsg = document.getElementById('auth-error');
    try {
        // Opens the Google sign-in window
        const result = await signInWithPopup(auth, googleProvider);
        const user = result.user;
        
        // After successful Google login, track their login days
        await trackLoginDays(user);
        console.log("Logged in as:", user.displayName);
    } catch (e) {
        errorMsg.innerText = "Google Login Error: " + e.message;
    }
};
      
        // AUTH: Logout
        window.handleLogout = () => {
          signOut(auth).then(() => {
              location.reload(); // Refresh to show login screen again
          });
        };
      
        // AUTH: Forget Password
        window.handleResetPassword = () => {
          const email = document.getElementById('auth-email').value;
          if (!email) { alert("Please enter your email address in the box first."); return; }
          sendPasswordResetEmail(auth, email)
            .then(() => alert("A password reset link has been sent to your email!"))
            .catch(e => alert("Error: " + e.message));
        };
      
        // STATE: Check if user is logged in
        onAuthStateChanged(auth, (user) => {
          const overlay = document.getElementById('auth-overlay');
          if (user) {
            overlay.style.display = 'none'; // Hide login screen
            trackLoginDays(user);
          } else {
            overlay.style.display = 'flex'; // Show login screen
          }
        });
      </script>
</body>

</html>


